(function(m){m.toJSON=function(B){if(typeof JSON=="object"&&JSON.stringify)return JSON.stringify(B);var E=typeof B;if(B===null)return"null";if(E!="undefined"){if(E=="number"||E=="boolean")return B+"";if(E=="string")return m.quoteString(B);if(E=="object"){if(typeof B.toJSON=="function")return m.toJSON(B.toJSON());if(B.constructor===Date){var t=B.getUTCMonth()+1;if(t<10)t="0"+t;var a=B.getUTCDate();if(a<10)a="0"+a;E=B.getUTCFullYear();var i=B.getUTCHours();if(i<10)i="0"+i;var h=B.getUTCMinutes();if(h<
10)h="0"+h;var f=B.getUTCSeconds();if(f<10)f="0"+f;B=B.getUTCMilliseconds();if(B<100)B="0"+B;if(B<10)B="0"+B;return'"'+E+"-"+t+"-"+a+"T"+i+":"+h+":"+f+"."+B+'Z"'}if(B.constructor===Array){t=[];for(a=0;a<B.length;a++)t.push(m.toJSON(B[a])||"null");return"["+t.join(",")+"]"}t=[];for(a in B){E=typeof a;if(E=="number")E='"'+a+'"';else if(E=="string")E=m.quoteString(a);else continue;if(typeof B[a]!="function"){i=m.toJSON(B[a]);t.push(E+":"+i)}}return"{"+t.join(", ")+"}"}}};m.evalJSON=function(B){if(typeof JSON==
"object"&&JSON.parse)return JSON.parse(B);return eval("("+B+")")};m.secureEvalJSON=function(B){if(typeof JSON=="object"&&JSON.parse)return JSON.parse(B);var E;E=B.replace(/\\["\\\/bfnrtu]/g,"@");E=E.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");E=E.replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(E))return eval("("+B+")");else throw new SyntaxError("Error parsing JSON, source is not valid.");};m.quoteString=function(B){if(B.match(K))return'"'+B.replace(K,
function(E){var t=P[E];if(typeof t==="string")return t;t=E.charCodeAt();return"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)})+'"';return'"'+B+'"'};var K=/["\\\x00-\x1f\x7f-\x9f]/g,P={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}})(jQuery);/*
 http://keith-wood.name/svg.html
 SVG for jQuery v1.4.3.
 Written by Keith Wood (kbwood{at}iinet.com.au) August 2007.
 Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and 
 MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses. 
 Please attribute the author if you use it. */
(function(m){function K(){this._settings=[];this._extensions=[];this.regional=[];this.regional[""]={errorLoadingText:"Error loading",notSupportedText:"This browser does not support SVG"};this.local=this.regional[""];this._uuid=(new Date).getTime();var a;try{a=!!(window.ActiveXObject&&new ActiveXObject("RenesisX.RenesisCtrl"))}catch(i){a=false}this._renesis=a}function P(a,i){this._svg=a;this._container=i;for(var h=0;h<m.svg._extensions.length;h++){var f=m.svg._extensions[h];this[f[0]]=new f[1](this)}}
function B(){this._path=""}function E(){this._parts=[]}function t(a){return a&&a.constructor==Array}m.extend(K.prototype,{markerClassName:"hasSVG",svgNS:"http://www.w3.org/2000/svg",xlinkNS:"http://www.w3.org/1999/xlink",_wrapperClass:P,_attrNames:{class_:"class",in_:"in",alignmentBaseline:"alignment-baseline",baselineShift:"baseline-shift",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorRendering:"color-rendering",
dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",
imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",
strokeWidth:"stroke-width",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",underlinePosition:"underline-position",underlineThickness:"underline-thickness",vertAdvY:"vert-adv-y",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode"},_attachSVG:function(a,i){var h=a.namespaceURI==this.svgNS?a:null;a=h?null:a;if(!m(a||h).hasClass(this.markerClassName)){if(typeof i=="string")i={loadURL:i};else if(typeof i=="function")i={onLoad:i};m(a||
h).addClass(this.markerClassName);try{if(!h){h=document.createElementNS(this.svgNS,"svg");h.setAttribute("version","1.1");h.setAttribute("width",a.clientWidth);h.setAttribute("height",a.clientHeight);a.appendChild(h)}this._afterLoad(a,h,i||{})}catch(f){if(m.browser.msie){if(!a.id)a.id="svg"+this._uuid++;this._settings[a.id]=i;a.innerHTML='<embed type="image/svg+xml" width="100%" height="100%" src="'+(i.initPath||"")+'blank.svg"/>'}else a.innerHTML='<p class="svg_error">'+this.local.notSupportedText+
"</p>"}}},_registerSVG:function(){for(var a=0;a<document.embeds.length;a++){var i=document.embeds[a].parentNode;if(!(!m(i).hasClass(m.svg.markerClassName)||m.data(i,"svgwrapper"))){var h=null;try{h=document.embeds[a].getSVGDocument()}catch(f){setTimeout(m.svg._registerSVG,250);break}(h=h?h.documentElement:null)&&m.svg._afterLoad(i,h)}}},_afterLoad:function(a,i,h){h=h||this._settings[a.id];this._settings[a?a.id:""]=null;var f=new this._wrapperClass(i,a);m.data(a||i,"svgwrapper",f);try{h.loadURL&&f.load(h.loadURL,
h);h.settings&&f.configure(h.settings);if(h.onLoad&&!h.loadURL)h.onLoad.apply(a||i,[f])}catch(r){alert(r)}},_getSVG:function(a){a=typeof a=="string"?m(a)[0]:a.jquery?a[0]:a;return m.data(a,"svgwrapper")},_destroySVG:function(a){var i=m(a);if(i.hasClass(this.markerClassName)){i.removeClass(this.markerClassName);a.namespaceURI!=this.svgNS&&i.empty();m.removeData(a,"svgwrapper")}},addExtension:function(a,i){this._extensions.push([a,i])}});m.extend(P.prototype,{_width:function(){return this._container?
this._container.clientWidth:this._svg.width},_height:function(){return this._container?this._container.clientHeight:this._svg.height},root:function(){return this._svg},configure:function(a,i){if(i)for(var h=this._svg.attributes.length-1;h>=0;h--){var f=this._svg.attributes.item(h);f.nodeName=="onload"||f.nodeName=="version"||f.nodeName.substring(0,5)=="xmlns"||this._svg.attributes.removeNamedItem(f.nodeName)}for(var r in a)this._svg.setAttribute(r,a[r]);return this},getElementById:function(a){return this._svg.ownerDocument.getElementById(a)},
change:function(a,i){if(a)for(var h in i)i[h]==null?a.removeAttribute(h):a.setAttribute(h,i[h]);return this},_args:function(a,i,h){i.splice(0,0,"parent");i.splice(i.length,0,"settings");var f={},r=0;if(a[0]!=null&&a[0].jquery)a[0]=a[0][0];if(a[0]!=null&&!(typeof a[0]=="object"&&a[0].nodeName)){f.parent=null;r=1}for(var x=0;x<a.length;x++)f[i[x+r]]=a[x];h&&m.each(h,function(F,y){if(typeof f[y]=="object"){f.settings=f[y];f[y]=null}});return f},title:function(){var a=this._args(arguments,["text"]),i=
this._makeNode(a.parent,"title",a.settings||{});i.appendChild(this._svg.ownerDocument.createTextNode(a.text));return i},describe:function(){var a=this._args(arguments,["text"]),i=this._makeNode(a.parent,"desc",a.settings||{});i.appendChild(this._svg.ownerDocument.createTextNode(a.text));return i},defs:function(){var a=this._args(arguments,["id"],["id"]);return this._makeNode(a.parent,"defs",m.extend(a.id?{id:a.id}:{},a.settings||{}))},symbol:function(){var a=this._args(arguments,["id","x1","y1","width",
"height"]);return this._makeNode(a.parent,"symbol",m.extend({id:a.id,viewBox:a.x1+" "+a.y1+" "+a.width+" "+a.height},a.settings||{}))},marker:function(){var a=this._args(arguments,["id","refX","refY","mWidth","mHeight","orient"],["orient"]);return this._makeNode(a.parent,"marker",m.extend({id:a.id,refX:a.refX,refY:a.refY,markerWidth:a.mWidth,markerHeight:a.mHeight,orient:a.orient||"auto"},a.settings||{}))},style:function(){var a=this._args(arguments,["styles"]),i=this._makeNode(a.parent,"style",m.extend({type:"text/css"},
a.settings||{}));i.appendChild(this._svg.ownerDocument.createTextNode(a.styles));m.browser.opera&&m("head").append('<style type="text/css">'+a.styles+"</style>");return i},script:function(){var a=this._args(arguments,["script","type"],["type"]),i=this._makeNode(a.parent,"script",m.extend({type:a.type||"text/javascript"},a.settings||{}));i.appendChild(this._svg.ownerDocument.createTextNode(this._escapeXML(a.script)));m.browser.mozilla||m.globalEval(a.script);return i},linearGradient:function(){var a=
this._args(arguments,["id","stops","x1","y1","x2","y2"],["x1"]),i=m.extend({id:a.id},a.x1!=null?{x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2}:{});return this._gradient(a.parent,"linearGradient",m.extend(i,a.settings||{}),a.stops)},radialGradient:function(){var a=this._args(arguments,["id","stops","cx","cy","r","fx","fy"],["cx"]),i=m.extend({id:a.id},a.cx!=null?{cx:a.cx,cy:a.cy,r:a.r,fx:a.fx,fy:a.fy}:{});return this._gradient(a.parent,"radialGradient",m.extend(i,a.settings||{}),a.stops)},_gradient:function(a,
i,h,f){a=this._makeNode(a,i,h);for(i=0;i<f.length;i++){h=f[i];this._makeNode(a,"stop",m.extend({offset:h[0],stopColor:h[1]},h[2]!=null?{stopOpacity:h[2]}:{}))}return a},pattern:function(){var a=this._args(arguments,["id","x","y","width","height","vx","vy","vwidth","vheight"],["vx"]),i=m.extend({id:a.id,x:a.x,y:a.y,width:a.width,height:a.height},a.vx!=null?{viewBox:a.vx+" "+a.vy+" "+a.vwidth+" "+a.vheight}:{});return this._makeNode(a.parent,"pattern",m.extend(i,a.settings||{}))},mask:function(){var a=
this._args(arguments,["id","x","y","width","height"]);return this._makeNode(a.parent,"mask",m.extend({id:a.id,x:a.x,y:a.y,width:a.width,height:a.height},a.settings||{}))},createPath:function(){return new B},createText:function(){return new E},svg:function(){var a=this._args(arguments,["x","y","width","height","vx","vy","vwidth","vheight"],["vx"]),i=m.extend({x:a.x,y:a.y,width:a.width,height:a.height},a.vx!=null?{viewBox:a.vx+" "+a.vy+" "+a.vwidth+" "+a.vheight}:{});return this._makeNode(a.parent,
"svg",m.extend(i,a.settings||{}))},group:function(){var a=this._args(arguments,["id"],["id"]);return this._makeNode(a.parent,"g",m.extend({id:a.id},a.settings||{}))},use:function(){var a=this._args(arguments,["x","y","width","height","ref"]);if(typeof a.x=="string"){a.ref=a.x;a.settings=a.y;a.x=a.y=a.width=a.height=null}var i=this._makeNode(a.parent,"use",m.extend({x:a.x,y:a.y,width:a.width,height:a.height},a.settings||{}));i.setAttributeNS(m.svg.xlinkNS,"href",a.ref);return i},link:function(){var a=
this._args(arguments,["ref"]),i=this._makeNode(a.parent,"a",a.settings);i.setAttributeNS(m.svg.xlinkNS,"href",a.ref);return i},image:function(){var a=this._args(arguments,["x","y","width","height","ref"]),i=this._makeNode(a.parent,"image",m.extend({x:a.x,y:a.y,width:a.width,height:a.height},a.settings||{}));i.setAttributeNS(m.svg.xlinkNS,"href",a.ref);return i},path:function(){var a=this._args(arguments,["path"]);return this._makeNode(a.parent,"path",m.extend({d:a.path.path?a.path.path():a.path},
a.settings||{}))},rect:function(){var a=this._args(arguments,["x","y","width","height","rx","ry"],["rx"]);return this._makeNode(a.parent,"rect",m.extend({x:a.x,y:a.y,width:a.width,height:a.height},a.rx?{rx:a.rx,ry:a.ry}:{},a.settings||{}))},circle:function(){var a=this._args(arguments,["cx","cy","r"]);return this._makeNode(a.parent,"circle",m.extend({cx:a.cx,cy:a.cy,r:a.r},a.settings||{}))},ellipse:function(){var a=this._args(arguments,["cx","cy","rx","ry"]);return this._makeNode(a.parent,"ellipse",
m.extend({cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry},a.settings||{}))},line:function(){var a=this._args(arguments,["x1","y1","x2","y2"]);return this._makeNode(a.parent,"line",m.extend({x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},a.settings||{}))},polyline:function(){var a=this._args(arguments,["points"]);return this._poly(a.parent,"polyline",a.points,a.settings)},polygon:function(){var a=this._args(arguments,["points"]);return this._poly(a.parent,"polygon",a.points,a.settings)},_poly:function(a,i,h,f){for(var r="",x=
0;x<h.length;x++)r+=h[x].join()+" ";return this._makeNode(a,i,m.extend({points:m.trim(r)},f||{}))},text:function(){var a=this._args(arguments,["x","y","value"]);if(typeof a.x=="string"&&arguments.length<4){a.value=a.x;a.settings=a.y;a.x=a.y=null}return this._text(a.parent,"text",a.value,m.extend({x:a.x&&t(a.x)?a.x.join(" "):a.x,y:a.y&&t(a.y)?a.y.join(" "):a.y},a.settings||{}))},textpath:function(){var a=this._args(arguments,["path","value"]),i=this._text(a.parent,"textPath",a.value,a.settings||{});
i.setAttributeNS(m.svg.xlinkNS,"href",a.path);return i},_text:function(a,i,h,f){a=this._makeNode(a,i,f);if(typeof h=="string")a.appendChild(a.ownerDocument.createTextNode(h));else for(i=0;i<h._parts.length;i++){f=h._parts[i];if(f[0]=="tspan"){var r=this._makeNode(a,f[0],f[2]);r.appendChild(a.ownerDocument.createTextNode(f[1]));a.appendChild(r)}else if(f[0]=="tref"){r=this._makeNode(a,f[0],f[2]);r.setAttributeNS(m.svg.xlinkNS,"href",f[1]);a.appendChild(r)}else if(f[0]=="textpath"){r=m.extend({},f[2]);
r.href=null;r=this._makeNode(a,f[0],r);r.setAttributeNS(m.svg.xlinkNS,"href",f[2].href);r.appendChild(a.ownerDocument.createTextNode(f[1]));a.appendChild(r)}else a.appendChild(a.ownerDocument.createTextNode(f[1]))}return a},other:function(){var a=this._args(arguments,["name"]);return this._makeNode(a.parent,a.name,a.settings||{})},_makeNode:function(a,i,h){a=a||this._svg;var f=this._svg.ownerDocument.createElementNS(m.svg.svgNS,i);for(i in h){var r=h[i];if(r!=null&&r!=null&&(typeof r!="string"||r!=
""))f.setAttribute(m.svg._attrNames[i]||i,r)}a.appendChild(f);return f},add:function(a){var i=this._args(arguments.length==1?[null,a]:arguments,["node"]),h=this;i.parent=i.parent||this._svg;try{if(m.svg._renesis)throw"Force traversal";i.parent.appendChild(i.node.cloneNode(true))}catch(f){i.node=i.node.jquery?i.node:m(i.node);i.node.each(function(){var r=h._cloneAsSVG(this);r&&i.parent.appendChild(r)})}return this},_cloneAsSVG:function(a){var i=null;if(a.nodeType==1){i=this._svg.ownerDocument.createElementNS(m.svg.svgNS,
this._checkName(a.nodeName));for(var h=0;h<a.attributes.length;h++){var f=a.attributes.item(h);if(f.nodeName!="xmlns"&&f.nodeValue)f.prefix=="xlink"?i.setAttributeNS(m.svg.xlinkNS,f.localName,f.nodeValue):i.setAttribute(this._checkName(f.nodeName),f.nodeValue)}for(h=0;h<a.childNodes.length;h++)(f=this._cloneAsSVG(a.childNodes[h]))&&i.appendChild(f)}else if(a.nodeType==3){if(m.trim(a.nodeValue))i=this._svg.ownerDocument.createTextNode(a.nodeValue)}else if(a.nodeType==4)if(m.trim(a.nodeValue))try{i=
this._svg.ownerDocument.createCDATASection(a.nodeValue)}catch(r){i=this._svg.ownerDocument.createTextNode(a.nodeValue.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"))}return i},_checkName:function(a){a=a.substring(0,1)>="A"&&a.substring(0,1)<="Z"?a.toLowerCase():a;return a.substring(0,4)=="svg:"?a.substring(4):a},load:function(a,i){i=typeof i=="boolean"?{addTo:i}:typeof i=="function"?{onLoad:i}:i||{};i.addTo||this.clear(false);var h=[this._svg.getAttribute("width"),this._svg.getAttribute("height")],
f=this,r=function(y){y=m.svg.local.errorLoadingText+": "+y;i.onLoad?i.onLoad.apply(f._container||f._svg,[f,y]):f.text(null,10,20,y)},x=function(y){var D=new ActiveXObject("Microsoft.XMLDOM");D.validateOnParse=false;D.resolveExternals=false;D.async=false;D.loadXML(y);if(D.parseError.errorCode!=0){r(D.parseError.reason);return null}return D},F=function(y){if(y)if(y.documentElement.nodeName!="svg"){var D=y.getElementsByTagName("parsererror");y=D.length?D[0].getElementsByTagName("div"):[];r(!D.length?
"???":(y.length?y[0]:D[0]).firstChild.nodeValue)}else{var O={};for(D=0;D<y.documentElement.attributes.length;D++){var L=y.documentElement.attributes.item(D);if(!(L.nodeName=="version"||L.nodeName.substring(0,5)=="xmlns"))O[L.nodeName]=L.nodeValue}f.configure(O,true);y=y.documentElement.childNodes;for(D=0;D<y.length;D++)try{if(m.svg._renesis)throw"Force traversal";f._svg.appendChild(y[D].cloneNode(true));y[D].nodeName=="script"&&m.globalEval(y[D].textContent)}catch(U){f.add(null,y[D])}i.changeSize||
f.configure({width:h[0],height:h[1]});if(i.onLoad)i.onLoad.apply(f._container||f._svg,[f])}};a.match("<svg")?F(m.browser.msie?x(a):(new DOMParser).parseFromString(a,"text/xml")):m.ajax({url:a,dataType:m.browser.msie?"text":"xml",success:function(y){F(m.browser.msie?x(y):y)},error:function(y,D,O){r(D+(O?" "+O.message:""))}});return this},remove:function(a){a=a.jquery?a[0]:a;a.parentNode.removeChild(a);return this},clear:function(a){for(a&&this.configure({},true);this._svg.firstChild;)this._svg.removeChild(this._svg.firstChild);
return this},toSVG:function(a){a=a||this._svg;return typeof XMLSerializer=="undefined"?this._toSVG(a):(new XMLSerializer).serializeToString(a)},_toSVG:function(a){var i="";if(!a)return i;if(a.nodeType==3)i=a.nodeValue;else if(a.nodeType==4)i="<![CDATA["+a.nodeValue+"]]\>";else{i="<"+a.nodeName;if(a.attributes)for(var h=0;h<a.attributes.length;h++){var f=a.attributes.item(h);m.trim(f.nodeValue)==""||f.nodeValue.match(/^\[object/)||f.nodeValue.match(/^function/)||(i+=" "+(f.namespaceURI==m.svg.xlinkNS?
"xlink:":"")+f.nodeName+'="'+f.nodeValue+'"')}if(a.firstChild){i+=">";for(h=a.firstChild;h;){i+=this._toSVG(h);h=h.nextSibling}i+="</"+a.nodeName+">"}else i+="/>"}return i},_escapeXML:function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");return a=a.replace(/>/g,"&gt;")}});m.extend(B.prototype,{reset:function(){this._path="";return this},move:function(a,i,h){h=t(a)?i:h;return this._coords(h?"m":"M",a,i)},line:function(a,i,h){h=t(a)?i:h;return this._coords(h?"l":"L",a,i)},horiz:function(a,
i){this._path+=(i?"h":"H")+(t(a)?a.join(" "):a);return this},vert:function(a,i){this._path+=(i?"v":"V")+(t(a)?a.join(" "):a);return this},curveC:function(a,i,h,f,r,x,F){F=t(a)?i:F;return this._coords(F?"c":"C",a,i,h,f,r,x)},smoothC:function(a,i,h,f,r){r=t(a)?i:r;return this._coords(r?"s":"S",a,i,h,f)},curveQ:function(a,i,h,f,r){r=t(a)?i:r;return this._coords(r?"q":"Q",a,i,h,f)},smoothQ:function(a,i,h){h=t(a)?i:h;return this._coords(h?"t":"T",a,i)},_coords:function(a,i,h,f,r,x,F){if(t(i))for(h=0;h<
i.length;h++){f=i[h];this._path+=(h==0?a:" ")+f[0]+","+f[1]+(f.length<4?"":" "+f[2]+","+f[3]+(f.length<6?"":" "+f[4]+","+f[5]))}else this._path+=a+i+","+h+(f==null?"":" "+f+","+r+(x==null?"":" "+x+","+F));return this},arc:function(a,i,h,f,r,x,F,y){y=t(a)?i:y;this._path+=y?"a":"A";if(t(a))for(i=0;i<a.length;i++){h=a[i];this._path+=(i==0?"":" ")+h[0]+","+h[1]+" "+h[2]+" "+(h[3]?"1":"0")+","+(h[4]?"1":"0")+" "+h[5]+","+h[6]}else this._path+=a+","+i+" "+h+" "+(f?"1":"0")+","+(r?"1":"0")+" "+x+","+F;return this},
close:function(){this._path+="z";return this},path:function(){return this._path}});B.prototype.moveTo=B.prototype.move;B.prototype.lineTo=B.prototype.line;B.prototype.horizTo=B.prototype.horiz;B.prototype.vertTo=B.prototype.vert;B.prototype.curveCTo=B.prototype.curveC;B.prototype.smoothCTo=B.prototype.smoothC;B.prototype.curveQTo=B.prototype.curveQ;B.prototype.smoothQTo=B.prototype.smoothQ;B.prototype.arcTo=B.prototype.arc;m.extend(E.prototype,{reset:function(){this._parts=[];return this},string:function(a){this._parts[this._parts.length]=
["text",a];return this},span:function(a,i){this._parts[this._parts.length]=["tspan",a,i];return this},ref:function(a,i){this._parts[this._parts.length]=["tref",a,i];return this},path:function(a,i,h){this._parts[this._parts.length]=["textpath",i,m.extend({href:a},h||{})];return this}});m.fn.svg=function(a){var i=Array.prototype.slice.call(arguments,1);if(typeof a=="string"&&a=="get")return m.svg["_"+a+"SVG"].apply(m.svg,[this[0]].concat(i));return this.each(function(){typeof a=="string"?m.svg["_"+
a+"SVG"].apply(m.svg,[this].concat(i)):m.svg._attachSVG(this,a||{})})};m.svg=new K})(jQuery);/*
 http://keith-wood.name/svg.html
 SVG/jQuery DOM compatibility for jQuery v1.4.3.
 Written by Keith Wood (kbwood{at}iinet.com.au) April 2009.
 Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and 
 MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses. 
 Please attribute the author if you use it. */
(function(m){function K(E){for(var t=0;t<E.length;t++)if(E[t].nodeType==1&&E[t].namespaceURI==m.svg.svgNS)return true;return false}function P(E){return E.nodeType==1&&E.namespaceURI==m.svg.svgNS}m.fn.addClass=function(E){return function(t){t=t||"";return this.each(function(){if(P(this)){var a=this;m.each(t.split(/\s+/),function(i,h){var f=a.className?a.className.baseVal:a.getAttribute("class");if(m.inArray(h,f.split(/\s+/))==-1){f+=(f?" ":"")+h;a.className?a.className.baseVal=f:a.setAttribute("class",
f)}})}else E.apply(m(this),[t])})}}(m.fn.addClass);m.fn.removeClass=function(E){return function(t){t=t||"";return this.each(function(){if(P(this)){var a=this;m.each(t.split(/\s+/),function(i,h){var f=a.className?a.className.baseVal:a.getAttribute("class");f=m.grep(f.split(/\s+/),function(r){return r!=h}).join(" ");a.className?a.className.baseVal=f:a.setAttribute("class",f)})}else E.apply(m(this),[t])})}}(m.fn.removeClass);m.fn.toggleClass=function(E){return function(t,a){return this.each(function(){if(P(this)){if(typeof a!==
"boolean")a=!m(this).hasClass(t);m(this)[(a?"add":"remove")+"Class"](t)}else E.apply(m(this),[t,a])})}}(m.fn.toggleClass);m.fn.hasClass=function(E){return function(t){t=t||"";var a=false;this.each(function(){if(P(this)){var i=(this.className?this.className.baseVal:this.getAttribute("class")).split(/\s+/);a=m.inArray(t,i)>-1}else a=E.apply(m(this),[t]);return!a});return a}}(m.fn.hasClass);m.fn.attr=function(E){return function(t,a,i){if(typeof t==="string"&&a===undefined){var h=E.apply(this,[t,a,i]);
if(h&&h.baseVal&&h.baseVal.numberOfItems!=null){a="";h=h.baseVal;for(var f=0;f<h.numberOfItems;f++){var r=h.getItem(f);switch(r.type){case 1:a+=" matrix("+r.matrix.a+","+r.matrix.b+","+r.matrix.c+","+r.matrix.d+","+r.matrix.e+","+r.matrix.f+")";break;case 2:a+=" translate("+r.matrix.e+","+r.matrix.f+")";break;case 3:a+=" scale("+r.matrix.a+","+r.matrix.d+")";break;case 4:a+=" rotate("+r.angle+")";break;case 5:a+=" skewX("+r.angle+")";break;case 6:a+=" skewY("+r.angle+")"}}h=a.substring(1)}return h&&
h.baseVal?h.baseVal.valueAsString:h}var x=t;if(typeof t==="string"){x={};x[t]=a}return this.each(function(){if(P(this))for(var F in x){var y=m.isFunction(x[F])?x[F]():x[F];i?this.style[F]=y:this.setAttribute(F,y)}else E.apply(m(this),[t,a,i])})}}(m.fn.attr);m.fn.removeAttr=function(E){return function(t){return this.each(function(){if(P(this))this[t]&&this[t].baseVal?this[t].baseVal.value="":this.setAttribute(t,"");else E.apply(m(this),[t])})}}(m.fn.removeAttr);m.expr.relative["+"]=function(E){return function(t,
a,i){E(t,a,i||K(t))}}(m.expr.relative["+"]);m.expr.relative[">"]=function(E){return function(t,a,i){E(t,a,i||K(t))}}(m.expr.relative[">"]);m.expr.relative[""]=function(E){return function(t,a,i){E(t,a,i||K(t))}}(m.expr.relative[""]);m.expr.relative["~"]=function(E){return function(t,a,i){E(t,a,i||K(t))}}(m.expr.relative["~"]);m.expr.find.ID=function(E){return function(t,a,i){return P(a)?[a.ownerDocument.getElementById(t[1])]:E(t,a,i)}}(m.expr.find.ID);var B=document.createElement("div");B.appendChild(document.createComment(""));
if(B.getElementsByTagName("*").length>0)m.expr.find.TAG=function(E,t){var a=t.getElementsByTagName(E[1]);if(E[1]==="*"){for(var i=[],h=0;a[h]||a.item(h);h++)if((a[h]||a.item(h)).nodeType===1)i.push(a[h]||a.item(h));a=i}return a};m.expr.preFilter.CLASS=function(E,t,a,i,h,f){E=" "+E[1].replace(/\\/g,"")+" ";if(f)return E;f=0;for(var r={};r!=null;f++){r=t[f];if(!r)try{r=t.item(f)}catch(x){}if(r){var F=!P(r)?r.className:(r.className?r.className.baseVal:"")||r.getAttribute("class");if(h^(F&&(" "+F+" ").indexOf(E)>
-1))a||i.push(r);else if(a)t[f]=false}}return false};m.expr.filter.CLASS=function(E,t){return(" "+(!P(E)?E.className:E.className?E.className.baseVal:E.getAttribute("class"))+" ").indexOf(t)>-1};m.expr.filter.ATTR=function(E){return function(t,a){var i=null;if(P(t)){i=a[1];m.expr.attrHandle[i]=function(f){return(f=f.getAttribute(i))&&f.baseVal||f}}var h=E(t,a);if(i)m.expr.attrHandle[i]=null;return h}}(m.expr.filter.ATTR)})(jQuery);var CodeMirror=function(){function m(c,j){function p(b){var d={line:0,ch:0};o(d,{line:C.length-1,ch:C[C.length-1].text.length},Z(b),d,d);Ga=true}function e(){if(N.readOnly!="nocursor"){if(!Ja){if(N.onFocus)N.onFocus(Aa);Ja=true;if(Ca.className.search(/\bCodeMirror-focused\b/)==-1)Ca.className+=" CodeMirror-focused";jb||cb()}ta();Pb()}}function k(){if(Ja){if(N.onBlur)N.onBlur(Aa);Ja=false;Ca.className=Ca.className.replace(" CodeMirror-focused","")}clearInterval(xb);setTimeout(function(){Ja||(Ma=null)},
150)}function o(b,d,g,l,q){if(Ea){for(var u=[],s=b.line,v=d.line+1;s<v;++s)u.push(C[s].text);for(Ea.addChange(b.line,g.length,u);Ea.done.length>N.undoDepth;)Ea.done.shift()}aa(b,d,g,l,q)}function n(b,d){var g=b.pop();if(g){for(var l=[],q=g.start+g.added,u=g.start;u<q;++u)l.push(C[u].text);d.push({start:g.start,added:g.old.length,old:l});u=g.start+g.old.length-1;l=l[l.length-1];var s=g.old[g.old.length-1];if(s)if(l){for(var v=l.length,z=s.length;v>=0&&z>=0;--v,--z)if(l.charAt(v)!=s.charAt(z))break;
l=z+1}else l=s.length;else l=l?l.length:0;u=pa({line:u,ch:l});aa({line:g.start,ch:0},{line:q-1,ch:C[q-1].text.length},g.old,u,u);Ga=true}}function G(){n(Ea.done,Ea.undone)}function R(){n(Ea.undone,Ea.done)}function aa(b,d,g,l,q){for(var u=false,s=kb.length,v=b.line;v<=d.line;++v)if(C[v].text.length==s){u=true;break}var z=d.line-b.line,w=C[b.line],Q=C[d.line];if(w==Q)if(g.length==1)w.replace(b.ch,d.ch,g[0]);else{Q=w.split(d.ch,g[g.length-1]);var ba=[b.line+1,z];w.replace(b.ch,null,g[0]);v=1;for(var X=
g.length-1;v<X;++v)ba.push(E.inheritMarks(g[v],w));ba.push(Q);C.splice.apply(C,ba)}else if(g.length==1){w.replace(b.ch,null,g[0]);Q.replace(null,d.ch,"");w.append(Q);C.splice(b.line+1,z)}else{ba=[b.line+1,z-1];w.replace(b.ch,null,g[0]);Q.replace(null,d.ch,g[g.length-1]);v=1;for(X=g.length-1;v<X;++v)ba.push(E.inheritMarks(g[v],w));C.splice.apply(C,ba)}v=b.line;for(X=v+g.length;v<X;++v){w=C[v].text;if(w.length>s){kb=w;s=w.length;db=null;u=false}}if(u){s=0;kb="";db=null;v=0;for(X=C.length;v<X;++v){w=
C[v].text;if(w.length>s){s=w.length;kb=w}}}u=[];z=g.length-z-1;v=0;for(w=Na.length;v<w;++v){s=Na[v];if(s<b.line)u.push(s);else s>d.line&&u.push(s+z)}X=b.line;v=b.line+g.length;for(s=pb(X);X<v;++X){w=C[X];w.highlight(ra,s);w.stateAfter=K(ra,s)}u.push(b.line+g.length);Na=u;yb(100);ya.push({from:b.line,to:d.line+1,diff:z});zb={from:b,to:d,text:g};eb(l,q,A.from.line<=Math.min(d.line,d.line+z)?A.from.line:A.from.line+z,A.to.line<=Math.min(d.line,d.line+z)?A.to.line:A.to.line+z);Ha.style.height=C.length*
Ka()+2*va.offsetTop+"px"}function ia(b,d,g){function l(u){if(U(u,d))return u;if(!U(g,u))return q;var s=u.line+b.length-(g.line-d.line)-1,v=u.ch;if(u.line==g.line)v+=b[b.length-1].length-(g.ch-(g.line==d.line?d.ch:0));return{line:s,ch:v}}d=pa(d);g=g?pa(g):d;b=Z(b);var q;Fa(b,d,g,function(u){q=u;return{from:l(A.from),to:l(A.to)}});return q}function da(b,d){Fa(Z(b),A.from,A.to,function(g){return d=="end"?{from:g,to:g}:d=="start"?{from:A.from,to:A.from}:{from:A.from,to:g}})}function Fa(b,d,g,l){l=l({line:d.line+
b.length-1,ch:b.length==1?b[0].length+d.ch:b[b.length-1].length});o(d,g,b,l.from,l.to)}function ka(b,d){var g=b.line,l=d.line;if(g==l)return C[g].text.slice(b.ch,d.ch);var q=[C[g].text.slice(b.ch)];for(g+=1;g<l;++g)q.push(C[g].text);q.push(C[l].text.slice(0,d.ch));return q.join("\n")}function Ya(){return ka(A.from,A.to)}function ta(){Ab||Bb.set(2E3,function(){Cb();fb();Ja&&ta();Db()})}function Ba(b){function d(){Cb();var l=fb();if(l&&b){if(l=="moved"&&ea[b]==null)ea[b]=true;if(l=="changed")ea[b]=
false}if(!l&&!g){g=true;Bb.set(80,d)}else{Ab=false;ta()}Db()}var g=false;Ab=true;Bb.set(20,d)}function fb(){function b(Oa,Pa){for(var Da=0;;){var Za=g.indexOf("\n",Da);if(Za==-1||(g.charAt(Za-1)=="\r"?Za-1:Za)>=Oa)return{line:Pa,ch:Oa-Da};++Pa;Da=Za+1}}if(!(jb||!Ja)){var d=false,g=na.value,l=ja(na);if(!l)return false;d=wa.text!=g;var q=$a,u=d||l.start!=wa.start||l.end!=(q?wa.start:wa.end);if(!u&&!q)return false;if(d){Ma=$a=null;if(N.readOnly){Ga=true;return"changed"}}var s=b(l.start,wa.from),v=b(l.end,
wa.from);if(q){var z=l.start==q.anchor?v:s;v=Ma?A.to:l.start==q.anchor?s:v;if(A.inverted=U(z,v))s=z;else{$a=null;s=v;v=z}}if(s.line==v.line&&s.line==A.from.line&&s.line==A.to.line&&!Ma)Ga=false;if(d){z=0;q=g.length;for(var w=Math.min(q,wa.text.length),Q,ba=wa.from,X=-1;z<w&&(Q=g.charAt(z))==wa.text.charAt(z);){++z;if(Q=="\n"){ba++;X=z}}w=X>-1?z-X:z;for(var Ia=wa.to-1,qa=wa.text.length;;){Q=wa.text.charAt(qa);if(g.charAt(q)!=Q){++q;++qa;break}Q=="\n"&&Ia--;if(qa<=z||q<=z)break;--q;--qa}X=wa.text.lastIndexOf("\n",
qa-1);o({line:ba,ch:w},{line:Ia,ch:X==-1?qa:qa-X-1},Z(g.slice(z,q)),s,v);if(ba!=Ia||s.line!=ba)Ga=true}else eb(s,v);wa.text=g;wa.start=l.start;wa.end=l.end;return d?"changed":u?"moved":false}}function cb(){for(var b=[],d=Math.max(0,A.from.line-1),g=Math.min(C.length,A.to.line+2),l=d;l<g;++l)b.push(C[l].text);b=na.value=b.join(J);var q=A.from.ch,u=A.to.ch;for(l=d;l<A.from.line;++l)q+=J.length+C[l].text.length;for(l=d;l<A.to.line;++l)u+=J.length+C[l].text.length;wa={text:b,from:d,to:g,start:q,end:u};
fa(na,q,$a?q:u)}function Qa(){N.readOnly!="nocursor"&&na.focus()}function qb(){if(Ra.getBoundingClientRect){var b=Ra.getBoundingClientRect(),d=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);if(b.top<0||b.bottom>d)Ra.scrollIntoView()}}function Qb(){var b=Eb(A.inverted?A.from:A.to);return Rb(b.x,b.y,b.x,b.yBot)}function Rb(b,d,g,l){var q=va.offsetLeft,u=va.offsetTop,s=Ka();d+=u;l+=u;b+=q;g+=q;var v=ca.clientHeight,z=ca.scrollTop;q=false;u=true;if(d<z){ca.scrollTop=
Math.max(0,d-2*s);q=true}else if(l>z+v){ca.scrollTop=l+s-v;q=true}d=ca.clientWidth;l=ca.scrollLeft;s=N.fixedGutter?La.clientWidth:0;if(b<l+s){if(b<50)b=0;ca.scrollLeft=Math.max(0,b-10-s);q=true}else if(g>d+l){ca.scrollLeft=g+10-d;q=true;if(g>Ha.clientWidth)u=false}if(q&&N.onScroll)N.onScroll(Aa);return u}function Sb(){var b=Ka(),d=ca.scrollTop-va.offsetTop;return{from:Math.min(C.length,Math.max(0,Math.floor(d/b))),to:Math.min(C.length,Math.ceil((d+ca.clientHeight)/b))}}function rb(b){if(ca.clientWidth){for(var d=
b===true?[]:[{from:xa,to:Ta,domStart:0}],g=0,l=b.length||0;g<l;++g){for(var q=b[g],u=[],s=q.diff||0,v=0,z=d.length;v<z;++v){var w=d[v];if(q.to<=w.from)u.push({from:w.from+s,to:w.to+s,domStart:w.domStart});else if(w.to<=q.from)u.push(w);else{q.from>w.from&&u.push({from:w.from,to:q.from,domStart:w.domStart});q.to<w.to&&u.push({from:q.to+s,to:w.to+s,domStart:w.domStart+(q.to-w.from)})}}d=u}s=Sb();b=Math.min(xa,Math.max(s.from-3,0));q=Math.min(C.length,Math.max(Ta,s.to+3));u=[];v=0;z=Ta-xa;var Q=b,ba=
0;g=0;for(l=d.length;g<l;++g){w=d[g];if(!(w.to<=b)){if(w.from>=q)break;if(w.domStart>v||w.from>Q){u.push({from:Q,to:w.from,domSize:w.domStart-v,domStart:v});ba+=w.from-Q}Q=w.to;v=w.domStart+(w.to-w.from)}}if(v!=z||Q!=q){ba+=Math.abs(q-Q);u.push({from:Q,to:q,domSize:z-v,domStart:v});if(q-Q!=z-v)ab=true}if(u.length){za.style.display="none";if(ba>(s.to-s.from)*0.3){w=b=Math.max(s.from-10,0);d=q=Math.min(s.to+7,C.length);g=[];l={line:w,ch:0};for(l=U(A.from,l)&&!U(A.to,l);w<d;++w){v=s=null;if(l){s=0;if(A.to.line==
w){l=false;v=A.to.ch}}else if(A.from.line==w)if(A.to.line==w){s=A.from.ch;v=A.to.ch}else{l=true;s=A.from.ch}g.push(C[w].getHTML(s,v,true))}za.innerHTML=g.join("")}else{d=A.from.line;g=A.to.line;l=0;w=V&&Ua.createElement("div");s=0;for(v=u.length;s<v;++s){z=u[s];Q=z.to-z.from-z.domSize;ba=za.childNodes[z.domStart+z.domSize+l]||null;if(V)for(var X=Math.max(-Q,z.domSize);X>0;--X)za.removeChild(ba?ba.previousSibling:za.lastChild);else if(Q){for(X=Math.max(0,Q);X>0;--X)za.insertBefore(Ua.createElement("pre"),
ba);for(X=Math.max(0,-Q);X>0;--X)za.removeChild(ba?ba.previousSibling:za.lastChild)}var Ia=za.childNodes[z.domStart+l],qa=d<z.from&&g>=z.from;for(X=z.from;X<z.to;++X){var Oa=null,Pa=null;if(qa){Oa=0;if(g==X){qa=false;Pa=A.to.ch}}else if(d==X)if(g==X){Oa=A.from.ch;Pa=A.to.ch}else{qa=true;Oa=A.from.ch}if(V){w.innerHTML=C[X].getHTML(Oa,Pa,true);za.insertBefore(w.firstChild,ba)}else{Ia.innerHTML=C[X].getHTML(Oa,Pa,false);Ia.className=C[X].className||"";Ia=Ia.nextSibling}}l+=Q}}za.style.display="";d=b!=
xa||q!=Ta||Tb!=ca.clientHeight;xa=b;Ta=q;sb.style.top=b*Ka()+"px";if(d){Tb=ca.clientHeight;Ha.style.height=C.length*Ka()+2*va.offsetTop+"px"}if(d||ab)Ub();if(db==null)db=Fb(kb);if(db>ca.clientWidth){va.style.width=db+"px";Ha.style.width="";Ha.style.width=ca.scrollWidth+"px"}else va.style.width=Ha.style.width="";if(za.childNodes.length!=Ta-xa)throw Error("BAD PATCH! "+JSON.stringify(u)+" size="+(Ta-xa)+" nodes="+za.childNodes.length);Vb()}}else xa=Ta=0}function Ub(){if(N.gutter||N.lineNumbers){var b=
sb.offsetHeight,d=ca.clientHeight;La.style.height=(b-d<2?d:b)+"px";b=[];for(d=xa;d<Math.max(Ta,xa+1);++d){var g=C[d].gutterMarker,l=N.lineNumbers?d+N.firstLineNumber:null;if(g&&g.text)l=g.text.replace("%N%",l!=null?l:"");else if(l==null)l="\u00a0";b.push(g&&g.style?'<pre class="'+g.style+'">':"<pre>",l,"</pre>")}La.style.display="none";tb.innerHTML=b.join("");b=String(C.length).length;d=tb.firstChild;g=d.textContent||d.innerText||d.nodeValue||"";for(l="";g.length+l.length<b;)l+="\u00a0";l&&d.insertBefore(Ua.createTextNode(l),
d.firstChild);La.style.display="";va.style.marginLeft=La.offsetWidth+"px";ab=false}}function Vb(){var b=A.inverted?A.from:A.to,d=Ka(),g=Wb(b.line,b.ch);lb.style.top=Math.max(Math.min(b.line*d-ca.scrollTop,ca.offsetHeight),0)+"px";lb.style.left=g-ca.scrollLeft+"px";if(L(A.from,A.to)){Ra.style.top=(b.line-xa)*d+"px";Ra.style.left=g+"px";Ra.style.display=""}else Ra.style.display="none"}function Va(b,d){var g=Ma&&pa(Ma);if(g)if(U(g,b))b=g;else if(U(d,g))d=g;eb(b,d)}function eb(b,d,g,l){if(!(L(A.from,
b)&&L(A.to,d))){if(U(d,b)){var q=d;d=b;b=q}if(L(b,d))A.inverted=false;else if(L(b,A.to))A.inverted=false;else if(L(d,A.from))A.inverted=true;if(g==null){g=A.from.line;l=A.to.line}if(L(b,d))L(A.from,A.to)||ya.push({from:g,to:l+1});else if(L(A.from,A.to))ya.push({from:b.line,to:d.line+1});else{L(b,A.from)||(b.line<g?ya.push({from:b.line,to:Math.min(d.line,g)+1}):ya.push({from:g,to:Math.min(l,b.line)+1}));L(d,A.to)||(d.line<l?ya.push({from:Math.max(g,b.line),to:l+1}):ya.push({from:Math.max(b.line,l),
to:d.line+1}))}A.from=b;A.to=d;Wa=true}}function Xa(b,d,g){b=pa({line:b,ch:d||0});(g?Va:eb)(b,b)}function bb(b){return Math.max(0,Math.min(b,C.length-1))}function pa(b){if(b.line<0)return{line:0,ch:0};if(b.line>=C.length)return{line:C.length-1,ch:C[C.length-1].text.length};var d=b.ch,g=C[b.line].text.length;return d==null||d>g?{line:b.line,ch:g}:d<0?{line:b.line,ch:0}:b}function Xb(b){for(var d=C[b.line].text,g=b.ch,l=b.ch;g>0&&/\w/.test(d.charAt(g-1));)--g;for(;l<d.length&&/\w/.test(d.charAt(l));)++l;
Va({line:b.line,ch:g},{line:b.line,ch:l})}function ic(b){Va({line:b,ch:0},{line:b,ch:C[b].text.length})}function jc(b){function d(g){if(L(A.from,A.to))return gb(A.from.line,g);for(var l=A.to.line-(A.to.ch?0:1),q=A.from.line;q<=l;++q)gb(q,g)}Ma=null;switch(N.tabMode){case "default":return false;case "indent":d("smart");break;case "classic":if(L(A.from,A.to)){b?gb(A.from.line,"smart"):da("\t","end");break}case "shift":d(b?"subtract":"add")}return true}function gb(b,d){if(d=="smart")if(ra.indent)var g=
pb(b);else d="prev";var l=C[b],q=l.indentation(),u=l.text.match(/^\s*/)[0],s;if(d=="prev")s=b?C[b-1].indentation():0;else if(d=="smart")s=ra.indent(g,l.text.slice(u.length));else if(d=="add")s=q+N.indentUnit;else if(d=="subtract")s=q-N.indentUnit;s=Math.max(0,s);if(s-q){q="";g=0;if(N.indentWithTabs)for(l=Math.floor(s/ma);l;--l){g+=ma;q+="\t"}for(;g<s;){++g;q+=" "}}else{if(A.from.line!=b&&A.to.line!=b)return;q=u}ia(q,{line:b,ch:0},{line:b,ch:u.length})}function Yb(){ra=m.getMode(N,N.mode);for(var b=
0,d=C.length;b<d;++b)C[b].stateAfter=null;Na=[0];yb()}function kc(){var b=N.gutter||N.lineNumbers;La.style.display=b?"":"none";if(b)ab=true;else za.parentNode.style.marginLeft=0}function Gb(b,d,g){b=pa(b);d=pa(d);var l=[];if(b.line==d.line)mark=C[b.line].addMark(b.ch,d.ch,g,l);else{mark=C[b.line].addMark(b.ch,null,g,l);for(var q=b.line+1,u=d.line;q<u;++q)mark=C[q].addMark(0,null,g,l);mark=C[d.line].addMark(0,d.ch,g,l)}ya.push({from:b.line,to:d.line+1});return new Hb(l)}function Hb(b){this.set=b}function Fb(b){Sa.innerHTML=
"<pre><span>x</span></pre>";Sa.firstChild.firstChild.firstChild.nodeValue=b;return Sa.firstChild.firstChild.offsetWidth||10}function Wb(b,d){if(d==0)return 0;Sa.innerHTML="<pre><span>"+C[b].getHTML(null,null,false,d)+"</span></pre>";return Sa.firstChild.firstChild.offsetWidth}function Zb(b,d){function g(Q){Sa.innerHTML="<pre><span>"+l.getHTML(null,null,false,Q)+"</span></pre>";return Sa.firstChild.firstChild.offsetWidth}if(d<=0)return 0;for(var l=C[b],q=0,u=0,s=l.text.length,v,z=Math.min(s,Math.ceil(d/
Fb("x")));;){var w=g(z);if(w<=d&&z<s)z=Math.min(s,Math.ceil(z*1.2));else{v=w;s=z;break}}if(d>v)return s;z=Math.floor(s*0.8);w=g(z);if(w<d){q=z;u=w}for(;;){if(s-q<=1)return v-d>d-u?q:s;z=Math.ceil((q+s)/2);w=g(z);if(w>d){s=z;v=w}else{q=z;u=w}}}function Eb(b,d){var g=Ka(),l=b.line-(d?xa:0);return{x:Wb(b.line,b.ch),y:l*g,yBot:(l+1)*g}}function $b(b){b=Eb(b,true);var d=O(va);return{x:d.left+b.x,y:d.top+b.y,yBot:d.top+b.yBot}}function Ka(){var b=za.childNodes.length;if(b)return za.offsetHeight/b||1;Sa.innerHTML=
"<pre>x</pre>";return Sa.firstChild.offsetHeight||1}function hb(b,d){var g=O(ca,true),l,q;try{l=b.clientX;q=b.clientY}catch(u){return null}if(!d&&(l-g.left>ca.clientWidth||q-g.top>ca.clientHeight))return null;g=O(va,true);q=xa+Math.floor((q-g.top)/Ka());return pa({line:q,ch:Zb(bb(q),l-g.left)})}function ac(b){function d(){var s=Z(na.value).join("\n");s!=q&&ga(da)(s,"end");lb.style.position="relative";na.style.cssText=l;jb=false;cb();ta()}var g=hb(b);if(!(!g||window.opera)){if(L(A.from,A.to)||U(g,
A.from)||!U(g,A.to))ga(Xa)(g.line,g.ch);var l=na.style.cssText;lb.style.position="absolute";na.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(b.clientY-5)+"px; left: "+(b.clientX-5)+"px; z-index: 1000; background: white; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";jb=true;var q=na.value=Ya();Qa();fa(na,0,na.value.length);if(H){r(b);var u=F(window,"mouseup",function(){u();setTimeout(d,20)},true)}else setTimeout(d,50)}}function Pb(){clearInterval(xb);
var b=true;Ra.style.visibility="";xb=setInterval(function(){Ra.style.visibility=(b=!b)?"":"hidden"},650)}function bc(b){function d(Da,Za,lc){if(Da.text){var mb=Da.styles;Da=s?0:Da.text.length-1;for(var Ib,nb=s?0:mb.length-2,mc=s?mb.length:-2;nb!=mc;nb+=2*v){var ub=mb[nb];if(mb[nb+1]!=null&&mb[nb+1]!=ba)Da+=v*ub.length;else for(var Jb=s?0:ub.length-1,nc=s?ub.length:-1;Jb!=nc;Jb+=v,Da+=v)if(Da>=Za&&Da<lc&&Ia.test(Ib=ub.charAt(Jb))){var cc=Kb[Ib];if(cc.charAt(1)==">"==s)X.push(Ib);else if(X.pop()!=cc.charAt(0))return{pos:Da,
match:false};else if(!X.length)return{pos:Da,match:true}}}}}var g=A.inverted?A.from:A.to,l=C[g.line],q=g.ch-1,u=q>=0&&Kb[l.text.charAt(q)]||Kb[l.text.charAt(++q)];if(u){u.charAt(0);var s=u.charAt(1)==">",v=s?1:-1,z=l.styles,w=q+1;u=0;for(var Q=z.length;u<Q;u+=2)if((w-=z[u].length)<=0){var ba=z[u+1];break}var X=[l.text.charAt(q)],Ia=/[(){}[\]]/;u=g.line;for(Q=s?Math.min(u+100,C.length):Math.max(-1,u-100);u!=Q;u+=v){l=C[u];var qa=u==g.line;if(qa=d(l,qa&&s?q+1:0,qa&&!s?q:l.text.length))break}qa||(qa=
{pos:null,match:false});ba=qa.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";var Oa=Gb({line:g.line,ch:q},{line:g.line,ch:q+1},ba),Pa=qa.pos!=null&&Gb({line:u,ch:qa.pos},{line:u,ch:qa.pos+1},ba);g=ga(function(){Oa.clear();Pa&&Pa.clear()});if(b)setTimeout(g,800);else vb=g}}function dc(b){var d,g,l=b;for(b-=40;l>b;--l){if(l==0)return 0;var q=C[l-1];if(q.stateAfter)return l;q=q.indentation();if(g==null||d>q){g=l-1;d=q}}return g}function pb(b){var d=dc(b),g=d&&C[d-1].stateAfter;g=
g?K(ra,g):P(ra);for(var l=d;l<b;++l){var q=C[l];q.highlight(ra,g);q.stateAfter=K(ra,g)}ya.push({from:d,to:b});b<C.length&&!C[b].stateAfter&&Na.push(b);return g}function oc(){for(var b=+new Date+N.workTime,d=Na.length;Na.length;){var g=C[xa].stateAfter?Na.pop():xa;if(!(g>=C.length)){var l=dc(g),q=l&&C[l-1].stateAfter;q=q?K(ra,q):P(ra);for(var u=0,s=ra.compareStates,v=false,z=C.length;l<z;++l){var w=C[l],Q=w.stateAfter;if(+new Date>b){Na.push(l);yb(N.workDelay);v&&ya.push({from:g,to:l+1});return}var ba=
w.highlight(ra,q);if(ba)v=true;w.stateAfter=K(ra,q);if(s){if(Q&&s(Q,q))break}else if(ba!==false||!Q)u=0;else if(++u>3&&(!ra.indent||ra.indent(Q,"")==ra.indent(q,"")))return true}v&&ya.push({from:g,to:l+1})}}if(d&&N.onHighlightComplete)N.onHighlightComplete(Aa)}function yb(b){Na.length&&pc.set(b,ga(oc))}function Cb(){Ga=null;ya=[];zb=Wa=false}function Db(){var b=false;if(Wa)b=!Qb();if(ya.length)rb(ya);else{Wa&&Vb();ab&&Ub()}b&&Qb();if(Wa){qb();Pb()}if(Ja&&!jb&&(Ga===true||Ga!==false&&Wa))cb();Wa&&
N.matchBrackets&&setTimeout(ga(function(){if(vb){vb();vb=null}bc(false)}),20);b=zb;if(Wa&&N.onCursorActivity)N.onCursorActivity(Aa);if(b&&N.onChange&&Aa)N.onChange(Aa,b)}function ga(b){return function(){ec++||Cb();try{var d=b.apply(this,arguments)}finally{--ec||Db()}return d}}function fc(b,d,g){this.atOccurrence=false;if(g==null)g=typeof b=="string"&&b==b.toLowerCase();d=d&&typeof d=="object"?pa(d):{line:0,ch:0};this.pos={from:d,to:d};if(typeof b!="string")this.matches=function(u,s){if(u)for(var v=
C[s.line].text.slice(0,s.ch),z=v.match(b),w=0;z;){var Q=v.indexOf(z[0]);w+=Q;v=v.slice(Q+1);if(Q=v.match(b))z=Q;else break;w++}else{v=C[s.line].text.slice(s.ch);w=(z=v.match(b))&&s.ch+v.indexOf(z[0])}if(z)return{from:{line:s.line,ch:w},to:{line:s.line,ch:w+z[0].length},match:z}};else{if(g)b=b.toLowerCase();var l=g?function(u){return u.toLowerCase()}:function(u){return u},q=b.split("\n");this.matches=q.length==1?function(u,s){var v=l(C[s.line].text),z=b.length,w;if(u?s.ch>=z&&(w=v.lastIndexOf(b,s.ch-
z))!=-1:(w=v.indexOf(b,s.ch))!=-1)return{from:{line:s.line,ch:w},to:{line:s.line,ch:w+z}}}:function(u,s){var v=s.line,z=u?q.length-1:0,w=q[z],Q=l(C[v].text),ba=u?Q.indexOf(w)+w.length:Q.lastIndexOf(w);if(!(u?ba>=s.ch||ba!=w.length:ba<=s.ch||ba!=Q.length-w.length))for(;;){if(u?!v:v==C.length-1)break;Q=l(C[v+=u?-1:1].text);w=q[u?--z:++z];if(z>0&&z<q.length-1)if(Q!=w)break;else continue;z=u?Q.lastIndexOf(w):Q.indexOf(w)+w.length;if(u?z!=Q.length-w.length:z!=w.length)break;w={line:s.line,ch:ba};v={line:v,
ch:z};return{from:u?v:w,to:u?w:v}}}}}var N={},Lb=m.defaults,ob;for(ob in Lb)if(Lb.hasOwnProperty(ob))N[ob]=(j&&j.hasOwnProperty(ob)?j:Lb)[ob];var Ua=N.document,Ca=Ua.createElement("div");Ca.className="CodeMirror";Ca.innerHTML='<div style="overflow: hidden; position: relative; width: 1px; height: 0px;"><textarea style="position: absolute; width: 10000px;" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll cm-s-'+N.theme+'"><div style="position: relative"><div style="position: absolute; height: 0; width: 0; overflow: hidden;"></div><div style="position: relative"><div class="CodeMirror-gutter"><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative" draggable="true"><pre class="CodeMirror-cursor">&#160;</pre><div></div></div></div></div></div></div>';
c.appendChild?c.appendChild(Ca):c(Ca);var lb=Ca.firstChild,na=lb.firstChild,ca=Ca.lastChild,Ha=ca.firstChild,Sa=Ha.firstChild,sb=Sa.nextSibling,La=sb.firstChild,tb=La.firstChild,va=La.nextSibling.firstChild,Ra=va.firstChild,za=Ra.nextSibling;if(N.tabindex!=null)na.tabindex=N.tabindex;if(!N.gutter&&!N.lineNumbers)La.style.display="none";try{Fb("x")}catch(Mb){if(Mb.message.match(/unknown runtime/i))Mb=Error("A CodeMirror inside a P-style element does not work in Internet Explorer. (innerHTML bug)");
throw Mb;}var Bb=new y,pc=new y,xb,ra,C=[new E("")],Na,Ja;Yb();var A={from:{line:0,ch:0},to:{line:0,ch:0},inverted:false},Ma,$a,gc,Nb,Ob,Ga,ya,zb,Wa,jb,ab,xa=0,Ta=0,Tb=0,ib=null,wa,vb,kb="",db;ga(function(){p(N.value||"");Ga=false})();var Ea=new a;F(ca,"mousedown",ga(function(b){function d(z){var w=hb(z,true);if(w&&!L(w,q)){Ja||e();q=w;Va(l,w);Ga=false;var Q=Sb();if(w.line>=Q.to||w.line<Q.from)u=setTimeout(ga(function(){d(z)}),150)}}for(var g=b.target||b.srcElement;g!=Ca;g=g.parentNode)if(g.parentNode==
Ha&&g!=sb)return;for(g=b.target||b.srcElement;g!=Ca;g=g.parentNode)if(g.parentNode==tb){if(N.onGutterClick)N.onGutterClick(Aa,sa(tb.childNodes,g)+xa,b);return f(b)}var l=hb(b);switch(x(b)){case 3:H&&!oa&&ac(b);return;case 2:l&&Xa(l.line,l.ch,true);return}if(l){Ja||e();g=+new Date;if(Nb>g-400){f(b);return ic(l.line)}else if(gc>g-400){Nb=g;f(b);return Xb(l)}else gc=g;var q=l,u;if(W&&!L(A.from,A.to)&&!U(l,A.from)&&!U(A.to,l)){var s=F(Ua,"mouseup",ga(function(z){Ob=false;s();if(Math.abs(b.clientX-z.clientX)+
Math.abs(b.clientY-z.clientY)<10){f(z);Xa(l.line,l.ch,true);Qa()}}),true);Ob=true}else{f(b);Xa(l.line,l.ch,true);var v=F(Ua,"mousemove",ga(function(z){clearTimeout(u);f(z);d(z)}),true);s=F(Ua,"mouseup",ga(function(z){clearTimeout(u);var w=hb(z);w&&Va(l,w);f(z);Qa();Ga=true;v();s()}),true)}}else(b.target||b.srcElement)==ca&&f(b)}));F(ca,"dblclick",ga(function(b){var d=hb(b);if(d){Nb=+new Date;f(b);Xb(d)}}));F(va,"dragstart",function(b){var d=Ya();ha(d);b.dataTransfer.setDragImage($,0,0);b.dataTransfer.setData("Text",
d)});H||F(ca,"contextmenu",ac);F(ca,"scroll",function(){rb([]);if(N.fixedGutter)La.style.left=ca.scrollLeft+"px";if(N.onScroll)N.onScroll(Aa)});F(window,"resize",function(){rb(true)});F(na,"keyup",ga(function(b){if(!(N.onKeyEvent&&N.onKeyEvent(Aa,h(b)))){if($a){$a=null;Ga=true}if(b.keyCode==16)Ma=null}}));F(na,"input",function(){Ba(ib)});F(na,"keydown",ga(function(b){Ja||e();var d=b.keyCode;if(S&&d==27)b.returnValue=false;var g=(oa?b.metaKey:b.ctrlKey)&&!b.altKey,l=b.ctrlKey||b.altKey||b.metaKey;
Ma=d==16||b.shiftKey?Ma||(A.inverted?A.to:A.from):null;if(!(N.onKeyEvent&&N.onKeyEvent(Aa,h(b)))){if(d==33||d==34){g=d==34;d=Math.floor(ca.clientHeight/Ka());l=A.inverted?A.from:A.to;Xa(l.line+Math.max(d-1,1)*(g?1:-1),l.ch,true);return f(b)}if(g&&(d==36||d==35||oa&&(d==38||d==40))){g=d==36||d==38?{line:0,ch:0}:{line:C.length-1,ch:C[C.length-1].text.length};Va(g,g);return f(b)}if(g&&d==65){g=C.length-1;eb({line:0,ch:0},{line:g,ch:C[g].text.length});return f(b)}if(!N.readOnly){if(!l&&d==13)return;if(!l&&
d==9&&jc(b.shiftKey))return f(b);if(g&&d==90){G();return f(b)}if(g&&(b.shiftKey&&d==90||d==89)){R();return f(b)}}if(d==36)if(N.smartHome){g=Math.max(0,C[A.from.line].text.search(/\S/));Xa(A.from.line,A.from.ch<=g&&A.from.ch?0:g,true);return f(b)}ib=(g?"c":"")+(b.altKey?"a":"")+d;if(A.inverted&&ea[ib]===true)if(d=ja(na)){$a={anchor:d.start};fa(na,d.start,d.start)}if(!g&&!b.altKey)ib=null;Ba(ib)}}));F(na,"keypress",ga(function(b){if(!(N.onKeyEvent&&N.onKeyEvent(Aa,h(b)))){if(N.electricChars&&ra.electricChars){var d=
String.fromCharCode(b.charCode==null?b.keyCode:b.charCode);ra.electricChars.indexOf(d)>-1&&setTimeout(ga(function(){gb(A.to.line,"smart")}),50)}d=b.keyCode;if(d==13){if(!N.readOnly){da("\n","end");if(N.enterMode!="flat")gb(A.from.line,N.enterMode=="keep"?"prev":"smart")}f(b)}else!b.ctrlKey&&!b.altKey&&!b.metaKey&&d==9&&N.tabMode!="default"?f(b):Ba(ib)}}));F(na,"focus",e);F(na,"blur",k);F(ca,"dragenter",r);F(ca,"dragover",r);F(ca,"drop",ga(function(b){b.preventDefault();var d=hb(b,true),g=b.dataTransfer.files;
if(!(!d||N.readOnly))if(g&&g.length&&window.FileReader&&window.File){b=function(Q,ba){var X=new FileReader;X.onload=function(){q[ba]=X.result;if(++u==l){d=pa(d);var Ia=ia(q.join(""),d,d);Va(d,Ia)}};X.readAsText(Q)};for(var l=g.length,q=Array(l),u=0,s=0;s<l;++s)b(g[s],s)}else try{if(q=b.dataTransfer.getData("Text")){s=ia(q,d,d);var v=A.from,z=A.to;Va(d,s);Ob&&ia("",v,z);Qa()}}catch(w){}}));F(ca,"paste",function(){Qa();Ba()});F(na,"paste",function(){Ba()});F(na,"cut",function(){Ba()});var hc;try{hc=
Ua.activeElement==na}catch(qc){}hc?setTimeout(e,20):k();var Aa=Ca.CodeMirror={getValue:function(){for(var b=[],d=0,g=C.length;d<g;++d)b.push(C[d].text);return b.join("\n")},setValue:ga(p),getSelection:Ya,replaceSelection:ga(da),focus:function(){Qa();e();Ba()},setOption:function(b,d){N[b]=d;if(b=="lineNumbers"||b=="gutter"||b=="firstLineNumber")ga(kc)();else if(b=="mode"||b=="indentUnit")Yb();else if(b=="readOnly"&&d=="nocursor")na.blur();else if(b=="theme")ca.className=ca.className.replace(/cm-s-\w+/,
"cm-s-"+d)},getOption:function(b){return N[b]},undo:ga(G),redo:ga(R),indentLine:ga(function(b,d){if(b>=0&&b<C.length)gb(b,d==null?"smart":d?"add":"subtract")}),historySize:function(){return{undo:Ea.done.length,redo:Ea.undone.length}},getHistory:function(){return Ea},setHistory:function(b){Ea=b},clearHistory:function(){Ea=new a},matchBrackets:ga(function(){bc(true)}),getTokenAt:function(b){b=pa(b);return C[b.line].getTokenAt(ra,pb(b.line),b.ch)},getStateAfter:function(b){b=bb(b==null?C.length-1:b);
return pb(b+1)},cursorCoords:function(b){if(b==null)b=A.inverted;return $b(b?A.from:A.to)},charCoords:function(b){return $b(pa(b))},coordsChar:function(b){var d=O(va),g=bb(Math.min(C.length-1,xa+Math.floor((b.y-d.top)/Ka())));return pa({line:g,ch:Zb(bb(g),b.x-d.left)})},getSearchCursor:function(b,d,g){return new fc(b,d,g)},markText:ga(Gb),setMarker:ga(function(b,d,g){if(typeof b=="number")b=C[bb(b)];b.gutterMarker={text:d,style:g};ab=true;return b}),clearMarker:ga(function(b){if(typeof b=="number")b=
C[bb(b)];b.gutterMarker=null;ab=true}),setLineClass:ga(function(b,d){if(typeof b=="number"){var g=b;b=C[bb(b)]}else{g=sa(C,b);if(g==-1)return null}if(b.className!=d){b.className=d;ya.push({from:g,to:g+1})}return b}),lineInfo:function(b){if(typeof b=="number"){var d=b;b=C[b];if(!b)return null}else{d=sa(C,b);if(d==-1)return null}var g=b.gutterMarker;return{line:d,text:b.text,markerText:g&&g.text,markerClass:g&&g.style}},addWidget:function(b,d,g,l,q){b=Eb(pa(b));var u=b.yBot,s=b.x;d.style.position="absolute";
Ha.appendChild(d);if(l=="over")u=b.y;else if(l=="near"){l=Math.max(ca.offsetHeight,C.length*Ka());var v=Math.max(Ha.clientWidth,va.clientWidth)-va.offsetLeft;if(b.yBot+d.offsetHeight>l&&b.y>d.offsetHeight)u=b.y-d.offsetHeight;if(s+d.offsetWidth>v)s=v-d.offsetWidth}d.style.top=u+va.offsetTop+"px";d.style.left=d.style.right="";if(q=="right"){s=Ha.clientWidth-d.offsetWidth;d.style.right="0px"}else{if(q=="left")s=0;else if(q=="middle")s=(Ha.clientWidth-d.offsetWidth)/2;d.style.left=s+va.offsetLeft+"px"}g&&
Rb(s,u,s+d.offsetWidth,u+d.offsetHeight)},lineCount:function(){return C.length},getCursor:function(b){if(b==null)b=A.inverted;return{line:(b?A.from:A.to).line,ch:(b?A.from:A.to).ch}},somethingSelected:function(){return!L(A.from,A.to)},setCursor:ga(function(b,d){d==null&&typeof b.line=="number"?Xa(b.line,b.ch):Xa(b,d)}),setSelection:ga(function(b,d){eb(pa(b),pa(d||b))}),getLine:function(b){if(b>=0&&b<C.length)return C[b].text},setLine:ga(function(b,d){b>=0&&b<C.length&&ia(d,{line:b,ch:0},{line:b,ch:C[b].text.length})}),
removeLine:ga(function(b){b>=0&&b<C.length&&ia("",{line:b,ch:0},pa({line:b+1,ch:0}))}),replaceRange:ga(ia),getRange:function(b,d){return ka(pa(b),pa(d))},coordsFromIndex:function(b){var d=C.length,g=0,l,q,u;for(l=0;l<d;l++){u=C[l].text.length+1;if(g+u>b){q=b-g;break}g+=u}return pa({line:l,ch:q})},operation:function(b){return ga(b)()},refresh:function(){rb(true)},getInputField:function(){return na},getWrapperElement:function(){return Ca},getScrollerElement:function(){return ca},getGutterElement:function(){return La}},
Ab=false;Hb.prototype.clear=ga(function(){for(var b=0,d=this.set.length;b<d;++b)for(var g=this.set[b].marked,l=0;l<g.length;++l)g[l].set==this.set&&g.splice(l--,1);ya.push({from:0,to:C.length})});Hb.prototype.find=function(){for(var b,d,g=0,l=this.set.length;g<l;++g)for(var q=this.set[g],u=q.marked,s=0;s<u.length;++s){var v=u[s];if(v.set==this.set)if(v.from!=null||v.to!=null){var z=sa(C,q);if(z>-1){if(v.from!=null)b={line:z,ch:v.from};if(v.to!=null)d={line:z,ch:v.to}}}}return{from:b,to:d}};var Kb=
{"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},ec=0;fc.prototype={findNext:function(){return this.find(false)},findPrevious:function(){return this.find(true)},find:function(b){function d(q){q={line:q,ch:0};g.pos={from:q,to:q};return g.atOccurrence=false}for(var g=this,l=pa(b?this.pos.from:this.pos.to);;){if(this.pos=this.matches(b,l)){this.atOccurrence=true;return this.pos.match||true}if(b){if(!l.line)return d(0);l={line:l.line-1,ch:C[l.line-1].text.length}}else{if(l.line==C.length-1)return d(C.length);
l={line:l.line+1,ch:0}}}},from:function(){if(this.atOccurrence)return{line:this.pos.from.line,ch:this.pos.from.ch}},to:function(){if(this.atOccurrence)return{line:this.pos.to.line,ch:this.pos.to.ch}},replace:function(b){var d=this;this.atOccurrence&&ga(function(){d.pos.to=ia(b,d.pos.from,d.pos.to)})()}};for(var wb in I)if(I.propertyIsEnumerable(wb)&&!Aa.propertyIsEnumerable(wb))Aa[wb]=I[wb];return Aa}function K(c,j){if(j===true)return j;if(c.copyState)return c.copyState(j);var p={},e;for(e in j){var k=
j[e];if(k instanceof Array)k=k.concat([]);p[e]=k}return p}function P(c,j,p){return c.startState?c.startState(j,p):true}function B(c){this.pos=this.start=0;this.string=c}function E(c,j){this.styles=j||[c,null];this.stateAfter=null;this.text=c;this.marked=this.gutterMarker=this.className=null}function t(c,j,p,e){for(var k=0,o=0,n=0;o<j;k+=2){var G=p[k],R=o+G.length;if(n==0){R>c&&e.push(G.slice(c-o,Math.min(G.length,j-o)),p[k+1]);if(R>=c)n=1}else if(n==1)R>j?e.push(G.slice(0,j-o),p[k+1]):e.push(G,p[k+
1]);o=R}}function a(){this.time=0;this.done=[];this.undone=[]}function i(){r(this)}function h(c){if(!c.stop)c.stop=i;return c}function f(c){if(c.preventDefault)c.preventDefault();else c.returnValue=false}function r(c){f(c);if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true}function x(c){if(c.which)return c.which;else if(c.button&1)return 1;else if(c.button&2)return 3;else if(c.button&4)return 2}function F(c,j,p,e){function k(o){p(o||window.event)}if(typeof c.addEventListener=="function"){c.addEventListener(j,
k,false);if(e)return function(){c.removeEventListener(j,k,false)}}else{c.attachEvent("on"+j,k);if(e)return function(){c.detachEvent("on"+j,k)}}}function y(){this.id=null}function D(c,j){if(j==null){j=c.search(/[^\s\u00a0]/);if(j==-1)j=c.length}for(var p=0,e=0;p<j;++p)if(c.charAt(p)=="\t")e+=ma-e%ma;else++e;return e}function O(c,j){for(var p=c.ownerDocument.body,e=0,k=0,o=false,n=c;n;n=n.offsetParent){e+=n.offsetLeft;k+=n.offsetTop;var G;if(G=j){G=n.currentStyle?n.currentStyle:window.getComputedStyle(n,
null);G=G.position=="fixed"}if(G)o=true}p=j&&!o?null:p;for(n=c.parentNode;n!=p;n=n.parentNode)if(n.scrollLeft!=null){e-=n.scrollLeft;k-=n.scrollTop}return{left:e,top:k}}function L(c,j){return c.line==j.line&&c.ch==j.ch}function U(c,j){return c.line<j.line||c.line==j.line&&c.ch<j.ch}function ha(c){if(M){$.innerHTML="";$.appendChild(document.createTextNode(c))}else $.textContent=c;return $.innerHTML}function sa(c,j){if(c.indexOf)return c.indexOf(j);for(var p=0,e=c.length;p<e;++p)if(c[p]==j)return p;
return-1}m.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:false,tabMode:"classic",enterMode:"indent",electricChars:true,onKeyEvent:null,lineNumbers:false,gutter:false,fixedGutter:false,firstLineNumber:1,readOnly:false,smartHome:true,onChange:null,onCursorActivity:null,onGutterClick:null,onHighlightComplete:null,onFocus:null,onBlur:null,onScroll:null,matchBrackets:false,workTime:100,workDelay:200,undoDepth:40,tabindex:null,document:window.document};var la={},ua={};m.defineMode=
function(c,j){if(!m.defaults.mode&&c!="null")m.defaults.mode=c;la[c]=j};m.defineMIME=function(c,j){ua[c]=j};m.getMode=function(c,j){if(typeof j=="string"&&ua.hasOwnProperty(j))j=ua[j];if(typeof j=="string")var p=j,e={};else if(j!=null){p=j.name;e=j}var k=la[p];if(!k){window.console&&console.warn("No mode "+p+" found, falling back to plain text.");return m.getMode(c,"text/plain")}return k(c,e||{})};m.listModes=function(){var c=[],j;for(j in la)la.propertyIsEnumerable(j)&&c.push(j);return c};m.listMIMEs=
function(){var c=[],j;for(j in ua)ua.propertyIsEnumerable(j)&&c.push({mime:j,mode:ua[j]});return c};var I={};m.defineExtension=function(c,j){I[c]=j};m.fromTextArea=function(c,j){function p(){c.value=n.getValue()}j||(j={});j.value=c.value;if(!j.tabindex&&c.tabindex)j.tabindex=c.tabindex;if(c.form){var e=F(c.form,"submit",p,true);if(typeof c.form.submit=="function"){var k=c.form.submit,o=function(){p();c.form.submit=k;c.form.submit();c.form.submit=o};c.form.submit=o}}c.style.display="none";var n=m(function(G){c.parentNode.insertBefore(G,
c.nextSibling)},j);n.save=p;n.toTextArea=function(){p();c.parentNode.removeChild(n.getWrapperElement());c.style.display="";if(c.form){e();if(typeof c.form.submit=="function")c.form.submit=k}};return n};m.startState=P;m.copyState=K;B.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(c){var j=this.string.charAt(this.pos);
if(typeof c=="string"?j==c:j&&(c.test?c.test(j):c(j))){++this.pos;return j}},eatWhile:function(c){for(var j=this.pos;this.eat(c););return this.pos>j},eatSpace:function(){for(var c=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>c},skipToEnd:function(){this.pos=this.string.length},skipTo:function(c){c=this.string.indexOf(c,this.pos);if(c>-1){this.pos=c;return true}},backUp:function(c){this.pos-=c},column:function(){return D(this.string,this.start)},indentation:function(){return D(this.string)},
match:function(c,j,p){if(typeof c=="string"){if((p?this.string.toLowerCase():this.string).indexOf(p?c.toLowerCase():c,this.pos)==this.pos){if(j!==false)this.pos+=c.length;return true}}else{if((c=this.string.slice(this.pos).match(c))&&j!==false)this.pos+=c[0].length;return c}},current:function(){return this.string.slice(this.start,this.pos)}};m.StringStream=B;E.inheritMarks=function(c,j){var p=new E(c),e=j.marked;if(e)for(var k=0;k<e.length;++k)if(e[k].to==null){var o=p.marked||(p.marked=[]),n=e[k];
o.push({from:null,to:null,style:n.style,set:n.set});n.set.push(p)}return p};E.prototype={replace:function(c,j,p){var e=[],k=this.marked,o=j==null?this.text.length:j;t(0,c,this.styles,e);p&&e.push(p,null);t(o,this.text.length,this.styles,e);this.styles=e;this.text=this.text.slice(0,c)+p+this.text.slice(o);this.stateAfter=null;if(k){p=p.length-(o-c);e=this.text.length;for(o=0;o<k.length;++o){var n=k[o],G=false;if(n.from!=null&&n.from>=e)G=true;else{if(n.from!=null&&n.from>=c){n.from+=p;if(n.from<=0)n.from=
c==null?null:0}else if(j==null)n.to=null;if(n.to!=null&&n.to>c){n.to+=p;if(n.to<0)G=true}}if(G||n.from!=null&&n.to!=null&&n.from>=n.to)k.splice(o--,1)}}},split:function(c,j){var p=[j,null],e=this.marked;t(c,this.text.length,this.styles,p);p=new E(j+this.text.slice(c),p);if(e)for(var k=0;k<e.length;++k){var o=e[k];if(o.to>c||o.to==null){if(!p.marked)p.marked=[];p.marked.push({from:o.from<c||o.from==null?null:o.from-c+j.length,to:o.to==null?null:o.to-c+j.length,style:o.style,set:o.set});o.set.push(p)}}return p},
append:function(c){if(c.text.length){var j=this.text.length,p=c.marked;this.text+=c.text;t(0,c.text.length,c.styles,this.styles);if(p&&p.length){c=this.marked||(this.marked=[]);for(var e=0;e<c.length;++e)if(c[e].to==null)c[e].to=j;e=0;a:for(;e<p.length;++e){var k=p[e];if(!k.from)for(var o=0;o<c.length;++o){var n=c[o];if(n.to==j&&n.set==k.set){n.to=k.to==null?null:k.to+j;continue a}}c.push(k);k.set.push(this);k.from+=j;if(k.to!=null)k.to+=j}}}},addMark:function(c,j,p,e){e.push(this);if(this.marked==
null)this.marked=[];this.marked.push({from:c,to:j,style:p,set:e});this.marked.sort(function(k,o){return(k.from||0)-(o.from||0)})},highlight:function(c,j){var p=new B(this.text),e=this.styles,k=0,o=false,n=e[0],G;for(this.text==""&&c.blankLine&&c.blankLine(j);!p.eol();){var R=c.token(p,j),aa=this.text.slice(p.start,p.pos);p.start=p.pos;if(k&&e[k-1]==R)e[k-2]+=aa;else if(aa){if(!o&&(e[k+1]!=R||k&&e[k-2]!=G))o=true;e[k++]=aa;e[k++]=R;G=n;n=e[k]}if(p.pos>5E3){e[k++]=this.text.slice(p.pos);e[k++]=null;
break}}if(e.length!=k){e.length=k;o=true}if(k&&e[k-2]!=G)o=true;return o||(e.length<5&&this.text.length<10?null:false)},getTokenAt:function(c,j,p){for(var e=new B(this.text);e.pos<p&&!e.eol();){e.start=e.pos;var k=c.token(e,j)}return{start:e.start,end:e.pos,string:e.current(),className:k||null,state:j}},indentation:function(){return D(this.text)},getHTML:function(c,j,p,e){function k(Qa,qb){if(Qa)qb?o.push('<span class="',qb,'">',ha(Qa),"</span>"):o.push(ha(Qa))}var o=[];if(p)o.push(this.className?
'<pre class="'+this.className+'">':"<pre>");var n=this.styles,G=this.text,R=this.marked;if(c==j)c=null;var aa=G.length;if(e!=null)aa=Math.min(e,aa);if(!G&&e==null)k(" ",c!=null&&j==null?"CodeMirror-selected":null);else if(!R&&c==null)for(c=e=0;c<aa;e+=2){j=n[e];var ia=n[e+1];G=j.length;if(c+G>aa)j=j.slice(0,aa-c);c+=G;k(j,ia&&"cm-"+ia)}else{e=G=0;var da="",Fa=-1,ka=null,Ya=function(){if(R){Fa+=1;ka=Fa<R.length?R[Fa]:null}};for(Ya();G<aa;){var ta=aa,Ba="";if(c!=null)if(c>G)ta=c;else if(j==null||j>
G){Ba=" CodeMirror-selected";if(j!=null)ta=Math.min(ta,j)}for(;ka&&ka.to!=null&&ka.to<=G;)Ya();if(ka)if(ka.from>G)ta=Math.min(ta,ka.from);else{Ba+=" "+ka.style;if(ka.to!=null)ta=Math.min(ta,ka.to)}for(;;){var fb=G+da.length,cb=ia;if(Ba)cb=ia?ia+Ba:Ba;k(fb>ta?da.slice(0,ta-G):da,cb);if(fb>=ta){da=da.slice(ta-G);G=ta;break}G=fb;da=n[e++];ia="cm-"+n[e++]}}c!=null&&j==null&&k(" ","CodeMirror-selected")}p&&o.push("</pre>");return o.join("")}};a.prototype={addChange:function(c,j,p){this.undone.length=0;
var e=+new Date,k=this.done[this.done.length-1];if(e-this.time>400||!k||k.start>c+j||k.start+k.added<c-k.added+k.old.length)this.done.push({start:c,added:j,old:p});else{var o=0;if(c<k.start){for(var n=k.start-c-1;n>=0;--n)k.old.unshift(p[n]);k.added+=k.start-c;k.start=c}else if(k.start<c){o=c-k.start;j+=o}n=k.added-o;for(c=p.length;n<c;++n)k.old.push(p[n]);if(k.added<j)k.added=j}this.time=e}};y.prototype={set:function(c,j){clearTimeout(this.id);this.id=setTimeout(j,c)}};var V=function(){var c=document.createElement("pre");
c.innerHTML=" ";return!c.innerHTML}(),W=function(){if(/MSIE [1-8]\b/.test(navigator.userAgent))return false;var c=document.createElement("div");return"ondragstart"in c&&"ondrop"in c}(),H=/gecko\/\d{7}/i.test(navigator.userAgent),S=/MSIE \d/.test(navigator.userAgent),T=/Apple Computer/.test(navigator.vendor),J="\n";(function(){var c=document.createElement("textarea");c.value="foo\nbar";if(c.value.indexOf("\r")>-1)J="\r\n"})();for(var ma=8,oa=/Mac/.test(navigator.platform),ea={},Y=35;Y<=40;++Y)ea[Y]=
ea["c"+Y]=true;var $=document.createElement("pre"),M=ha("\t")!="\t";m.htmlEscape=ha;var Z,ja,fa;Z="\n\nb".split(/\n/).length!=3?function(c){for(var j=0,p,e=[];(p=c.indexOf("\n",j))>-1;){e.push(c.slice(j,c.charAt(p-1)=="\r"?p-1:p));j=p+1}e.push(c.slice(j));return e}:function(c){return c.split(/\r?\n/)};m.splitLines=Z;if(window.getSelection){ja=function(c){try{return{start:c.selectionStart,end:c.selectionEnd}}catch(j){return null}};fa=T?function(c,j,p){if(j==p)c.setSelectionRange(j,p);else{c.setSelectionRange(j,
p-1);window.getSelection().modify("extend","forward","character")}}:function(c,j,p){try{c.setSelectionRange(j,p)}catch(e){}}}else{ja=function(c){try{var j=c.ownerDocument.selection.createRange()}catch(p){return null}if(!j||j.parentElement()!=c)return null;var e=c.value,k=e.length,o=c.createTextRange();o.moveToBookmark(j.getBookmark());var n=c.createTextRange();n.collapse(false);if(o.compareEndPoints("StartToEnd",n)>-1)return{start:k,end:k};c=-o.moveStart("character",-k);for(j=e.indexOf("\r");j>-1&&
j<c;j=e.indexOf("\r",j+1),c++);if(o.compareEndPoints("EndToEnd",n)>-1)return{start:c,end:k};k=-o.moveEnd("character",-k);for(j=e.indexOf("\r");j>-1&&j<k;j=e.indexOf("\r",j+1),k++);return{start:c,end:k}};fa=function(c,j,p){var e=c.createTextRange();e.collapse(true);var k=e.duplicate(),o=0;c=c.value;for(var n=c.indexOf("\n");n>-1&&n<j;n=c.indexOf("\n",n+1))++o;for(e.move("character",j-o);n>-1&&n<p;n=c.indexOf("\n",n+1))++o;k.move("character",p-o);e.setEndPoint("EndToEnd",k);e.select()}}m.defineMode("null",
function(){return{token:function(c){c.skipToEnd()}}});m.defineMIME("text/plain","null");return m}();CodeMirror.defineMode("css",function(m){function K(h,f){i=f;return h}function P(h,f){var r=h.next();if(r=="@"){h.eatWhile(/[\w\\\-]/);return K("meta",h.current())}else if(r=="/"&&h.eat("*")){f.tokenize=B;return B(h,f)}else if(r=="<"&&h.eat("!")){f.tokenize=E;return E(h,f)}else if(r=="=")K(null,"compare");else if((r=="~"||r=="|")&&h.eat("="))return K(null,"compare");else if(r=='"'||r=="'"){f.tokenize=t(r);return f.tokenize(h,f)}else if(r=="#"){h.eatWhile(/[\w\\\-]/);return K("atom","hash")}else if(r==
"!"){h.match(/^\s*\w*/);return K("keyword","important")}else if(/\d/.test(r)){h.eatWhile(/[\w.%]/);return K("number","unit")}else if(/[,.+>*\/]/.test(r))return K(null,"select-op");else if(/[;{}:\[\]]/.test(r))return K(null,r);else{h.eatWhile(/[\w\\\-]/);return K("variable","variable")}}function B(h,f){for(var r=false,x;(x=h.next())!=null;){if(r&&x=="/"){f.tokenize=P;break}r=x=="*"}return K("comment","comment")}function E(h,f){for(var r=0,x;(x=h.next())!=null;){if(r>=2&&x==">"){f.tokenize=P;break}r=
x=="-"?r+1:0}return K("comment","comment")}function t(h){return function(f,r){for(var x=false,F;(F=f.next())!=null;){if(F==h&&!x)break;x=!x&&F=="\\"}if(!x)r.tokenize=P;return K("string","string")}}var a=m.indentUnit,i;return{startState:function(h){return{tokenize:P,baseIndent:h||0,stack:[]}},token:function(h,f){if(h.eatSpace())return null;var r=f.tokenize(h,f),x=f.stack[f.stack.length-1];if(i=="hash"&&x=="rule")r="atom";else if(r=="variable")if(x=="rule")r="number";else if(!x||x=="@media{")r="tag";
x=="rule"&&/^[\{\};]$/.test(i)&&f.stack.pop();if(i=="{")if(x=="@media")f.stack[f.stack.length-1]="@media{";else f.stack.push("{");else if(i=="}")f.stack.pop();else if(i=="@media")f.stack.push("@media");else x=="{"&&i!="comment"&&f.stack.push("rule");return r},indent:function(h,f){var r=h.stack.length;if(/^\}/.test(f))r-=h.stack[h.stack.length-1]=="rule"?2:1;return h.baseIndent+r*a},electricChars:"}"}});CodeMirror.defineMIME("text/css","css");CodeMirror.defineMode("dbs",function(m,K){function P(x,F){var y=x.next();if(y=='"'||y=="'"){y=B(y);F.tokenize=y;return y(x,F)}else if(!/[\[\]{}\(\),;\.]/.test(y))if(/\d/.test(y)){x.eatWhile(/[\w\.]/);return"number"}else if(y=="/")if(x.eat("*")){y=E;F.tokenize=y;return y(x,F)}else{x.eatWhile(r);return"operator"}else if(y=="-")if(x.eat("-")){x.skipToEnd();return"comment"}else{x.eatWhile(r);return"operator"}else if(y=="@"||y=="$"){x.eatWhile(/[\w\d\$_]/);return"variable"}else if(r.test(y)){x.eatWhile(r);
return"operator"}else{x.eatWhile(/[\w\$_]/);if(t&&t.propertyIsEnumerable(x.current().toLowerCase()))return"keyword";if(a&&a.propertyIsEnumerable(x.current().toLowerCase()))return"builtin";if(i&&i.propertyIsEnumerable(x.current().toLowerCase()))return"variable-2";if(h&&h.propertyIsEnumerable(x.current().toLowerCase()))return"variable-3";return"dbs-word"}}function B(x){return function(F,y){for(var D=false,O,L=false;(O=F.next())!=null;){if(O==x&&!D){L=true;break}D=!D&&O=="\\"}if(L||!(D||f))y.tokenize=
P;return"dbs-string"}}function E(x,F){for(var y=false,D;D=x.next();){if(D=="/"&&y){F.tokenize=P;break}y=D=="*"}return"dbs-comment"}var t=K.keywords,a=K.functions,i=K.types,h=K.sqlplus,f=K.multiLineStrings,r=/[+\-*&%=<>!?:\/|]/;return{startState:function(){return{tokenize:P,startOfLine:true}},token:function(x,F){if(x.eatSpace())return null;return F.tokenize(x,F)}}});
(function(){function m(K){var P={};K=K.split(" ");for(var B=0;B<K.length;++B)P[K[B]]=true;return P}CodeMirror.defineMIME("text/x-dbs",{name:"dbs",keywords:m("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),
functions:m("abs acos add_months ascii asin atan atan2 average bfilename ceil chartorowid chr concat convert cos cosh count decode deref dual dump dup_val_on_index empty error exp false floor found glb greatest hextoraw initcap instr instrb isopen last_day least lenght lenghtb ln lower lpad ltrim lub make_ref max min mod months_between new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null nvl others power rawtohex reftohex round rowcount rowidtochar rpad rtrim sign sin sinh soundex sqlcode sqlerrm sqrt stddev substr substrb sum sysdate tan tanh to_char to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid upper user userenv variance vsize"),
types:m("bfile blob character clob dec float int integer mlslabel natural naturaln nchar nclob number numeric nvarchar2 real rowtype signtype smallint string varchar varchar2"),sqlplus:m("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap")})})();CodeMirror.defineMode("htmlmixed",function(m){function K(h,f){var r=t.token(h,f.htmlState);if(r=="tag"&&h.current()==">"&&f.htmlState.context)if(/^script$/i.test(f.htmlState.context.tagName)){f.token=B;f.localState=a.startState(t.indent(f.htmlState,""));f.mode="javascript"}else if(/^style$/i.test(f.htmlState.context.tagName)){f.token=E;f.localState=i.startState(t.indent(f.htmlState,""));f.mode="css"}return r}function P(h,f,r){var x=h.current();f=x.search(f);f>-1&&h.backUp(x.length-f);return r}function B(h,
f){if(h.match(/^<\/\s*script\s*>/i,false)){f.token=K;f.curState=null;f.mode="html";return K(h,f)}return P(h,/<\/\s*script\s*>/,a.token(h,f.localState))}function E(h,f){if(h.match(/^<\/\s*style\s*>/i,false)){f.token=K;f.localState=null;f.mode="html";return K(h,f)}return P(h,/<\/\s*style\s*>/,i.token(h,f.localState))}var t=CodeMirror.getMode(m,{name:"xml",htmlMode:true}),a=CodeMirror.getMode(m,"javascript"),i=CodeMirror.getMode(m,"css");return{startState:function(){var h=t.startState();return{token:K,
localState:null,mode:"html",htmlState:h}},copyState:function(h){if(h.localState)var f=CodeMirror.copyState(h.token==E?i:a,h.localState);return{token:h.token,localState:f,mode:h.mode,htmlState:CodeMirror.copyState(t,h.htmlState)}},token:function(h,f){return f.token(h,f)},indent:function(h,f){return h.token==K||/^\s*<\//.test(f)?t.indent(h.htmlState,f):h.token==B?a.indent(h.localState,f):i.indent(h.localState,f)},compareStates:function(h,f){return t.compareStates(h.htmlState,f.htmlState)},electricChars:"/{}:"}});
CodeMirror.defineMIME("text/html","htmlmixed");CodeMirror.defineMode("javascript",function(m,K){function P(e,k){for(var o=false,n;(n=e.next())!=null;){if(n==k&&!o)return false;o=!o&&n=="\\"}return o}function B(e,k,o){ja=e;fa=o;return k}function E(e,k){var o=e.next();if(o=='"'||o=="'"){o=t(o);k.tokenize=o;return o(e,k)}else if(/[\[\]{}\(\),;\:\.]/.test(o))return B(o);else if(o=="0"&&e.eat(/x/i)){e.eatWhile(/[\da-f]/i);return B("number","number")}else if(/\d/.test(o)){e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/);return B("number","number")}else if(o==
"/")if(e.eat("*")){o=a;k.tokenize=o;return o(e,k)}else if(e.eat("/")){e.skipToEnd();return B("comment","comment")}else if(k.reAllowed){P(e,"/");e.eatWhile(/[gimy]/);return B("regexp","string")}else{e.eatWhile(Z);return B("operator",null,e.current())}else if(o=="#"){e.skipToEnd();return B("error","error")}else if(Z.test(o)){e.eatWhile(Z);return B("operator",null,e.current())}else{e.eatWhile(/[\w\$_]/);o=e.current();var n=M.propertyIsEnumerable(o)&&M[o];return n?B(n.type,n.style,o):B("variable","variable",
o)}}function t(e){return function(k,o){if(!P(k,e))o.tokenize=E;return B("string","string")}}function a(e,k){for(var o=false,n;n=e.next();){if(n=="/"&&o){k.tokenize=E;break}o=n=="*"}return B("comment","comment")}function i(e,k,o,n,G,R){this.indented=e;this.column=k;this.type=o;this.prev=G;this.info=R;if(n!=null)this.align=n}function h(){for(var e=arguments.length-1;e>=0;e--)j.cc.push(arguments[e])}function f(){h.apply(null,arguments);return true}function r(e){var k=j.state;if(k.context){j.marked="def";
for(var o=k.localVars;o;o=o.next)if(o.name==e)return;k.localVars={name:e,next:k.localVars}}}function x(){if(!j.state.context)j.state.localVars=p;j.state.context={prev:j.state.context,vars:j.state.localVars}}function F(){j.state.localVars=j.state.context.vars;j.state.context=j.state.context.prev}function y(e,k){var o=function(){var n=j.state;n.lexical=new i(n.indented,j.stream.column(),e,null,n.lexical,k)};o.lex=true;return o}function D(){var e=j.state;if(e.lexical.prev){if(e.lexical.type==")")e.indented=
e.lexical.indented;e.lexical=e.lexical.prev}}function O(e){return function(k){return k==e?f():e==";"?h():f(arguments.callee)}}function L(e){if(e=="var")return f(y("vardef"),W,O(";"),D);if(e=="keyword a")return f(y("form"),U,L,D);if(e=="keyword b")return f(y("form"),L,D);if(e=="{")return f(y("}"),V,D);if(e==";")return f();if(e=="function")return f(oa);if(e=="for")return f(y("form"),O("("),y(")"),S,O(")"),D,L,D);if(e=="variable")return f(y("stat"),sa);if(e=="switch")return f(y("form"),U,y("}","switch"),
O("{"),V,D,D);if(e=="case")return f(U,O(":"));if(e=="default")return f(O(":"));if(e=="catch")return f(y("form"),x,O("("),ea,O(")"),L,D,F);return h(y("stat"),U,O(";"),D)}function U(e){if(c.hasOwnProperty(e))return f(ha);if(e=="function")return f(oa);if(e=="keyword c")return f(U);if(e=="(")return f(y(")"),U,O(")"),D,ha);if(e=="operator")return f(U);if(e=="[")return f(y("]"),I(U,"]"),D,ha);if(e=="{")return f(y("}"),I(ua,"}"),D,ha);return f()}function ha(e,k){if(e=="operator"&&/\+\+|--/.test(k))return f(ha);
if(e=="operator")return f(U);if(e!=";"){if(e=="(")return f(y(")"),I(U,")"),D,ha);if(e==".")return f(la,ha);if(e=="[")return f(y("]"),U,O("]"),D,ha)}}function sa(e){if(e==":")return f(D,L);return h(ha,O(";"),D)}function la(e){if(e=="variable"){j.marked="property";return f()}}function ua(e){if(e=="variable")j.marked="property";if(c.hasOwnProperty(e))return f(O(":"),U)}function I(e,k){function o(n){if(n==",")return f(e,o);if(n==k)return f();return f(O(k))}return function(n){return n==k?f():h(e,o)}}function V(e){if(e==
"}")return f();return h(L,V)}function W(e,k){if(e=="variable"){r(k);return f(H)}return f()}function H(e,k){if(k=="=")return f(U,H);if(e==",")return f(W)}function S(e){if(e=="var")return f(W,J);if(e==";")return h(J);if(e=="variable")return f(T);return h(J)}function T(e,k){if(k=="in")return f(U);return f(ha,J)}function J(e,k){if(e==";")return f(ma);if(k=="in")return f(U);return f(U,O(";"),ma)}function ma(e){e!=")"&&f(U)}function oa(e,k){if(e=="variable"){r(k);return f(oa)}if(e=="(")return f(y(")"),
x,I(ea,")"),D,L,F)}function ea(e,k){if(e=="variable"){r(k);return f()}}var Y=m.indentUnit,$=K.json,M=function(){function e(aa){return{type:aa,style:"keyword"}}var k=e("keyword a"),o=e("keyword b"),n=e("keyword c"),G=e("operator"),R={type:"atom",style:"atom"};return{"if":k,"while":k,"with":k,"else":o,"do":o,"try":o,"finally":o,"return":n,"break":n,"continue":n,"new":n,"delete":n,"throw":n,"var":e("var"),"function":e("function"),"catch":e("catch"),"for":e("for"),"switch":e("switch"),"case":e("case"),
"default":e("default"),"in":G,"typeof":G,"instanceof":G,"true":R,"false":R,"null":R,undefined:R,NaN:R,Infinity:R}}(),Z=/[+\-*&%=<>!?|]/,ja,fa,c={atom:true,number:true,variable:true,string:true,regexp:true},j={state:null,column:null,marked:null,cc:null},p={name:"this",next:{name:"arguments"}};D.lex=true;return{startState:function(e){return{tokenize:E,reAllowed:true,cc:[],lexical:new i((e||0)-Y,0,"block",false),localVars:null,context:null,indented:0}},token:function(e,k){if(e.sol()){if(!k.lexical.hasOwnProperty("align"))k.lexical.align=
false;k.indented=e.indentation()}if(e.eatSpace())return null;var o=k.tokenize(e,k);if(ja=="comment")return o;k.reAllowed=ja=="operator"||ja=="keyword c"||ja.match(/^[\[{}\(,;:]$/);var n;a:{var G=ja,R=fa,aa=k.cc;j.state=k;j.stream=e;j.marked=null;j.cc=aa;if(!k.lexical.hasOwnProperty("align"))k.lexical.align=true;for(;;)if((aa.length?aa.pop():$?U:L)(G,R)){for(;aa.length&&aa[aa.length-1].lex;)aa.pop()();if(j.marked){n=j.marked;break a}if(n=G=="variable")b:{for(n=k.localVars;n;n=n.next)if(n.name==R){n=
true;break b}n=void 0}if(n){n="variable-2";break a}n=o;break a}}return n},indent:function(e,k){if(e.tokenize!=E)return 0;var o=k&&k.charAt(0),n=e.lexical,G=n.type,R=o==G;return G=="vardef"?n.indented+4:G=="form"&&o=="{"?n.indented:G=="stat"||G=="form"?n.indented+Y:n.info=="switch"&&!R?n.indented+(/^(?:case|default)\b/.test(k)?Y:2*Y):n.align?n.column+(R?0:1):n.indented+(R?0:Y)},electricChars:":{}"}});CodeMirror.defineMIME("text/javascript","javascript");
CodeMirror.defineMIME("application/json",{name:"javascript",json:true});CodeMirror.defineMode("lua",function(m,K){function P(D){return RegExp("^(?:"+D.join("|")+")$","i")}function B(D){for(var O=0;D.eat("=");)++O;D.eat("[");return O}function E(D,O){var L=D.next();if(L=="-"&&D.eat("-")){if(D.eat("[")&&D.eat("["))return(O.cur=t(B(D),"comment"))(D,O);D.skipToEnd();return"comment"}if(L=='"'||L=="'")return(O.cur=a(L))(D,O);if(L=="["&&/[\[=]/.test(D.peek()))return(O.cur=t(B(D),"string"))(D,O);if(/\d/.test(L)){D.eatWhile(/[\w.%]/);return"number"}if(/[\w_]/.test(L)){D.eatWhile(/[\w\\\-_.]/);
return"variable"}return null}function t(D,O){return function(L,U){for(var ha=null,sa;(sa=L.next())!=null;)if(ha==null){if(sa=="]")ha=0}else if(sa=="=")++ha;else if(sa=="]"&&ha==D){U.cur=E;break}else ha=null;return O}}function a(D){return function(O,L){for(var U=false,ha;(ha=O.next())!=null;){if(ha==D&&!U)break;U=!U&&ha=="\\"}if(!U)L.cur=E;return"string"}}var i=m.indentUnit,h=P(K.specials||[]),f=P(["_G","_VERSION","assert","collectgarbage","dofile","error","getfenv","getmetatable","ipairs","load",
"loadfile","loadstring","module","next","pairs","pcall","print","rawequal","rawget","rawset","require","select","setfenv","setmetatable","tonumber","tostring","type","unpack","xpcall","coroutine.create","coroutine.resume","coroutine.running","coroutine.status","coroutine.wrap","coroutine.yield","debug.debug","debug.getfenv","debug.gethook","debug.getinfo","debug.getlocal","debug.getmetatable","debug.getregistry","debug.getupvalue","debug.setfenv","debug.sethook","debug.setlocal","debug.setmetatable",
"debug.setupvalue","debug.traceback","close","flush","lines","read","seek","setvbuf","write","io.close","io.flush","io.input","io.lines","io.open","io.output","io.popen","io.read","io.stderr","io.stdin","io.stdout","io.tmpfile","io.type","io.write","math.abs","math.acos","math.asin","math.atan","math.atan2","math.ceil","math.cos","math.cosh","math.deg","math.exp","math.floor","math.fmod","math.frexp","math.huge","math.ldexp","math.log","math.log10","math.max","math.min","math.modf","math.pi","math.pow",
"math.rad","math.random","math.randomseed","math.sin","math.sinh","math.sqrt","math.tan","math.tanh","os.clock","os.date","os.difftime","os.execute","os.exit","os.getenv","os.remove","os.rename","os.setlocale","os.time","os.tmpname","package.cpath","package.loaded","package.loaders","package.loadlib","package.path","package.preload","package.seeall","string.byte","string.char","string.dump","string.find","string.format","string.gmatch","string.gsub","string.len","string.lower","string.match","string.rep",
"string.reverse","string.sub","string.upper","table.concat","table.insert","table.maxn","table.remove","table.sort"]),r=P(["and","break","elseif","false","nil","not","or","return","true","function","end","if","then","else","do","while","repeat","until","for","in","local"]),x=P(["function","if","repeat","do","\\(","{"]),F=P(["end","until","\\)","}"]),y=/^(?:end|until|\)|}|else|elseif)/i;return{startState:function(D){return{basecol:D||0,indentDepth:0,cur:E}},token:function(D,O){if(D.eatSpace())return null;
var L=O.cur(D,O),U=D.current();if(L=="variable")if(r.test(U))L="keyword";else if(f.test(U))L="builtin";else if(h.test(U))L="variable-2";if(L!="comment"&&L!="string")if(x.test(U))++O.indentDepth;else F.test(U)&&--O.indentDepth;return L},indent:function(D,O){var L=y.test(O);return D.basecol+i*(D.indentDepth-(L?1:0))}}});CodeMirror.defineMIME("text/x-lua","lua");CodeMirror.defineMode("plsql",function(m,K){function P(x,F){var y=x.next();if(y=='"'||y=="'"){y=B(y);F.tokenize=y;return y(x,F)}else if(!/[\[\]{}\(\),;\.]/.test(y))if(/\d/.test(y)){x.eatWhile(/[\w\.]/);return"number"}else if(y=="/")if(x.eat("*")){y=E;F.tokenize=y;return y(x,F)}else{x.eatWhile(r);return"operator"}else if(y=="-")if(x.eat("-")){x.skipToEnd();return"comment"}else{x.eatWhile(r);return"operator"}else if(y=="@"||y=="$"){x.eatWhile(/[\w\d\$_]/);return"variable"}else if(r.test(y)){x.eatWhile(r);
return"operator"}else{x.eatWhile(/[\w\$_]/);if(t&&t.propertyIsEnumerable(x.current().toLowerCase()))return"keyword";if(a&&a.propertyIsEnumerable(x.current().toLowerCase()))return"builtin";if(i&&i.propertyIsEnumerable(x.current().toLowerCase()))return"variable-2";if(h&&h.propertyIsEnumerable(x.current().toLowerCase()))return"variable-3";return"plsql-word"}}function B(x){return function(F,y){for(var D=false,O,L=false;(O=F.next())!=null;){if(O==x&&!D){L=true;break}D=!D&&O=="\\"}if(L||!(D||f))y.tokenize=
P;return"plsql-string"}}function E(x,F){for(var y=false,D;D=x.next();){if(D=="/"&&y){F.tokenize=P;break}y=D=="*"}return"plsql-comment"}var t=K.keywords,a=K.functions,i=K.types,h=K.sqlplus,f=K.multiLineStrings,r=/[+\-*&%=<>!?:\/|]/;return{startState:function(){return{tokenize:P,startOfLine:true}},token:function(x,F){if(x.eatSpace())return null;return F.tokenize(x,F)}}});
(function(){function m(K){var P={};K=K.split(" ");for(var B=0;B<K.length;++B)P[K[B]]=true;return P}CodeMirror.defineMIME("text/x-plsql",{name:"plsql",keywords:m("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),
functions:m("abs acos add_months ascii asin atan atan2 average bfilename ceil chartorowid chr concat convert cos cosh count decode deref dual dump dup_val_on_index empty error exp false floor found glb greatest hextoraw initcap instr instrb isopen last_day least lenght lenghtb ln lower lpad ltrim lub make_ref max min mod months_between new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null nvl others power rawtohex reftohex round rowcount rowidtochar rpad rtrim sign sin sinh soundex sqlcode sqlerrm sqrt stddev substr substrb sum sysdate tan tanh to_char to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid upper user userenv variance vsize"),
types:m("bfile blob character clob dec float int integer mlslabel natural naturaln nchar nclob number numeric nvarchar2 real rowtype signtype smallint string varchar varchar2"),sqlplus:m("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap")})})();CodeMirror.defineMode("xml",function(m,K){function P(I,V){function W(S){V.tokenize=S;return S(I,V)}var H=I.next();if(H=="<")if(I.eat("!"))if(I.eat("["))return I.match("CDATA[")?W(t("atom","]]\>")):null;else if(I.match("--"))return W(t("comment","--\>"));else if(I.match("DOCTYPE",true,true)){I.eatWhile(/[\w\._\-]/);return W(t("meta",">"))}else return null;else if(I.eat("?")){I.eatWhile(/[\w\._\-]/);V.tokenize=t("meta","?>");return"meta"}else{sa=I.eat("/")?"closeTag":"openTag";I.eatSpace();for(ha="";H=
I.eat(/[^\s\u00a0=<>\"\'\/?]/);)ha+=H;V.tokenize=B;return"tag"}else if(H=="&"){I.eatWhile(/[^;]/);I.eat(";");return"atom"}else{I.eatWhile(/[^&<]/);return null}}function B(I,V){var W=I.next();if(W==">"||W=="/"&&I.eat(">")){V.tokenize=P;sa=W==">"?"endTag":"selfcloseTag";return"tag"}else if(W=="="){sa="equals";return null}else if(/[\'\"]/.test(W)){V.tokenize=E(W);return V.tokenize(I,V)}else{I.eatWhile(/[^\s\u00a0=<>\"\'\/?]/);return"word"}}function E(I){return function(V,W){for(;!V.eol();)if(V.next()==
I){W.tokenize=B;break}return"string"}}function t(I,V){return function(W,H){for(;!W.eol();){if(W.match(V)){H.tokenize=P;break}W.next()}return I}}function a(){for(var I=arguments.length-1;I>=0;I--)la.cc.push(arguments[I])}function i(){a.apply(null,arguments);return true}function h(I,V){var W=L.doNotIndent.hasOwnProperty(I)||la.context&&la.context.noIndent;la.context={prev:la.context,tagName:I,indent:la.indented,startOfLine:V,noIndent:W}}function f(I){if(I=="openTag"){la.tagName=ha;return i(F,r(la.startOfLine))}else if(I==
"closeTag"){I=false;if(I=la.context?la.context.tagName!=ha:true)ua="error";return i(x(I))}else{if(I=="string"){if(!la.context||la.context.name!="!cdata")h("!cdata");if(la.tokenize==P)if(la.context)la.context=la.context.prev}return i()}}function r(I){return function(V){if(V=="selfcloseTag"||V=="endTag"&&L.autoSelfClosers.hasOwnProperty(la.tagName.toLowerCase()))return i();V=="endTag"&&h(la.tagName,I);return i()}}function x(I){return function(V){if(I)ua="error";if(V=="endTag"){if(la.context)la.context=
la.context.prev;return i()}ua="error";return i(arguments.callee)}}function F(I){if(I=="word"){ua="attribute";return i(F)}if(I=="equals")return i(y,F);if(I=="string"){ua="error";return i(F)}return a()}function y(I){if(I=="word"&&L.allowUnquoted){ua="string";return i()}if(I=="string")return i(D);return a()}function D(I){return I=="string"?i(D):a()}var O=m.indentUnit,L=K.htmlMode?{autoSelfClosers:{br:true,img:true,hr:true,link:true,input:true,meta:true,col:true,frame:true,base:true,area:true},doNotIndent:{pre:true,
"!cdata":true},allowUnquoted:true}:{autoSelfClosers:{},doNotIndent:{"!cdata":true},allowUnquoted:false},U=K.alignCDATA,ha,sa,la,ua;return{startState:function(){return{tokenize:P,cc:[],indented:0,startOfLine:true,tagName:null,context:null}},token:function(I,V){if(I.sol()){V.startOfLine=true;V.indented=I.indentation()}if(I.eatSpace())return null;ua=sa=ha=null;var W=V.tokenize(I,V);if((W||sa)&&W!="comment")for(la=V;;)if((V.cc.pop()||f)(sa||W))break;V.startOfLine=false;return ua||W},indent:function(I,
V){var W=I.context;if(W&&W.noIndent)return 0;if(U&&/<!\[CDATA\[/.test(V))return 0;if(W&&/^<\//.test(V))W=W.prev;for(;W&&!W.startOfLine;)W=W.prev;return W?W.indent+O:0},compareStates:function(I,V){if(I.indented!=V.indented)return false;for(var W=I.context,H=V.context;;W=W.prev,H=H.prev){if(!W||!H)return W==H;if(W.tagName!=H.tagName)return false}},electricChars:"/"}});CodeMirror.defineMIME("application/xml","xml");CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:true});(function(){var m=null;window.PR_SHOULD_USE_CONTINUATION=true;(function(){function K(H){function S(c){var j=c.charCodeAt(0);if(j!==92)return j;var p=c.charAt(1);return(j=ja[p])?j:"0"<=p&&p<="7"?parseInt(c.substring(1),8):p==="u"||p==="x"?parseInt(c.substring(2),16):c.charCodeAt(1)}function T(c){if(c<32)return(c<16?"\\x0":"\\x")+c.toString(16);c=String.fromCharCode(c);return c==="\\"||c==="-"||c==="]"||c==="^"?"\\"+c:c}function J(c){var j=c.substring(1,c.length-1).match(/\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\S\s]|[^\\]/g);
c=[];var p=j[0]==="^",e=["["];p&&e.push("^");p=p?1:0;for(var k=j.length;p<k;++p){var o=j[p];if(/\\[bdsw]/i.test(o))e.push(o);else{o=S(o);var n;p+2<k&&"-"===j[p+1]?(n=S(j[p+2]),p+=2):n=o;c.push([o,n]);n<65||o>122||(n<65||o>90||c.push([Math.max(65,o)|32,Math.min(n,90)|32]),n<97||o>122||c.push([Math.max(97,o)&-33,Math.min(n,122)&-33]))}}c.sort(function(G,R){return G[0]-R[0]||R[1]-G[1]});j=[];k=[];for(p=0;p<c.length;++p){o=c[p];o[0]<=k[1]+1?k[1]=Math.max(k[1],o[1]):j.push(k=o)}for(p=0;p<j.length;++p){o=
j[p];e.push(T(o[0]));o[1]>o[0]&&(o[1]+1>o[0]&&e.push("-"),e.push(T(o[1])))}e.push("]");return e.join("")}function ma(c){for(var j=c.source.match(/\[(?:[^\\\]]|\\[\S\s])*]|\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\\d+|\\[^\dux]|\(\?[!:=]|[()^]|[^()[\\^]+/g),p=j.length,e=[],k=0,o=0;k<p;++k){var n=j[k];n==="("?++o:"\\"===n.charAt(0)&&(n=+n.substring(1))&&(n<=o?e[n]=-1:j[k]=T(n))}for(k=1;k<e.length;++k)-1===e[k]&&(e[k]=++oa);for(o=k=0;k<p;++k){n=j[k];n==="("?(++o,e[o]||(j[k]="(?:")):"\\"===n.charAt(0)&&(n=
+n.substring(1))&&n<=o&&(j[k]="\\"+e[n])}for(k=0;k<p;++k)"^"===j[k]&&"^"!==j[k+1]&&(j[k]="");if(c.ignoreCase&&ea)for(k=0;k<p;++k){n=j[k];c=n.charAt(0);n.length>=2&&c==="["?j[k]=J(n):c!=="\\"&&(j[k]=n.replace(/[A-Za-z]/g,function(G){G=G.charCodeAt(0);return"["+String.fromCharCode(G&-33,G|32)+"]"}))}return j.join("")}for(var oa=0,ea=false,Y=false,$=0,M=H.length;$<M;++$){var Z=H[$];if(Z.ignoreCase)Y=true;else if(/[a-z]/i.test(Z.source.replace(/\\u[\da-f]{4}|\\x[\da-f]{2}|\\[^UXux]/gi,""))){ea=true;Y=
false;break}}var ja={b:8,t:9,n:10,v:11,f:12,r:13},fa=[];$=0;for(M=H.length;$<M;++$){Z=H[$];if(Z.global||Z.multiline)throw Error(""+Z);fa.push("(?:"+ma(Z)+")")}return RegExp(fa.join("|"),Y?"gi":"g")}function P(H,S){function T($){var M=$.nodeType;if(M==1){if(!J.test($.className)){for(M=$.firstChild;M;M=M.nextSibling)T(M);M=$.nodeName.toLowerCase();if("br"===M||"li"===M){ma[Y]="\n";ea[Y<<1]=oa++;ea[Y++<<1|1]=$}}}else if(M==3||M==4){M=$.nodeValue;M.length&&(M=S?M.replace(/\r\n?/g,"\n"):M.replace(/[\t\n\r ]+/g,
" "),ma[Y]=M,ea[Y<<1]=oa,oa+=M.length,ea[Y++<<1|1]=$)}}var J=/(?:^|\s)nocode(?:\s|$)/,ma=[],oa=0,ea=[],Y=0;T(H);return{a:ma.join("").replace(/\n$/,""),d:ea}}function B(H,S,T,J){S&&(H={a:S,e:H},T(H),J.push.apply(J,H.g))}function E(H){for(var S=void 0,T=H.firstChild;T;T=T.nextSibling){var J=T.nodeType;S=J===1?S?H:T:J===3?ua.test(T.nodeValue)?H:S:S}return S===H?void 0:S}function t(H,S){function T(ea){for(var Y=ea.e,$=[Y,"pln"],M=0,Z=ea.a.match(ma)||[],ja={},fa=0,c=Z.length;fa<c;++fa){var j=Z[fa],p=ja[j],
e=void 0,k;if(typeof p==="string")k=false;else{var o=J[j.charAt(0)];if(o){e=j.match(o[1]);p=o[0]}else{for(k=0;k<oa;++k)if(o=S[k],e=j.match(o[1])){p=o[0];break}e||(p="pln")}if((k=p.length>=5&&"lang-"===p.substring(0,5))&&!(e&&typeof e[1]==="string")){k=false;p="src"}k||(ja[j]=p)}o=M;M+=j.length;if(k){k=e[1];var n=j.indexOf(k),G=n+k.length;e[2]&&(G=j.length-e[2].length,n=G-k.length);p=p.substring(5);B(Y+o,j.substring(0,n),T,$);B(Y+o+n,k,f(p,k),$);B(Y+o+G,j.substring(G),T,$)}else $.push(Y+o,p)}ea.g=
$}var J={},ma;(function(){for(var ea=H.concat(S),Y=[],$={},M=0,Z=ea.length;M<Z;++M){var ja=ea[M],fa=ja[3];if(fa)for(var c=fa.length;--c>=0;)J[fa.charAt(c)]=ja;ja=ja[1];fa=""+ja;$.hasOwnProperty(fa)||(Y.push(ja),$[fa]=m)}Y.push(/[\S\s]/);ma=K(Y)})();var oa=S.length;return T}function a(H){var S=[],T=[];H.tripleQuotedStrings?S.push(["str",/^(?:'''(?:[^'\\]|\\[\S\s]|''?(?=[^']))*(?:'''|$)|"""(?:[^"\\]|\\[\S\s]|""?(?=[^"]))*(?:"""|$)|'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$))/,m,"'\""]):
H.multiLineStrings?S.push(["str",/^(?:'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$)|`(?:[^\\`]|\\[\S\s])*(?:`|$))/,m,"'\"`"]):S.push(["str",/^(?:'(?:[^\n\r'\\]|\\.)*(?:'|$)|"(?:[^\n\r"\\]|\\.)*(?:"|$))/,m,"\"'"]);H.verbatimStrings&&T.push(["str",/^@"(?:[^"]|"")*(?:"|$)/,m]);var J=H.hashComments;J&&(H.cStyleComments?(J>1?S.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,m,"#"]):S.push(["com",/^#(?:(?:define|e(?:l|nd)if|else|error|ifn?def|include|line|pragma|undef|warning)\b|[^\n\r]*)/,
m,"#"]),T.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h(?:h|pp|\+\+)?|[a-z]\w*)>/,m])):S.push(["com",/^#[^\n\r]*/,m,"#"]));H.cStyleComments&&(T.push(["com",/^\/\/[^\n\r]*/,m]),T.push(["com",/^\/\*[\S\s]*?(?:\*\/|$)/,m]));if(J=H.regexLiterals){var ma=(J=J>1?"":"\n\r")?".":"[\\S\\s]";T.push(["lang-regex",RegExp("^(?:^^\\.?|[+-]|[!=]=?=?|\\#|%=?|&&?=?|\\(|\\*=?|[+\\-]=|->|\\/=?|::?|<<?=?|>>?>?=?|,|;|\\?|@|\\[|~|{|\\^\\^?=?|\\|\\|?=?|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\s*("+
("/(?=[^/*"+J+"])(?:[^/\\x5B\\x5C"+J+"]|\\x5C"+ma+"|\\x5B(?:[^\\x5C\\x5D"+J+"]|\\x5C"+ma+")*(?:\\x5D|$))+/")+")")])}(J=H.types)&&T.push(["typ",J]);J=(""+H.keywords).replace(/^ | $/g,"");J.length&&T.push(["kwd",RegExp("^(?:"+J.replace(/[\s,]+/g,"|")+")\\b"),m]);S.push(["pln",/^\s+/,m," \r\n\t\u00a0"]);J="^.[^\\s\\w.$@'\"`/\\\\]*";H.regexLiterals&&(J+="(?!s*/)");T.push(["lit",/^@[$_a-z][\w$@]*/i,m],["typ",/^(?:[@_]?[A-Z]+[a-z][\w$@]*|\w+_t\b)/,m],["pln",/^[$_a-z][\w$@]*/i,m],["lit",/^(?:0x[\da-f]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+-]?\d+)?)[a-z]*/i,
m,"0123456789"],["pln",/^\\[\S\s]?/,m],["pun",RegExp(J),m]);return t(S,T)}function i(H,S,T){function J(c){var j=c.nodeType;if(j==1&&!oa.test(c.className))if("br"===c.nodeName){ma(c);c.parentNode&&c.parentNode.removeChild(c)}else for(c=c.firstChild;c;c=c.nextSibling)J(c);else if((j==3||j==4)&&T){var p=c.nodeValue,e=p.match(ea);if(e){j=p.substring(0,e.index);c.nodeValue=j;(p=p.substring(e.index+e[0].length))&&c.parentNode.insertBefore(Y.createTextNode(p),c.nextSibling);ma(c);j||c.parentNode.removeChild(c)}}}
function ma(c){function j(e,k){var o=k?e.cloneNode(false):e,n=e.parentNode;if(n){n=j(n,1);var G=e.nextSibling;n.appendChild(o);for(var R=G;R;R=G){G=R.nextSibling;n.appendChild(R)}}return o}for(;!c.nextSibling;)if(c=c.parentNode,!c)return;c=j(c.nextSibling,0);for(var p;(p=c.parentNode)&&p.nodeType===1;)c=p;M.push(c)}for(var oa=/(?:^|\s)nocode(?:\s|$)/,ea=/\r\n?|\n/,Y=H.ownerDocument,$=Y.createElement("li");H.firstChild;)$.appendChild(H.firstChild);for(var M=[$],Z=0;Z<M.length;++Z)J(M[Z]);S===(S|0)&&
M[0].setAttribute("value",S);var ja=Y.createElement("ol");ja.className="linenums";S=Math.max(0,S-1|0)||0;Z=0;for(var fa=M.length;Z<fa;++Z){$=M[Z];$.className="L"+(Z+S)%10;$.firstChild||$.appendChild(Y.createTextNode("\u00a0"));ja.appendChild($)}H.appendChild(ja)}function h(H,S){for(var T=S.length;--T>=0;){var J=S[T];V.hasOwnProperty(J)?x.console&&console.warn("cannot override language handler %s",J):V[J]=H}}function f(H,S){if(!H||!V.hasOwnProperty(H))H=/^\s*</.test(S)?"default-markup":"default-code";
return V[H]}function r(H){var S=H.h;try{var T=P(H.c,H.i),J=T.a;H.a=J;H.d=T.d;H.e=0;f(S,J)(H);var ma=/\bMSIE\s(\d+)/.exec(navigator.userAgent);ma=ma&&+ma[1]<=8;S=/\n/g;var oa=H.a,ea=oa.length;T=0;var Y=H.d,$=Y.length;J=0;var M=H.g,Z=M.length,ja=0;M[Z]=ea;var fa,c;for(c=fa=0;c<Z;)M[c]!==M[c+2]?(M[fa++]=M[c++],M[fa++]=M[c++]):c+=2;Z=fa;for(c=fa=0;c<Z;){for(var j=M[c],p=M[c+1],e=c+2;e+2<=Z&&M[e+1]===p;)e+=2;M[fa++]=j;M[fa++]=p;c=e}M.length=fa;var k=H.c,o;if(k){o=k.style.display;k.style.display="none"}try{for(;J<
$;){var n=Y[J+2]||ea,G=M[ja+2]||ea;e=Math.min(n,G);var R=Y[J+1],aa;if(R.nodeType!==1&&(aa=oa.substring(T,e))){ma&&(aa=aa.replace(S,"\r"));R.nodeValue=aa;var ia=R.ownerDocument,da=ia.createElement("span");da.className=M[ja+1];var Fa=R.parentNode;Fa.replaceChild(da,R);da.appendChild(R);T<n&&(Y[J+1]=R=ia.createTextNode(oa.substring(e,n)),Fa.insertBefore(R,da.nextSibling))}T=e;T>=n&&(J+=2);T>=G&&(ja+=2)}}finally{if(k)k.style.display=o}}catch(ka){x.console&&console.log(ka&&ka.stack||ka)}}var x=window,
F=["break,continue,do,else,for,if,return,while"],y=[[F,"auto,case,char,const,default,double,enum,extern,float,goto,inline,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],D=[y,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,delegate,dynamic_cast,explicit,export,friend,generic,late_check,mutable,namespace,nullptr,property,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],
O=[y,"abstract,assert,boolean,byte,extends,final,finally,implements,import,instanceof,interface,null,native,package,strictfp,super,synchronized,throws,transient"],L=[O,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,internal,into,is,let,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var,virtual,where"];y=[y,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"];
var U=[F,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],ha=[F,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],sa=[F,"as,assert,const,copy,drop,enum,extern,fail,false,fn,impl,let,log,loop,match,mod,move,mut,priv,pub,pure,ref,self,static,struct,true,trait,type,unsafe,use"];F=
[F,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"];var la=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)\b/,ua=/\S/,I=a({keywords:[D,L,y,"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",U,ha,F],hashComments:true,cStyleComments:true,multiLineStrings:true,regexLiterals:true}),V={};h(I,["default-code"]);
h(t([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\S\s]*?(?:--\>|$)/],["lang-",/^<\?([\S\s]+?)(?:\?>|$)/],["lang-",/^<%([\S\s]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\S\s]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\S\s]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\S\s]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]);h(t([["pln",/^\s+/,m," \t\r\n"],["atv",/^(?:"[^"]*"?|'[^']*'?)/,
m,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w-.:]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^\s"'>]*(?:[^\s"'/>]|\/(?=\s)))/],["pun",/^[/<->]+/],["lang-js",/^on\w+\s*=\s*"([^"]+)"/i],["lang-js",/^on\w+\s*=\s*'([^']+)'/i],["lang-js",/^on\w+\s*=\s*([^\s"'>]+)/i],["lang-css",/^style\s*=\s*"([^"]+)"/i],["lang-css",/^style\s*=\s*'([^']+)'/i],["lang-css",/^style\s*=\s*([^\s"'>]+)/i]]),["in.tag"]);h(t([],[["atv",/^[\S\s]+/]]),["uq.val"]);h(a({keywords:D,hashComments:true,
cStyleComments:true,types:la}),["c","cc","cpp","cxx","cyc","m"]);h(a({keywords:"null,true,false"}),["json"]);h(a({keywords:L,hashComments:true,cStyleComments:true,verbatimStrings:true,types:la}),["cs"]);h(a({keywords:O,cStyleComments:true}),["java"]);h(a({keywords:F,hashComments:true,multiLineStrings:true}),["bash","bsh","csh","sh"]);h(a({keywords:U,hashComments:true,multiLineStrings:true,tripleQuotedStrings:true}),["cv","py","python"]);h(a({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",
hashComments:true,multiLineStrings:true,regexLiterals:2}),["perl","pl","pm"]);h(a({keywords:ha,hashComments:true,multiLineStrings:true,regexLiterals:true}),["rb","ruby"]);h(a({keywords:y,cStyleComments:true,regexLiterals:true}),["javascript","js"]);h(a({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,throw,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:true,multilineStrings:true,tripleQuotedStrings:true,
regexLiterals:true}),["coffee"]);h(a({keywords:sa,cStyleComments:true,multilineStrings:true}),["rc","rs","rust"]);h(t([],[["str",/^[\S\s]+/]]),["regex"]);var W=x.PR={createSimpleLexer:t,registerLangHandler:h,sourceDecorator:a,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ",prettyPrintOne:x.prettyPrintOne=function(H,S,T){var J=
document.createElement("div");J.innerHTML="<pre>"+H+"</pre>";J=J.firstChild;T&&i(J,T,true);r({h:S,j:T,c:J,i:1});return J.innerHTML},prettyPrint:x.prettyPrint=function(H,S){function T(){for(var n=x.PR_SHOULD_USE_CONTINUATION?M.now()+250:Infinity;Z<oa.length&&M.now()<n;Z++){for(var G=oa[Z],R=o,aa=G;aa=aa.previousSibling;){var ia=aa.nodeType,da=(ia===7||ia===8)&&aa.nodeValue;if(da?!/^\??prettify\b/.test(da):ia!==3||/\S/.test(aa.nodeValue))break;if(da){R={};da.replace(/\b(\w+)=([\w%+\-.:]+)/g,function(Ya,
ta,Ba){R[ta]=Ba});break}}aa=G.className;if((R!==o||c.test(aa))&&!j.test(aa)){ia=false;for(da=G.parentNode;da;da=da.parentNode)if(k.test(da.tagName)&&da.className&&c.test(da.className)){ia=true;break}if(!ia){G.className+=" prettyprinted";ia=R.lang;if(!ia){ia=aa.match(fa);var Fa;if(!ia&&(Fa=E(G))&&e.test(Fa.tagName))ia=Fa.className.match(fa);ia&&(ia=ia[1])}if(p.test(G.tagName))da=1;else{da=G.currentStyle;var ka=ma.defaultView;da=(da=da?da.whiteSpace:ka&&ka.getComputedStyle?ka.getComputedStyle(G,m).getPropertyValue("white-space"):
0)&&"pre"===da.substring(0,3)}ka=R.linenums;if(!(ka=ka==="true"||+ka))ka=(ka=aa.match(/\blinenums\b(?::(\d+))?/))?ka[1]&&ka[1].length?+ka[1]:true:false;ka&&i(G,ka,da);ja={h:ia,c:G,j:ka,i:da};r(ja)}}}Z<oa.length?setTimeout(T,250):"function"===typeof H&&H()}var J=S||document.body,ma=J.ownerDocument||document;J=[J.getElementsByTagName("pre"),J.getElementsByTagName("code"),J.getElementsByTagName("xmp")];for(var oa=[],ea=0;ea<J.length;++ea)for(var Y=0,$=J[ea].length;Y<$;++Y)oa.push(J[ea][Y]);J=m;var M=
Date;M.now||(M={now:function(){return+new Date}});var Z=0,ja,fa=/\blang(?:uage)?-([\w.]+)(?!\S)/,c=/\bprettyprint\b/,j=/\bprettyprinted\b/,p=/pre|xmp/i,e=/^code$/i,k=/^(?:pre|code|xmp)$/i,o={};T()}};typeof define==="function"&&define.amd&&define("google-code-prettify",[],function(){return W})})()})();
/*

 Aggregate JavaScript file for Iguana's Translator Script Editor
 Portions Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
 Bundled software includes copyright information where appropriate.
*/
/*

 Copyright (c) 2010-2013 iNTERFACEWARE Inc.  All rights reserved.
*/
ifware=window.ifware||{};(function(a){$lambda=function(b){return function(){return b}};$empty=function(){};$inherit=function(b,c,d){var e=$empty;e.prototype=c.prototype;b.prototype=new e;b.prototype.constructor=b;b.base=c;for(var f in d)b.prototype[f]=d[f];return b};a.extendFrom=function(b,c,d,e){e&&e(b,d);$.extend(c,d);b.data("state")?$.extend(b.data("state"),c):b.data("state",c);return b.data("state")}})(ifware);/*

 BrowserDetect from http://www.quirksmode.org/js/detect.html
*/
var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].subString)!=-1)return a[b].identity}else if(d)return a[b].identity}},
searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b!=-1)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,
subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],
dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
ifware=window.ifware||{};
var ScriptRunner=function(){function a(g){var j=e;g=$.inArray(g,j);g>=0&&j.splice(g,1);if(e.length==0){$(f).addClass("on");$(ifware).trigger("scriptExecuteDone")}}function b(g,j,l,h,q){function p(z){console.log("ScriptRunner",g,j,":",z)}var t=false,r,w;w={abort:function(){if(!t){p("aborted");a(w);t=true;Ajax.abort(r);l.TaskId=g;Ajax.post("/ann_abort",l)}},cancel:function(){p("user cancel");w.abort();try{q()}catch(z){}}};p("starting");l.ScriptRunnerTask=g;r=Ajax.post(j,l,function(z,y,A){p("got data");
a(w);t=true;try{h(z,y,A)}catch(B){}},"json");e.push(w);$(f).removeClass("on");return w}var c=0,d=0,e=[],f="#script_stopper";$(f).live("click",function(){for(console.log("ScriptRunner - stopping all");e.length>0;)e[0].cancel();$(ifware).trigger("scriptExecuteDone")});return function(){var g="#"+ ++c,j;return{post:function(l,h,q,p){j&&j.abort();var t=g+": post #"+ ++d;j=b(t,l,h,q,p)}}}}();function ScriptRunnerDict(){var a={};return function(b){var c=a[b];if(!c){c=ScriptRunner();a[b]=c}return c}};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var LOG={};LOG.Indent="";LOG.FuncTable={};LOG.startFunctionLog=function(a,b){console.log(">"+a+LOG.formatArgsAsString(b));LOG.Indent+=" "};LOG.startGroup=function(a,b){for(var c=a+"(",d=[],e=b.length,f=0;f<e;f++){d[f+1]=b[f];ArgType=typeof b[f];c+=ArgType=="string"?"'%s',":ArgType=="number"?"%d,":"%o"}c+=")";d[0]=c;console.group.apply(console,d)};LOG.endFunc=function(a){LOG.Indent=LOG.Indent.substring(0,LOG.Indent.length-1);console.log("<"+a)};LOG.endGroup=function(){console.groupEnd()};
LOG.printObject=function(a){var b=typeof a;if("string"==b)return"'"+a+"'";if("boolean"==b||"number"==b)return a.toString();if(typeof a.toSource=="function")return a.toSource();return"["+a.toString()+"]"};LOG.formatArgsAsString=function(){var a="",b=arguments.length;if(b>0){a+="(";b--;for(var c=0;c<b;c++){a+=LOG.printObject(arguments[c]);a+=", "}a+=LOG.printObject(arguments[b]);a+=")"}else a+="()";return a};
LOG.traceFunction=function(a,b){typeof LOG.FuncTable[b]!=="undefined"&&console.log("Warning! Function",b,"already is being traced. There could be a namespace conflict.");LOG.FuncTable[b]=a[b];a[b]=function(){LOG.startFunctionLog(b,arguments);try{LOG.FuncTable[b].apply(this,arguments)}catch(c){console.log("Exception thrown (re-raised by log.js): ",c);LOG.endFunc(b);throw c;}LOG.endFunc(b)}};
LOG.traceFunctionsMatching=function(a,b){var c=RegExp(b,""),d="",e="";for(i in a)if(i==="LOG")e+=" "+i;else if(typeof a[i]=="function"&&c.test(i)){d+=" "+i;LOG.traceFunction(a,i)}else e+=" "+i;d.length>0&&console.log("Tracing:"+d);e.length>0&&console.log("Not tracing:"+e)};
LOG.turnLoggingOn=function(){if(typeof console!=="undefined"){if(console.log&&!console.orig_log){console.orig_log=console.log;console.log=function(c){console.orig_log(LOG.Indent,c)}}if(typeof console.debug==="function")try{console.debug("Found console.debug method so using it.");console.log=console.debug}catch(a){console.log("console.debug found, but throws exception so not using it.");console.log(a)}if(typeof console.group==="function")try{console.group("Found console.group, so using it.");console.groupEnd();
LOG.startFunctionLog=LOG.startGroup;LOG.endFunc=LOG.endGroup}catch(b){console.log("console.group and console.groupEnd found, but throws exception so not using it.");console.log(b)}}};LOG.turnLoggingOff=function(){console.log=function(){}};LOG.activate=function(a){a?LOG.turnLoggingOn():LOG.turnLoggingOff()};if(typeof console==="undefined")console={log:function(){}};if(typeof console.assert=="undefined")console.assert=function(){};LOG.turnLoggingOff();/*

 Watermark plugin for jQuery
 Copyright ? 2009-2011 Todd Northrop
 http://www.speednet.biz/
 Dual licensed under the MIT or GPL Version 2 licenses.
*/
(function(a){a.watermarker=function(){};a.extend(a.watermarker,{defaults:{color:"#999",left:4},setDefaults:function(b){a.extend(a.watermarker.defaults,b)},checkVal:function(b,c){b==""?a(c).show():a(c).hide()}});a.fn.watermark=function(b,c){var d;d=a.extend(a.watermarker.defaults,c);this.filter("input[type=text], input[type=password], textarea").each(function(){var e,f,g,j,l,h;e=a(this);f=e.attr("placeholder")!=undefined&&e.attr("placeholder")!=""?"placeholder":"title";g=b===undefined||b===""?a(this).attr(f):
b;j=a('<span class="watermark_container"></span>');l=a('<span class="watermark">'+g+"</span>");f=="placeholder"&&e.removeAttr("placeholder");j.css({"float":e.css("float"),position:"relative"});e.wrap(j);if(this.nodeName.toLowerCase()!="textarea"){j=e.outerHeight();g="50%";h=j+"px"}else{g=e.position();f=e.css("margin-top")!=="auto"?parseInt(e.css("margin-top")):0;g=g.top+parseInt(e.css("padding-top"))+f+parseInt(e.css("border-top-width"));h=e.css("line-height");j=h==="normal"?parseInt(e.css("font-size")):
h}f=e.css("margin-left")!=="auto"?parseInt(e.css("margin-left")):"0";a.watermarker.checkVal(e.val(),l);l.css({position:"absolute",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),color:d.color,left:d.left,right:0,bottom:0,top:g,height:j+"px",lineHeight:h,marginTop:"-"+j/2+"px",marginLeft:f+parseInt(e.css("padding-left"))}).data("jq_watermark_element",e);l.click(function(){a(a(this).data("jq_watermark_element")).focus()});e.before(l).focus(function(){a.watermarker.checkVal(a(this).val(),
l);l.animate({opacity:0.7},250)}).blur(function(){a.watermarker.checkVal(a(this).val(),l);l.animate({opacity:1},250)}).keydown(function(){a(l).hide()})});return this};a(document).ready(function(){a(".jq_watermark").watermark()})})(jQuery);/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var AJAXusedRequestObjectStack=[],arrayRequest=[],userAgent=navigator.userAgent.toLowerCase();if(userAgent.indexOf("msie")!=-1)window.attachEvent("onbeforeunload",AJAXbeforeUnload);else document.implementation&&document.implementation.createDocument&&window.addEventListener("beforeunload",AJAXbeforeUnload,false);
function AJAXbeforeUnload(){for(countArray=0;countArray<arrayRequest.length;countArray++)if(arrayRequest[countArray]){arrayRequest[countArray].onreadystatechange=function(){};arrayRequest[countArray].abort()}}function AJAXnewHttpRequest(){return AJAXusedRequestObjectStack.length==0?window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"):AJAXusedRequestObjectStack.pop()}
function AJAXremoveFromArrayRequest(a){if(a)for(var b=0;b<arrayRequest.length;)if(arrayRequest[b]==a)arrayRequest.splice(b,1);else b++}
function AJAXhandleResponse(a,b,c){try{if(a.readyState==4){try{if(a.status==200||a.status==403)b(a.responseText,a.getResponseHeader("Content-Type"),a);else if(c){b="The response from the Iguana server could not be read.";if(a.status&&a.status!=0){b+="<br />Status: "+a.status;if(a.statusText&&a.statusText!="")b+=" - "+a.statusText}c(b,a)}}catch(d){}a.onreadystatechange=function(){};AJAXusedRequestObjectStack.push(a);AJAXremoveFromArrayRequest(a)}}catch(e){if(c&&a){try{c("The response from the Iguana server could not be read.<br />"+
(e.description||e),a)}catch(f){}a.onreadystatechange=function(){};AJAXusedRequestObjectStack.push(a);AJAXremoveFromArrayRequest(a)}}}function AJAXpost(a,b,c,d){try{var e=AJAXnewHttpRequest();arrayRequest[arrayRequest.length]=e;e.open("POST",a,true);e.onreadystatechange=function(){AJAXhandleResponse(e,c,d)};e.send(b)}catch(f){d&&d("AJAX is not supported by the browser.")}}
function AJAXsynchronousPost(a,b,c,d){try{var e=AJAXnewHttpRequest();arrayRequest[arrayRequest.length]=e;e.open("POST",a,false);e.send(b);AJAXhandleResponse(e,c,d)}catch(f){d&&d("AJAX is not supported by the browser.")}}var AJAXrequestsWithIds={};function AJAXabortRequest(a){a.onreadystatechange=function(){};a.abort();AJAXusedRequestObjectStack.push(a);AJAXremoveFromArrayRequest(a)}function AJAXclearRequestId(a){AJAXrequestsWithIds[a]&&delete AJAXrequestsWithIds[a]}
function AJAXabortRequestById(a){if(AJAXrequestsWithIds[a]){AJAXabortRequest(AJAXrequestsWithIds[a]);AJAXclearRequestId(a)}}function AJAXpostWithId(a,b,c,d,e){try{AJAXabortRequestById(c);var f=AJAXnewHttpRequest();arrayRequest[arrayRequest.length]=f;f.open("POST",a,true);f.onreadystatechange=function(){f.readyState==4&&AJAXclearRequestId(c);AJAXhandleResponse(f,d,e)};f.send(b);AJAXrequestsWithIds[c]=f}catch(g){AJAXclearRequestId(c);e&&e("AJAX is not supported by the browser.")}}
if(!window.JSON){window.JSON={};window.JSON.parse=function(a){return eval("("+a+")")}};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function COOKIEcreate(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+c*864E5);c="; expires="+d.toGMTString()}else c="";document.cookie=a+"="+b+c+"; path=/"}function COOKIEread(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];d.charAt(0)==" ";)d=d.substring(1,d.length);if(d.indexOf(a)==0)return d.substring(a.length,d.length)}return null}function COOKIEerase(a){COOKIEcreate(a,"",-1)};/*

 Copyright (c) 2010-2013 iNTERFACEWARE Inc.  All rights reserved.
*/
ifware.core=ifware.core||{};ifware.core.ui=ifware.core.ui||{};ifware.core.ui.displayManager=ifware.core.ui.displayManager||{};
(function(a,b){a.hideInactiveForegrounds=function(){var c=null;return{isRegisteredForEvents:false,eventType:"clickedAwayEvent",register:function(d){if(!d.ignore)throw Error("DisplayManager: failed to register because it doesn't implement ignore interface.");c=d;if(!this.isRegisteredForEvents){this.isRegisteredForEvents=true;$(b).bind(this.eventType,$.proxy(this.handleClick,this))}},handleClick:function(d){if(c){if(d.target===c.$this[0])return;c.ignore();c=null}$(b).unbind(this.eventType,this.handleClick);
this.isRegisteredForEvents=false},makeIgnoreable:function(d,e,f,g,j){j||(j={$this:d});d.click(function(l){l.stopPropagation()});j.hide=e;j.ignore=f;j.show=function(){a.hideInactiveForegrounds.register(this);g()};return j}}}();$(document).click(function(){$(b).trigger(a.hideInactiveForegrounds.eventType)})})(ifware.core.ui.displayManager,ifware);/*

 Copyright (c) 2010-2013 iNTERFACEWARE Inc.  All rights reserved.
*/
ifware.core=ifware.core||{};ifware.core.ui=ifware.core.ui||{};
(function(a){a.Button=function(){var b={pressedStyle:"",hoverStyle:"",isPressed:false},c=function(d,e){this.options=e=$.extend({},b,e);this.$this=d;this.enabled=true;d.css("cursor","pointer");d.hover($.proxy(this.hoverIn,this),$.proxy(this.hoverOut,this));this.isPressed=false;if(this.options.isPressed){d.is("input[type=checkbox]")&&d.attr("checked","checked");this.isPressed=true;this.options.pressedStyle&&this.$this.addClass(this.options.pressedStyle)}d.click($.proxy(this.press,this));d.data("Button",
this);this.isAnchor=d.is("a")};c.prototype={disable:function(){this.$this.attr("disabled",true);this.$this.addClass("disabled");this.enabled=false},enable:function(){this.$this.removeAttr("disabled");this.$this.removeClass("disabled");this.enabled=true},hoverIn:function(){this.options.hoverStyle&&this.$this.addClass(this.options.hoverStyle)},hoverOut:function(){this.options.hoverStyle&&!this.isPressed&&this.$this.removeClass(this.options.hoverStyle)},unpress:function(d){this.options.pressedStyle&&
this.$this.removeClass(this.options.pressedStyle);this.isPressed=false;this.onUnpressed(d)},press:function(d){this.onClick();if(this.isPressed)this.unpress(d);else{this.options.pressedStyle&&this.$this.addClass(this.options.pressedStyle);this.isPressed=true;this.onPressed(d)}this.options.press&&this.options.press(this.isPressed);if(this.isAnchor&&d!==null){d.preventDefault();return false}},onPressed:$empty,onUnpressed:$empty,onClick:$empty};return c}()})(ifware.core.ui,ifware);/*

 Copyright (c) 2010-2013 iNTERFACEWARE Inc.  All rights reserved.
*/
ifware.toolbar=ifware.toolbar||{};
(function(a){var b=String(BrowserDetect.version),c=false;if("Explorer"==BrowserDetect.browser&&null!=b.match(/^8/))c=true;a.sections={scriptExecutionSection:function(d,e){var f=$('<div class="toolbarSectionChild">                <a id="executeScriptButton" class="button_icon" title="Execute the script to generate annotations."></a>                <a id="script_stopper" class="button_icon on" title="Stop script"></a>                <a id="autoexecution_toggle" class="button_icon on" title="Toggle auto-execution. When enabled, the script runs in the background during script editing. If disabled, auto-completion will be unavailable and annotations will only update if you run the script manually."></a>            </div>'),g=
f.find("#executeScriptButton"),j=f.find("#script_stopper"),l=f.find("#autoexecution_toggle"),h=new ifware.core.ui.Button(g,{pressedStyle:"on",press:function(q){if(q){h.disable();$(ifware).trigger("scriptExecute");NISretrieveCodeBlockData(e);NISretrieveMergeConflictData(e);NISupdateAnnotations(e,{force:true,SendCode:true});NIScleanDirtyLine(e)}e.ifware.focusLastFocussedElement()}});$(ifware).bind("scriptExecuteDone",function(){h.enable();h.unpress()});$(ifware).bind("ExecuteScriptOnce",function(){g.click()});
j.click(function(){e.ifware.focusLastFocussedElement()});new ifware.core.ui.Button(l,{pressedStyle:"on",isPressed:!e.ifware.projectSettings.disableAutoScriptExecution(),press:function(q){e.ifware.projectSettings.disableAutoScriptExecution(!q);q||NISclearAnnotations(e);NISupdateAnnotations(e,{SendCode:true});e.ifware.focusLastFocussedElement()}});d.append(f)},viewOptionsSection:function(d,e){var f=$('<div class="toolbarSectionChild">                <a id="project_pane_toggle" class="button_icon" title="Show project manager"></a>                <a id="thumbnail_toggle" class="button_icon" title="Show thumbnail"></a>            </div>'),
g=f.find("#project_pane_toggle"),j=f.find("#thumbnail_toggle");new ifware.core.ui.Button(g,{pressedStyle:"on",isPressed:e.ifware.projectSettings.showProjectExplorer(),press:function(l){e.ifware.projectSettings.showProjectExplorer(l);EDTtoggleProjectPane(l);e.ifware.focusLastFocussedElement()}});g=new ifware.core.ui.Button(j,{pressedStyle:"on",isPressed:e.ifware.projectSettings.showThumbnails(),press:function(l){e.ifware.projectSettings.showThumbnails(l);e.ifware.focusLastFocussedElement()}});if(c){g.disable(true);
j.attr("title","This feature is not available in Internet Explorer 8 or lower.")}d.append(f)}}})(ifware.toolbar);/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var Ajax;
$(document).ready(function(){function a(){$("body").append('         <div id="ajax-popup" style="display:none">            <table width="100%">            <tr>               <td colspan="2" id="ajax-message" align="center">            </table>         </div>      ');return $("#ajax-popup").dialog({autoOpen:false,modal:true,title:"Communication Error",buttons:{Retry:function(){$(this).dialog("close");var j=f;f=null;j()}}})}function b(j,l){console.log("Why error function called.");console.log(l);if(l.status==
403)return"Your session has expired.";else if(j=="parsererror")return"Unable to parse response from server.";else if(j=="permission_issue")return"You don't have the necessary permissions to view this page.";else if(j!="notmodified")return"The server is not responding."}function c(j,l,h){if(g)if(f){var q=f;f=function(){try{q()}catch(t){}l()}}else{var p=$("#ajax-popup");p.length||(p=a());f=function(){l()};$("#ajax-message").text(b(j,h));p.dialog("open")}}function d(j){if(j.PermissionIssue)return"permission_issue"}
function e(j){$("#permission_dlg").length&&$("#permission_dlg").remove();$("body").append('<div id="permission_dlg" style="display:none">'+j+"</div>");j=$("#permission_dlg");j.append('<p> Go back to the <a href="../dashboard.html"> dashboard. </a> </p>');j.dialog({bgiframe:true,width:400,height:110,title:"Insufficient Permissions",position:"center",modal:true,autoOpen:false});j.dialog("open")}var f,g;Ajax=window.MiniLogin?AjaxImpl(function(j,l,h){j=="permission_issue"?e(b(j,h)):MiniLogin.show(b(j,
h),function(){location.reload()})},d):AjaxImpl(c,d);$(window).unload(function(){g=false});g=true});
function AFUuploadFile(a,b,c,d,e){function f(){$(this).dialog("close");location.reload()}function g(h){window.MiniLogin?MiniLogin.show("File upload failed. "+h,function(){location.reload()}):$("<div>"+h+"</div>").appendTo("body").dialog({modal:true,title:"Communication Error",buttons:{Reload:f}})}var j="uploader"+(new Date).getTime();b.find('input[name="AFUlocation"]').remove();b.append('<input type="hidden" name="AFUlocation" value="'+a+'" />');var l=$('<iframe name="'+j+'" src="about:blank" />');
l.css("display","none");$("body").append(l);l.load(function(){var h=null;h=l.contentDocument?l.contentDocument:l.contentWindow?l.contentWindow.document:window.frames[j].document;if(h=$(h).find("body").html())if(h=="Not logged in.")g("File upload failed. Your session has expired.");else{var q=null;q=JSON.parse?JSON.parse(h):eval("("+h+")")}else g("File upload failed. The server is not responding.");setTimeout(function(){l.remove();d&&q&&d(q,e)},100)});b.attr("action","/ajax_file_upload").attr("method",
"post").attr("enctype","multipart/form-data").attr("encoding","multipart/form-data").attr("target",j);b.get(0).submit();c&&c(b)};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var TOOLactiveTimeout,TOOLtooltipText="",TOOLtooltipShowCallback=null,TOOLtooltipElement=null,TOOLtooltipOffset,TOOLmousePositionX=0,TOOLmousePositionY=0,TOOLwindowSizeOffset=10,TOOLpositionOffset=10,TOOLarrowOffset=20,TOOLarrowWidth=10,TOOLborderSize=2;function TOOLinitialize(){document.captureEvents&&document.captureEvents(Event.MOUSEMOVE);document.onmousemove=TOOLmouseMove}function TOOLmouseMove(a){if(!a)a=window.event;TOOLmousePositionX=a.clientX;TOOLmousePositionY=a.clientY}
function TOOLcalculatePosition(a,b,c,d){var e=a+TOOLpositionOffset;if(e+d>c-TOOLwindowSizeOffset)e=a-d-TOOLpositionOffset;if(e<TOOLwindowSizeOffset)e=TOOLwindowSizeOffset;return e+b}var TOOLnormDiv;function TOOLnormalizeInnerHtml(a){TOOLnormDiv||(TOOLnormDiv=document.createElement("div"));TOOLnormDiv.innerHTML=a;return TOOLnormDiv.innerHTML}
function TOOLpositionWithMousePosition(a,b,c){b.style.display="none";c.style.display="none";if(TOOLnormalizeInnerHtml(TOOLtooltipText)!=document.getElementById("divTooltipBody").innerHTML){document.getElementById("divTooltipBody").innerHTML=TOOLtooltipText;a.style.left=TOOLcalculatePosition(TOOLmousePositionX,WINgetWindowLeft(),WINgetWindowWidth(),a.offsetWidth)+"px";a.style.top=TOOLcalculatePosition(TOOLmousePositionY,WINgetWindowTop(),WINgetWindowHeight(),a.offsetHeight)+"px"}}
function TOOLpositionLeftWithElement(a,b,c){var d=WINwindowOffsetLeft(TOOLtooltipElement),e=d+TOOLtooltipElement.offsetWidth-TOOLarrowOffset+(TOOLtooltipOffset.Left||0),f=0;if(e+a.offsetWidth>WINgetWindowWidth()-TOOLwindowSizeOffset){e=d-a.offsetWidth+TOOLarrowOffset-TOOLarrowWidth+TOOLtooltipElement.offsetWidth+(TOOLtooltipOffset.Left||0);f=a.offsetWidth-TOOLarrowOffset;b.style.backgroundImage="url(/js/tooltip/images/tooltip_arrow_top_left.gif)";c.style.backgroundImage="url(/js/tooltip/images/tooltip_arrow_bottom_left.gif)"}else{f=
TOOLarrowOffset;b.style.backgroundImage="url(/js/tooltip/images/tooltip_arrow_top_right.gif)";c.style.backgroundImage="url(/js/tooltip/images/tooltip_arrow_bottom_right.gif)"}if(e<TOOLwindowSizeOffset){e=TOOLwindowSizeOffset;f=d-TOOLwindowSizeOffset-TOOLarrowWidth}b.style.backgroundPosition=f+"px";c.style.backgroundPosition=f+"px";a.style.left=e+WINgetWindowLeft()+"px"}
function TOOLpositionTopWithElement(a,b,c){var d=WINwindowOffsetTop(TOOLtooltipElement),e=d+TOOLtooltipElement.offsetHeight-TOOLborderSize+(TOOLtooltipOffset.Top||0),f=false,g=false;if(e+a.offsetHeight>WINgetWindowHeight()-TOOLwindowSizeOffset){e=d-a.offsetHeight+TOOLborderSize-(TOOLtooltipOffset.Top||0);g=true}else f=true;if(e<TOOLwindowSizeOffset){e=TOOLwindowSizeOffset;g=f=false}b.style.visibility=f?"visible":"hidden";c.style.visibility=g?"visible":"hidden";a.style.top=e+WINgetWindowTop()+"px"}
function TOOLpositionWithElement(a,b,c){if(""!=TOOLtooltipText){b.style.width="1px";c.style.width="1px";if(TOOLnormalizeInnerHtml(TOOLtooltipText)!=document.getElementById("divTooltipBody").innerHTML){document.getElementById("divTooltipBody").innerHTML=TOOLtooltipText;TOOLpositionLeftWithElement(a,b,c);TOOLpositionTopWithElement(a,b,c)}b.style.width=a.offsetWidth+"px";c.style.width=a.offsetWidth+"px"}}
function TOOLtooltipShowAndFade(a,b,c){var d=$("#divTooltip"),e=function(){TOOLtooltipClose();d.fadeTo(0,1)};TOOLtooltipLink(a,null,b);setTimeout(function(){TOOLtooltipElement==b&&d.fadeTo("slow",0,e)},c)}
function TOOLtooltipShow(){var a=document.getElementById("divTooltip"),b=document.getElementById("divTooltipTop"),c=document.getElementById("divTooltipBottom");null==TOOLtooltipElement?TOOLpositionWithMousePosition(a,b,c):TOOLpositionWithElement(a,b,c);a.style.visibility="visible";TOOLtooltipShowCallback!=null&&TOOLtooltipShowCallback()}function TOOLtooltipRefresh(a){TOOLtooltipText=a;TOOLtooltipShow()}
function TOOLtooltipClose(){$(document).find("#divTooltip").remove();clearTimeout(TOOLactiveTimeout);window.status=""}function TOOLisTooltipShowing(){return"hidden"!=WINgetStyle(document.getElementById("divTooltip"),"visibility")}
function TOOLtooltipLink(a,b,c,d){$(document).find("body").append('<div id="divTooltip" class="tooltip"><div id="divTooltipTop" class="tooltip_top"></div><div id="divTooltipBody" class="tooltip_body"></div><div id="divTooltipBottom" class="tooltip_bottom"></div></div>');console.log(c);TOOLtooltipText=a;TOOLtooltipShowCallback=b;TOOLtooltipElement=c;TOOLtooltipOffset=d||{Left:0,Top:0};if(undefined===TOOLtooltipShowCallback)TOOLtooltipShowCallback=null;if(undefined===TOOLtooltipElement)TOOLtooltipElement=
null;TOOLactiveTimeout=setTimeout("TOOLtooltipShow();",300)};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function WINgetWindowWidth(){return window.innerWidth===undefined?document.documentElement.clientWidth:window.innerWidth}function WINgetWindowHeight(){return window.innerHeight===undefined?document.documentElement.clientHeight:window.innerHeight}function WINgetWindowLeft(){var a=document.body.scrollLeft;if(0==a)a=window.pageXOffset?window.pageXOffset:document.body.parentElement?document.body.parentElement.scrollLeft:0;return a}
function WINgetWindowTop(){var a=document.body.scrollTop;if(0==a)a=window.pageYOffset?window.pageYOffset:document.body.parentElement?document.body.parentElement.scrollTop:0;return a}function WINwindowOffsetTop(a){for(var b=0,c=a;c!=null;c=c.offsetParent)if(c.offsetTop!==undefined)b+=c.offsetTop;for(c=a.parentNode;c!=null;c=c.parentNode)if(c.scrollTop!==undefined)b-=c.scrollTop;return b}
function WINwindowOffsetLeft(a){for(var b=0,c=a;c!=null;c=c.offsetParent)if(c.offsetLeft!==undefined)b+=c.offsetLeft;for(c=a.parentNode;c!=null;c=c.parentNode)if(c.scrollLeft!==undefined)b-=c.scrollLeft;return b}function WINgetStyle(a,b){var c=a.style[b];if(!c)if(window.getComputedStyle)c=(c=document.defaultView.getComputedStyle(a,null))?c[b]:null;else if(a.currentStyle)c=a.currentStyle[b];return c};/*

 http://www.JSON.org/json2.js
 2010-08-25

 Public Domain.

 NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.

 See http://www.JSON.org/js.html


 This code should be minified before deployment.
 See http://javascript.crockford.com/jsmin.html

 USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO
 NOT CONTROL.


 This file creates a global JSON object containing two methods: stringify
 and parse.

 JSON.stringify(value, replacer, space)
 value       any JavaScript value, usually an object or array.

 replacer    an optional parameter that determines how object
 values are stringified for objects. It can be a
 function or an array of strings.

 space       an optional parameter that specifies the indentation
 of nested structures. If it is omitted, the text will
 be packed without extra whitespace. If it is a number,
 it will specify the number of spaces to indent at each
 level. If it is a string (such as '\t' or '&nbsp;'),
 it contains the characters used to indent at each level.

 This method produces a JSON text from a JavaScript value.

 When an object value is found, if the object contains a toJSON
 method, its toJSON method will be called and the result will be
 stringified. A toJSON method does not serialize: it returns the
 value represented by the name/value pair that should be serialized,
 or undefined if nothing should be serialized. The toJSON method
 will be passed the key associated with the value, and this will be
 bound to the value

 For example, this would serialize Dates as ISO strings.

 Date.prototype.toJSON = function (key) {
 function f(n) {
 // Format integers to have at least two digits.
 return n < 10 ? '0' + n : n;
 }

 return this.getUTCFullYear()   + '-' +
 f(this.getUTCMonth() + 1) + '-' +
 f(this.getUTCDate())      + 'T' +
 f(this.getUTCHours())     + ':' +
 f(this.getUTCMinutes())   + ':' +
 f(this.getUTCSeconds())   + 'Z';
 };

 You can provide an optional replacer method. It will be passed the
 key and value of each member, with this bound to the containing
 object. The value that is returned from your method will be
 serialized. If your method returns undefined, then the member will
 be excluded from the serialization.

 If the replacer parameter is an array of strings, then it will be
 used to select the members to be serialized. It filters the results
 such that only members with keys listed in the replacer array are
 stringified.

 Values that do not have JSON representations, such as undefined or
 functions, will not be serialized. Such values in objects will be
 dropped; in arrays they will be replaced with null. You can use
 a replacer function to replace those with JSON values.
 JSON.stringify(undefined) returns undefined.

 The optional space parameter produces a stringification of the
 value that is filled with line breaks and indentation to make it
 easier to read.

 If the space parameter is a non-empty string, then that string will
 be used for indentation. If the space parameter is a number, then
 the indentation will be that many spaces.

 Example:

 text = JSON.stringify(['e', {pluribus: 'unum'}]);
 // text is '["e",{"pluribus":"unum"}]'


 text = JSON.stringify(['e', {pluribus: 'unum'}], null, '\t');
 // text is '[\n\t"e",\n\t{\n\t\t"pluribus": "unum"\n\t}\n]'

 text = JSON.stringify([new Date()], function (key, value) {
 return this[key] instanceof Date ?
 'Date(' + this[key] + ')' : value;
 });
 // text is '["Date(---current time---)"]'


 JSON.parse(text, reviver)
 This method parses a JSON text to produce an object or array.
 It can throw a SyntaxError exception.

 The optional reviver parameter is a function that can filter and
 transform the results. It receives each of the keys and values,
 and its return value is used instead of the original value.
 If it returns what it received, then the structure is not modified.
 If it returns undefined then the member is deleted.

 Example:

 // Parse the text. Values that look like ISO date strings will
 // be converted to Date objects.

 myData = JSON.parse(text, function (key, value) {
 var a;
 if (typeof value === 'string') {
 a =
 /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(value);
 if (a) {
 return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],
 +a[5], +a[6]));
 }
 }
 return value;
 });

 myData = JSON.parse('["Date(09/09/2001)"]', function (key, value) {
 var d;
 if (typeof value === 'string' &&
 value.slice(0, 5) === 'Date(' &&
 value.slice(-1) === ')') {
 d = new Date(value.slice(5, -1));
 if (d) {
 return d;
 }
 }
 return value;
 });


 This is a reference implementation. You are free to copy, modify, or
 redistribute.
*/
if(!this.JSON)this.JSON={};
(function(){function a(h){return h<10?"0"+h:h}function b(h){e.lastIndex=0;return e.test(h)?'"'+h.replace(e,function(q){var p=j[q];return typeof p==="string"?p:"\\u"+("0000"+q.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+h+'"'}function c(h,q){var p,t,r,w,z=f,y,A=q[h];if(A&&typeof A==="object"&&typeof A.toJSON==="function")A=A.toJSON(h);if(typeof l==="function")A=l.call(q,h,A);switch(typeof A){case "string":return b(A);case "number":return isFinite(A)?String(A):"null";case "boolean":case "null":return String(A);
case "object":if(!A)return"null";f+=g;y=[];if(Object.prototype.toString.apply(A)==="[object Array]"){w=A.length;for(p=0;p<w;p+=1)y[p]=c(p,A)||"null";r=y.length===0?"[]":f?"[\n"+f+y.join(",\n"+f)+"\n"+z+"]":"["+y.join(",")+"]";f=z;return r}if(l&&typeof l==="object"){w=l.length;for(p=0;p<w;p+=1){t=l[p];if(typeof t==="string")if(r=c(t,A))y.push(b(t)+(f?": ":":")+r)}}else for(t in A)if(Object.hasOwnProperty.call(A,t))if(r=c(t,A))y.push(b(t)+(f?": ":":")+r);r=y.length===0?"{}":f?"{\n"+f+y.join(",\n"+f)+
"\n"+z+"}":"{"+y.join(",")+"}";f=z;return r}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;if(typeof JSON.stringify!=="function")JSON.stringify=function(h,q,p){var t;g=f="";if(typeof p==="number")for(t=0;t<p;t+=1)g+=" ";else if(typeof p==="string")g=p;if((l=q)&&typeof q!=="function"&&(typeof q!=="object"||typeof q.length!=="number"))throw Error("JSON.stringify");return c("",
{"":h})};if(typeof JSON.parse!=="function")JSON.parse=function(h,q){function p(r,w){var z,y,A=r[w];if(A&&typeof A==="object")for(z in A)if(Object.hasOwnProperty.call(A,z)){y=p(A,z);if(y!==undefined)A[z]=y;else delete A[z]}return q.call(r,w,A)}var t;h=String(h);d.lastIndex=0;if(d.test(h))h=h.replace(d,function(r){return"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(h.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){t=eval("("+h+")");return typeof q==="function"?p({"":t},""):t}throw new SyntaxError("JSON.parse");}})();/*

 A thin wrapper around storage, with one key difference:
 this allows the specification of the data's expiry (like cookies).
 Each time storage is accessed (through set(), get(), or remove()),
 all expired data will be removed.
 Only strings may be stored, but if the string 'true' or 'false' is stored, then it will return Boolean version.

 Unit tests exist for this module in
 shared_web_docs\js\unittests\utils\local_storageTests.js.

 Copyright (c) 2010-2013 iNTERFACEWARE Inc.  All rights reserved.
*/
(function(a,b){a.LocalStorage=function(c){function d(h){var q=h.indexOf(l);return[h.substring(0,q),h.substring(q+1)]}function e(){$(this).trigger(this.events.clearExpired);var h=Math.floor((new Date).getTime()/f);if(h!==g){var q=(new Date).getTime();for(k in j)try{var p=d(j[k]),t=parseInt(p[0]);t!=NaN&&t<q&&j.removeItem(k)}catch(r){}g=h}}var f=864E5,g,j=window.localStorage,l="^";return j?{events:{clearExpired:"clearExpired"},set:function(h,q,p){e.call(this);if(c)h=c.concat("_",h);j.setItem(h,((new Date).getTime()+
p*f).toString().concat(l,q))},setObject:function(h,q,p,t,r){q=JSON.stringify(q,t,r);this.set(h,q,p)},get:function(h){e.call(this);try{if(c)h=c.concat("_",h);var q=d(j.getItem(h));if(q[1]==="true"||q[1]==="false")return q[1]==="true";return q[1]}catch(p){return null}},getObject:function(h,q){var p=this.get(h);return p?JSON.parse(p,q):null},remove:function(h){e.call(this);j.removeItem(h)},clear:function(){j.clear()}}:{set:$empty,get:$lambda(null),remove:$empty,clear:$empty}};a.LocalStorage.setOrGetState=
function(c,d,e,f){if(e===b){if(!c[d].loaded){c[d].loaded=true;e=f.get(d);if(e!==null)c[d]=e}}else if(e!==c[d])if(c[d].constructor===e.constructor){c[d]=e;f.set(d,e)}else throw"Cannot set state of ".concat(d," to a value to a value of a different type.");return c[d]};a.storage=a.LocalStorage()})(ifware||{});/*

 Copyright (c) 2010-2014 iNTERFACEWARE Inc.  All rights reserved.
*/
var PAGlocation="",PAGcurrentPage="",PAGcurrentModule="",PAGcurrentSDIndex=0,PAGbaseTitle="";function PAGsetupCommonMapCalls(a){a.OpenEditor=EDTopenEditor;a.OpenLog=LOGopenLog;a.SampleData=SPDview;a.EditSampleData=SPDEedit;a.BulkTestResults=BTRview;a.Extensions=SCMextensionsPage}function PAGhref(a,b){var c="#Page="+a;if(b)for(i in b)if("Page"!=i)c+="&"+i+"="+PAGescapeQuotes(encodeURIComponent(b[i]));return c}function PAGlink(a,b,c){return"<a href='"+PAGhref(a,b)+"'>"+c+"</a>"}
function PAGescapeQuotes(a){return a.replace(/'/g,"&#39;").replace(/"/,"&quot;")}function PAGconvertSpaceEncoding(a){return a.replace(/\+/g,"%20")}function PAGwarning(a){$("<div>"+PAGhtmlEscape(a)+"</div>").appendTo("body:first").dialog({title:"Warning",modal:true,buttons:{OK:function(){$(this).dialog("close")}},close:function(){$(this).dialog("destroy").remove()}})}
function PAGhtmlEscape(a){return a.replace(/;/g,"&#59;").replace(/&(?!#59;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function PAGgetField(a,b){if(typeof a[b]==="undefined")throw Error("Need to have "+b+" defined.");return a[b]}function LOGopenLog(a){PAGgetField(a,"Script");$(document).find("body").html('<div class="codeListing">Loading logs...</div>');window.log_on=true}function PAGgetOptionalField(a,b){if(typeof a[b]==="undefined")return"";return a[b]}
function PAGparseAnchorString(a){var b={};a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].split("=");if(undefined!=d[1])d[1]=PAGconvertSpaceEncoding(d[1]);b[d[0]]=decodeURIComponent(d[1])}return b}function PAGupdateParamGlobals(a){PAGcurrentPage=a.Page;PAGcurrentModule=a.Module;PAGcurrentSDIndex=parseInt(a.SDIndex)}function PAGcheckParams(a){if(!a.Module)a.Module="main";if(undefined==a.SDIndex)a.SDIndex=0}
function PAGcallPage(a){console.log(a);a=a.split("#");console.log(a);if(a.length<2)MPRapp.defaultRequest("No page specified.");else{a=a.pop();if(a!="error"){Params=PAGparseAnchorString(a);if("OpenEditor"==Params.Page&&PAGcurrentPage==Params.Page){PAGcheckParams(Params);if(PAGcurrentModule!=Params.Module)NISonFileChanged(window.NISeditor,Params.Module);else PAGcurrentSDIndex!=Params.SDIndex&&NISonSampleDataChanged(window.NISeditor,parseInt(Params.SDIndex));PAGupdateParamGlobals(Params)}else{"Extensions"!=
Params.Page&&PAGcheckParams(Params);PAGupdateParamGlobals(Params);window.onresize=null;$(window).unbind("keydown");if(typeof Params.Page==="undefined"||""==Params.Page)MPRapp.defaultRequest("No page specified.");else if(typeof MPRapp.pageLookup[Params.Page]==="undefined")MPRapp.renderError("Page "+Params.Page+" not found.",Params);else MPRapp.pageLookup[Params.Page](Params)}}}}
$(document).ready(function(){function a(){if(PAGlocation!=location.href){PAGlocation=location.href;console.log("Hash change= ",PAGlocation);PAGcallPage(location.href)}}function b(){console.log("Hash change= ",location.href);PAGcallPage(location.href)}if("onhashchange"in window&&(document.documentMode===undefined||document.documentMode>7))window.onhashchange=b;else setInterval(a,100);PAGbaseTitle=$(document).get(0).title});/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
$(document).ready(function(){LOG.activate(true);PAGcallPage(window.location.href)});/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var NISeditor=null;function NIScreateIframe(a,b,c,d){var e;if(document.createElement&&(e=document.createElement("iframe"))){$(e).hide();e.name=e.id=a;e.width=b;e.height=c+4;e.src="about:blank";e.style.padding="0";e.style.border="0";e.style.margin="0";e.style.position="absolute";$(e).css("position","absolute").css("top",c+"px");d.appendChild(e)}return e}function NISblockLeftMargin(a){for(var b=0,c=0;c<a.length;++c)if(a.charAt(c)==" ")++b;else break;return b}
function NISretrieveMergeConflictData(a){for(var b=a.ifware.CharWidth=NIScharWidth(a),c=-1,d=-1,e=-1;(Line=a.getLine(++c))!==undefined;){var f={};if(Line.match(/^.*BEGIN MERGE CONFLICT.*$/))d=c;else if(Line.match(/^.*END MERGE CONFLICT.*$/)){f.c=0;f.w=b*e;f.s=d;f.e=c;f.type="merge_conflict";f.t="Merge Conflict";a.ifware.BlockDataSet[a.ifware.BlockDataSet.length++]=f;d=e=-1}if(d!=-1)if(e<Line.length)e=Line.length}}
function NISretrieveCodeBlockData(a){var b=a.ifware.CharWidth=NIScharWidth(a);a.ifware.BlockDataSet={};for(var c=a.ifware.BlockDataSet.length=0,d=-1,e=false;(Line=a.getLine(++d))!==undefined;)if(!Line.match(/^\s*$/)){var f={};f.c=NISblockLeftMargin(Line);f.w=b*Line.length;f.s=d;f.e=f.s+1;if(e)if(Line.match(/^.*\]\].*$/)){f.type="comment";e=false}else f.type="comment";else if(Line.match(/^\s*\-\-\[\[.*/)){f.type="comment";e=true}else f.type=Line.match(/^\s*\-\-.*$/)||Line.match(/^\s*\-\-\[\[.*\]\].*/)?
"comment":Line.match(/^\s*require\s*.*$/)?"requires":Line.match(/^function .*$/)?"function":Line.match(/^end.*$/)?"end":"line";a.ifware.BlockDataSet[c]=f;++a.ifware.BlockDataSet.length;++c}}function NISmaxLineOfCodeLength(a,b){for(var c=a.length,d=0,e=0;e<c;++e)if("annotation"!=a[e].type){var f=a[e];f=0.5*f.c+0.5*f.w/b;if(f>d)d=f}return d}function NISoptimalBlockWidth(a,b,c,d){return Math.ceil(0.5*a.w/d)}
function NISretrieveBlockStyle(a){var b=null;return b="annotation"==a?{"class":"ANNblock"}:"line"==a?{fill:"grey"}:"comment"==a?{"class":"lua-comment"}:"requires"==a?{"class":"lua-stdfunc"}:"function"==a?{"class":"lua-keyword"}:"end"==a?{"class":"lua-keyword"}:"merge_conflict"==a?{"class":"merge-conflict"}:{"class":"lua-token"}}function NISmainFileSelectedAndEmpty(a){return a.ifware.MainLuaFile==a.ifware.CurrentFileName&&a.lineCount()==1&&a.getLine(0)==""}
function NISonEditorInit(a){a.ifware.CharWidth=NIScharWidth(a);ITSinitIntellisense(a,a.ifware.IntellisenseStatusContainer);a.ifware.addKeyEventListener(function(b,c){if(c.type=="keydown"&&c.keyCode==27){c.preventDefault();return POPdialogsController.closeFrontmostPopup()}return false});if(!a.ifware.projectSettings.showThumbnails()){$("div#EDTthumbnailScroll").hide();$("#EDTeditor .CodeMirror").css("right","0px")}NISannotateCode(a,{FirstRequest:true});ETHscrollerControl.initializeScroller(function(b){EDTscrollEditor(b,
a)});a.ifware.addScrollListener(function(b){ETHscrollerControl.scroll(b)});NISmainFileSelectedAndEmpty(a)&&SCMimportProjectAndData(a)}function NISonCursorActivity(a){if(!a.ifware.ChangingFile)for(var b=0;b<a.ifware.CursorActivityListeners.length;b++)a.ifware.CursorActivityListeners[b](a)}function NISonScroll(a){for(var b=0;b<a.ifware.ScrollListeners.length;b++)a.ifware.ScrollListeners[b](a)}
function NISonChange(a,b){for(var c=0;c<a.ifware.ChangeListeners.length;c++)a.ifware.ChangeListeners[c](a,b)}function NISonKeyEvent(a,b){for(var c=0;c<a.ifware.KeyListeners.length;c++)if(a.ifware.KeyListeners[c](a,b))return true;return false}
function NIScreateEditorWithContent(a,b,c){console.log("CREATING EDITOR");console.log(a);console.log(b);var d=NISeditor=new CodeMirror(a,{lineNumbers:true,indentUnit:3,tabMode:"indent",mode:b.ScriptType,theme:"ifware",value:b.ScriptData,onCursorActivity:NISonCursorActivity,onScroll:NISonScroll,onChange:NISonChange,onKeyEvent:NISonKeyEvent,onBlur:NISunmarkCurrentLine,onFocus:NISonEditorFocus});ifware.Editor=d;if(!d.getHistory||!d.setHistory)alert("Warning: editor history patch (#17864) is unavailable.  Has CodeMirror been upgraded?");
d.ifware={};d.ifware.CursorActivityListeners=[NISdefaultOnCursorMove];d.ifware.addCursorActivityListener=function(e){this.CursorActivityListeners.push(e)};d.ifware.ScrollListeners=[];d.ifware.addScrollListener=function(e){this.ScrollListeners.push(e)};d.ifware.ChangeListeners=[NISdefaultOnChange];d.ifware.addChangeListener=function(e){this.ChangeListeners.push(e)};d.ifware.KeyListeners=[];d.ifware.addKeyEventListener=function(e){this.KeyListeners.push(e)};$(window).keydown(function(e){NISonBodyKeyDown(e,
d)});ifware.project={};ifware.project.storage=ifware.LocalStorage(b.ChannelGuid);d.ifware.projectSettings=ifware.initializeProjectSettings(ifware.project.storage);NISupdateEmptyTreenodeDisplayStyle(d);d.ifware.Parent=a;d.ifware.MainLuaFile="main";NISsetScriptName(d,b.ScriptName);d.ifware.LuaFileSourceHash=b.SourceHash;d.ifware.EditorGuid=b.EditorGuid;d.ifware.ChannelGuid=b.ChannelGuid;d.ifware.UsesParameter=b.UsesParameter;d.ifware.UsesHttpsParameter=b.UsesHttpsParameter;b.UsesParameter&&NISsetSampleData(d,
b.CountOfSample,b.SampleDataIndex);d.ifware.User=c;d.ifware.ModuleStates={};d.ifware.CurrentDirtyLine=null;PRJinitProjectManager(b.file_info,d,$("#EDTprojectManager"));d.ifware.focusLastFocussedElement=$empty;return d}var NISresizeDelay=function(){return function(a,b,c){clearTimeout(0);timer=setTimeout(a,b,c)}}();function NISdoThumbnailResize(a){if(!(null==a||null==a.ifware)){NISrefreshBlockInfo2(a,a.ifware.AnnotationBlockDataSet);ETHscrollerControl.resize(a)}}
function NIScreateEditor(a,b,c){var d={ChannelGuid:PAGgetField(c,"ChannelGuid")};d.FileName=PAGgetOptionalField(c,"Module");Ajax.post("/init_editor",d,function(e){console.log("Response to /init_editor follows.");console.log(e);$("body:first div.EDTloading:first").remove();if(e.ErrorMessage)MPRapp.renderError(e.ErrorMessage,c);else{if(c.SDIndex!=0&&c.SDIndex!=e.SampleDataIndex)e.SampleDataIndex=c.SDIndex;var f=NIScreateEditorWithContent(a,e,c.User);ETHscrollerControl.show(f);window.onresize=function(){NISresizeDelay(NISdoThumbnailResize,
500,f);DCKdockController.resize();EDTonResize()};window.onfocus=function(){NIScheckIfFileModified(f)};typeof b!="undefined"&&b(f,c);NISonEditorInit(f)}},"json")}function NISgetEditorScollArea(){return $("#EDTeditor .CodeMirror-scroll > div:first")}var NISgetLineTop=function(){var a=null;return function(b,c){if(!a){a=$(NISgetEditorScollArea()).offset().top;setTimeout(function(){a=null},0)}return b.charCoords({line:c,ch:0}).y-a+1}}();
function NISgetLineLeft(){return $("#EDTeditor .CodeMirror-gutter").outerWidth()+4}function NISeditorIsEmpty(a){return a.lineCount()==0}function NIScharWidth(a){var b=$("#EDTeditor .CodeMirror-lines");console.assert(!NISeditorIsEmpty(a));a=$("<span id='width_test'>Test</span>");b.append(a);a=a.get(0).offsetWidth/4;b.find("#width_test").remove();return a}var NIScharHeight=function(){var a=null;return function(){a||(a=$("#EDTeditor .CodeMirror-lines > div > div > pre:first").outerHeight());return a}}();
function NISgetEditorScrollTop(){return $("#EDTeditor .CodeMirror-scroll").get(0).scrollTop}function NISgetEditorScrollLeft(){return $("#EDTeditor .CodeMirror-scroll").get(0).scrollLeft}function NISsetEditorScrollPosition(a,b){$("#EDTeditor .CodeMirror-scroll").get(0).scrollTop=a;$("#EDTeditor .CodeMirror-scroll").get(0).scrollLeft=b}function NISsetEditorScrollTop(a){$("#EDTeditor .CodeMirror-scroll").get(0).scrollTop=a}
function NISsetEditorScrollLeft(a){$("#EDTeditor .CodeMirror-scroll").get(0).scrollLeft=a}function NISscrollToLine(a,b){var c=NISgetLineTop(a,b);NISsetEditorScrollTop(c-NISeditorHeight()/2)}function NISeditorHeight(){return $("#EDTeditor .CodeMirror-scroll")[0].clientHeight}function NISeditorWidth(){return $("#EDTeditor .CodeMirror-scroll")[0].clientWidth}function NISeditorInnerWidth(){return NISgetEditorScollArea()[0].clientWidth}
function NISeditorScrollHeight(){return $("#EDTeditor .CodeMirror-scroll")[0].scrollHeight}function NISeditorScrollWidth(){return $("#EDTeditor .CodeMirror-scroll")[0].scrollWidth}function NISclearAnnotations(){$("div.ANNblock").remove()}
function NISsetButtonVisibility(a,b){Images=a.find("img");Images.each(function(){var c=$(this).attr("src"),d=c.indexOf("/")>=0?c.lastIndexOf("/"):0,e=b?"dis":"ena";if(c.substr(e.length,3)!=e){c=c.substr(0,d+1)+e+c.slice(d+e.length+1,c.length);$(this).attr("src",c)}})}function NISclearErrors(a){if(a.ifware.ErrorLine!==undefined)for(var b=a.lineCount(),c=0;c<b;c++)a.setLineClass(c,null);a.ifware.ErrorLine=undefined;$(".error-close,.error-box").remove()}
function NISclearErrorBox(){$(".error-box").remove()}function NISmarkLineAsDirty(a,b){a.ifware.CurrentDirtyLine=b;a.setMarker(b,null,"dirty");NISmarkAnnotationAsStale(a,b)}function NISmarkLineAsClean(a,b){a.setMarker(b,null,"")}
function NIShighlightLine(a,b){if(b!==a.ifware.ErrorLine){a.setLineClass(b,"ANNhighline");$(".ANNhighline").stop(true,true).removeAttr("style");setTimeout(function(){a.setLineClass(b,"ANNhighlineFading");$(".ANNhighlineFading").stop(true,true).css("background-color","#B5EAAA").animate({"background-color":"#FFFFFF"},"slow",function(){a.setLineClass(b,null)})},1E3)}}
function NISprepareLuaPostInfo(a,b,c){if(c)b.Code=a.getValue();b.FileName=a.ifware.CurrentFileName;b.EditorGuid=a.ifware.EditorGuid;b.ChannelGuid=a.ifware.ChannelGuid;b.SampleDataIndex=a.ifware.CurrentSampleData}function NISsetSampleData(a,b,c){a.ifware.CountOfSampleData=b;if(c){c=parseInt(c);if(c>0&&c<=b){a.ifware.CurrentSampleData=c;return}}a.ifware.CurrentSampleData=1}function NISlogWithTime(a){var b=new Date;console.log(b.getSeconds(),b.getMilliseconds(),a)}
function NISreloadCurrentFile(a){NISswitchFile(a,{},a.ifware.CurrentFileName)}
function NISswitchFile(a,b,c,d){console.log("Switching file.");console.log(b);console.log(c);NISclearErrors(a);var e={};NISprepareLuaPostInfo(a,e,b.SendCode);e.SourceHash=a.ifware.LuaFileSourceHash;e.NewFile=c;if(b.ExplicitOverwrite)e.ExplicitOverwrite=true;Ajax.post("/annotation_switch_file",e,function(f){NISclearAnnotations(a);if(f.ErrorMessage){d&&d.dialog("close");PAGwarning("Could not switch to "+c+".\n"+f.ErrorMessage);PAGcurrentModule!=NISgetScriptName(a)&&NISgoToFile(NISgetScriptName(a))}else if(f.FileModified)NISshowFileModifiedDialog(f,
a);else{NISsetScriptName(a,f.NewFile);PRJrefreshProjectManager(f.file_info,a);NISsetCode(a,f.Code,f.LastEditorGuid,f.Type);NISupdateAnnotations(a);d&&d.dialog("close")}},"json")}function NISgetFullArgumentRequests(a){var b=[];DCKdockController.getFullArgumentRequests(b);POPdialogsController.getFullArgumentRequests(b);if(b.length)a.FullArgumentRequests=$.toJSON(b)}
var NISupdateAnnotations=function(){var a=ScriptRunner();return function(b,c){c||(c={});NISlogWithTime("NISupdateAnnotations");NISclearErrors(b);var d={};NISprepareLuaPostInfo(b,d,c.SendCode);if(b.ifware.projectSettings.disableAutoScriptExecution()&&!c.force){b.ifware.AnnotationsStatusContainer.innerHTML="";d.Disabled=true;NISclearAnnotations(b)}else{b.ifware.AnnotationsStatusContainer.innerHTML='<img src="/js/mapper/images/spinner.gif" />';DCKdockController.beforeRefresh();POPdialogsController.beforeRefresh()}if(c.SendCode)d.SourceHash=
b.ifware.LuaFileSourceHash;if(c.ExplicitOverwrite)d.ExplicitOverwrite=true;if(b.ifware.RequestFunctionBlock){d.FunctionBlock=b.ifware.RequestFunctionBlock;b.ifware.RequestFunctionBlock=undefined}NISlogWithTime("Sending annotation request.");NISgetFullArgumentRequests(d);console.log("Values",d);a.post("/annotation_info2",d,function(e,f,g){NISprocessAnnotation2(e,f,g,b,c.FirstRequest)},function(){b.ifware.AnnotationsStatusContainer.innerHTML="Cancelled."})}}(),NISscheduleAnnotationsUpdate,AnnotationsUpdated;
NISscheduleAnnotationsUpdate=function(a,b){AnnotationsUpdated=false;setTimeout(function(){if(!AnnotationsUpdated){NISupdateAnnotations(a,b);AnnotationsUpdated=true}},0)};function NIScheckIfFileModified(a){if(a.ifware.LuaFileSourceHash)if(!$("#NISfileModifiedDialog:visible").size()){var b={SourceHash:a.ifware.LuaFileSourceHash,File:NISgetScriptName(a)};NISprepareLuaPostInfo(a,b,false);Ajax.post("/annotation_source_hash_check",b,function(c){c.FileModified&&NISshowFileModifiedDialog(c,a)},"json")}}
function NISshowFileModifiedDialog(a,b){$("#NISfileModifiedDialog").remove();var c={};c.Overwrite=function(){NISswitchFile(b,{SendCode:true,ExplicitOverwrite:true},a.ToFile,$(this))};c.Reload=function(){NISswitchFile(b,{},a.ToFile,$(this))};$('<div id="NISfileModifiedDialog"><p>"'+a.FromFile+"\" has been modified outside of the editor.</p>    <p>Do you want to reload the file, or overwrite it with this editor's contents?</div>").appendTo("body").dialog({title:"File Modified",width:375,modal:true,
draggable:false,resizable:false,buttons:c})}function NISshowSaveErrorDialog(a){var b={};b.Close=function(){$(this).dialog("destroy").remove()};$('<div id="NISsaveErrorDialog"><p>Could not save file.</p><p>'+a.ErrorMessage+"</p></div>").appendTo("body").dialog({title:"Save Error",width:375,modal:true,draggable:false,resizable:false,buttons:b})}function NISsetScriptName(a,b){console.log("Script:",b);a.ifware.CurrentFileName=b}
function NISgoToFile(a){var b=location.href;b=b.replace(/&Module=[^&]*/g,"");location.href=b+"&Module="+escape(a)}function NIScurrentModuleState(a){var b=a.ifware.ModuleStates[a.ifware.CurrentFileName];if(!b){b={};b.CursorPosition={line:0,ch:0};a.ifware.ModuleStates[a.ifware.CurrentFileName]=b}return b}
function NISonFileChanged(a,b){console.log("File changed:",b);if(a.ifware.CurrentFileName&&b!=a.ifware.CurrentFileName){var c=NIScurrentModuleState(a);c.ScrollTop=NISgetEditorScrollTop();c.CursorPosition=a.getCursor();c.History=a.getHistory();a.clearHistory()}NISswitchFile(a,{SendCode:a.ifware.CurrentDirtyLine!==null},b)}
function NISonSampleDataChanged(a,b){NIScloseSampleDataMiniBrowser(a,$("div.EDTsd_goto"));if(null==a.ifware)a.ifware={};if(a.ifware.CountOfSampleData!=0){if(isNaN(b))b=a.ifware.CurrentSampleData;else{b=Math.max(1,b);b=Math.min(a.ifware.CountOfSampleData,b)}if(b!=a.ifware.CurrentSampleData){a.ifware.CurrentSampleData=b;NISupdateSampleDataControl(a);NISupdateAnnotations(a)}}}function NISgetScriptName(a){return a.ifware.CurrentFileName}
function NISsetCode(a,b,c,d){a.ifware.ChangingFile=true;try{a.setValue(b);a.setOption("mode",d)}finally{a.ifware.ChangingFile=undefined}$(a.getGutterElement()).find("pre.dirty").removeClass("dirty");b=NIScurrentModuleState(a);c==a.ifware.EditorGuid&&b.History?a.setHistory(b.History):a.clearHistory();a.setCursor(b.CursorPosition||{line:0,ch:0});NISsetEditorScrollTop(b.ScrollTop||0);a.focus()}
function NISsave(a,b){if(a.ifware.CurrentDirtyLine!==null){NIScleanDirtyLine(a);NISupdateAnnotations(a,{SendCode:true})}Ajax.post("/annotation_save_program",{ChannelGuid:a.ifware.ChannelGuid,EditorGuid:a.ifware.EditorGuid},function(c){if(c.ErrorMessage&&c.ErrorType=="Save"){NISshowSaveErrorDialog(c);a.ifware.AnnotationsStatusContainer.innerHTML="Save error"}else if(c.ErrorMessage)a.ifware.AnnotationsStatusContainer.innerHTML=c.ErrorMessage;else b&&b(a)},"json")}
function NIScleanDirtyLine(a){if(a.ifware.CurrentDirtyLine!==null){NISmarkLineAsClean(a,a.ifware.CurrentDirtyLine);a.ifware.CurrentDirtyLine=null}}function NISisWhitespace(a){return a.match(/^\s*$/)!=null}function NISshouldMarkCursorLineAsDirty(a,b,c){if(!NISisWhitespace(a.getLine(c))&&b.text.length==1)if(b.to.line==c&&b.from.line==c)return true;else if(b.text[0]!=""&&c>=b.from.line&&c<=b.to.line)return true;return false}
function NISdefaultOnChange(a,b){a.ifware.CurrentDirtyLine!==null&&NIScleanDirtyLine(a);$(".error-box").hasClass("moved")||NISclearErrorBox();if(!a.ifware.ChangingFile){var c=a.getCursor().line;if(NISshouldMarkCursorLineAsDirty(a,b,c))NISmarkLineAsDirty(a,c);else{NISretrieveCodeBlockData(a);NISretrieveMergeConflictData(a);NISscheduleAnnotationsUpdate(a,{SendCode:true})}}}var NISonBodyKeyDown,NIS_IS_MAC=navigator.appVersion.indexOf("Mac")!=-1;
NISonBodyKeyDown=function(a,b){if((window.event?event.keyCode:a.keyCode)==70&&(!NIS_IS_MAC&&a.ctrlKey||NIS_IS_MAC&&a.metaKey&&!a.ctrlKey)){a.preventDefault();b.ifware.SearchBox.focus();a.preventDefault()}};function NISdefaultOnCursorMove(a){var b=a.getCursor().line;if(a.ifware.CurrentDirtyLine!==null&&b!==a.ifware.CurrentDirtyLine){NIScleanDirtyLine(a);NISscheduleAnnotationsUpdate(a,{SendCode:true})}$("#EDTeditor > .CodeMirror-focused").size()&&NISmarkCurrentLine(a,b)}
function NISonEditorFocus(a){NISmarkCurrentLine(a);a.ifware.focusLastFocussedElement=a.focus}function NISmarkCurrentLine(a,b){if(!b){a.ifware.CurrentLine=undefined;b=a.getCursor().line}if(a.ifware.CurrentLine!==b){var c=NISgetEditorScollArea().find("div.ANNblock pre");c.filter(".ANNhighlight").removeClass("ANNhighlight");c.filter(".ANNline_"+(b+1)+":last").addClass("ANNhighlight");a.ifware.CurrentLine=b}}
function NISunmarkCurrentLine(){NISgetEditorScollArea().find("div.ANNblock pre.ANNhighlight").removeClass("ANNhighlight")}function NISannotateCode(a,b){if(typeof a.ifware==="undefined")a.ifware={};a.ifware.BlockInfo={};DCKdockController.init(a);POPdialogsController.init(a);NISupdateAnnotations(a,b)}
function NISupdateEmptyTreenodeDisplayStyle(a){a=a.ifware.projectSettings.showEmptyNodes()?"":"none";for(var b=document,c=0;c<b.styleSheets.length;c++){var d=b.styleSheets[c];if(d.href&&d.href.indexOf("node_treeview.css")!=-1){(d.cssRules?d.cssRules:d.rules)[0].style.display=a;break}}}function NISchangeSampleData(a,b){var c=location.href;c=c.replace(/&SDIndex=[^&]*/g,"");location.href=c+"&SDIndex="+b;a.ifware.projectSettings.disableAutoScriptExecution()&&NISmarkAllAnnotationsAsStale(a)}
function NISinitSampleDataButton(a,b,c,d){a.addClass(b?"disabled":"enabled");a.click(function(e){e.preventDefault();b||NISchangeSampleData(d,c)})}
function NISupdateSampleDataControl(a,b){b||(b=$("#sample_data_control"));var c=a.ifware.CurrentSampleData,d=a.ifware.CountOfSampleData,e=a.ifware.UsesParameter,f=a.ifware.UsesHttpsParameter;Params.TotalSd=d;Params.Index=c;Params.UsesParameter=e;Params.UsesHttpsParameter=f;Params.NewMsg=0;if(d===0)NISbuildSampleDataControlBar(b,a,Params,c,d,e,f);else{Params.Chunk=Math.floor((c-1)/50).toString();Params.MPRapp=MPRapp.type;Params.Page="SampleData";Params.Page="OpenEditor";Params.Id=Params.Index;NISbuildSampleDataControlBar(b,
a,Params,Params.Index,Params.TotalSd,Params.UsesParameter,Params.UsesHttpsParameter);Params.Page="OpenEditor"}}function NISupdateSampleMessageTooltip(a){Ajax.post("/sample_data",a,function(b){var c="Select Message";if(b.Name)c+=" (Current: "+b.Name+")";$(".button_msg").attr("title",c)},"json")}
function NISbuildSampleDataControlBar(a,b,c,d,e,f,g){c.BackToEditor=true;var j=e?BTNtoolbar("EditSampleData","Edit Message",c,"off","edit_message","Edit Message"):"";delete c.BackToEditor;a.html('<span class="label">'+(f?'<a id="sample_data_link" href="'+PAGhref("SampleData",c)+'"> Sample Data </a>':"Sample Data")+': </span><a href="" class="button_icon connected" id="msg_first" title="First Message"><span>First</span></a><a href="" class="button_icon connected" id="msg_prev" title="Previous Message"><span>Previous</span></a><a href="" class="button_msg '+
(f?"enabled":"disabled")+'" '+(f?'title="Select Message"':"")+"><span>"+(e?d+" of "+e:"None")+'</span></a><a href="" class="button_icon connected" id="msg_next" title="Next Message"><span>Next</span></a><a href="" class="button_icon connected" id="msg_last" title="Last Message"><span>Last</span></a>'+j).find("a#sample_data_link, a#edit_message").click(function(){var l=$(this).attr("href"),h=PAGparseAnchorString(location.href).Module;if(h){l=l.replace(/&Module=[^&]*/g,"&Module="+h);$(this).attr("href",
l)}}).end().find("a#msg_first").each(function(){NISinitSampleDataButton($(this),!f||d==1,1,b)}).end().find("a#msg_prev").each(function(){NISinitSampleDataButton($(this),!f||d==1,d-1,b)}).end().find("a.button_msg").click(function(l){l.preventDefault();if(f){var h=$("div.EDTsd_goto");if(h.size())NIScloseSampleDataMiniBrowser(b,h);else{h=$('      <div id="mb-parent" class="EDTsd_goto">'+(e?'<div id="goto-row">Go to <input class="EDTsd_gotoInput"><button id="goto-btn">Go</button></div>':"")+"      </div>");
$("body").append(h);window.MiniBrowser&&MiniBrowser.create({parent:$("#mb-parent"),source:PAGgetField(c,"ChannelName"),target:b.ifware.ChannelGuid,https:g,onOpen:function(){$("#goto-row").hide()},onCancel:function(){NIScloseSampleDataMiniBrowser(b,h)},onStart:function(){NIScloseSampleDataMiniBrowser(b,h)},onSuccess:function(r,w){b.ifware.CurrentSampleData=0;b.ifware.CountOfSampleData+=w;NISchangeSampleData(b,r)}});l=$(this.firstChild);var q=l.offset();h.css("left",q.left-1);h.css("top",q.top+l.outerHeight()-
1);var p=h.find("#goto-row input");p.val(b.ifware.CurrentSampleData);p.focus();p.select();var t;t=e?function(){var r=parseInt(p.val());if(isNaN(r)||r<1)r=1;else if(r>b.ifware.CountOfSampleData)r=b.ifware.CountOfSampleData;NISchangeSampleData(b,r)}:function(){NIScloseSampleDataMiniBrowser(b,h)};p.keydown(function(r){if(r.keyCode=="13")t(r);else r.keyCode=="27"&&NIScloseSampleDataMiniBrowser(b,h)});h.find("#goto-btn").click(t)}}else b.ifware.focusLastFocussedElement()}).end().find("a#msg_next").each(function(){NISinitSampleDataButton($(this),
!f||d>=e,d+1,b)}).end().find("a#msg_last").each(function(){NISinitSampleDataButton($(this),!f||d>=e,e,b)}).end().find("#msg_first, #msg_prev, #msg_next, #msg_last").click(function(){b.ifware.focusLastFocussedElement()}).end();f&&NISupdateSampleMessageTooltip(c)}function NIScloseSampleDataMiniBrowser(a,b){b.remove();a.ifware.focusLastFocussedElement()}
function NIScreateToolbar(a){var b=String(BrowserDetect.version),c=false;if("Explorer"==BrowserDetect.browser&&null!=b.match(/^8/))c=true;b='<div class="section"><span id="sample_data_control"></span></div>';b+='<div class="section">'+BTNtoolbar("","Save Milestone",{},"off","milestone","Save milestone")+BTNtoolbar("","View Saved Milestones",{},"off","revisions","View saved milestones")+'</div><div class="section" id="scriptExecutionSection"></div>          <div class="section" id="viewOptionsSection"></div>          <div id="SRHbox"></div>';
NISupdateEmptyTreenodeDisplayStyle(a);b=$(document.createElement("form")).html(b).find("#sample_data_control").each(function(){NISupdateSampleDataControl(a,$(this))}).end().find("a#revisions").click(function(d){d.preventDefault();NISsave(a,SCMviewMilestonesDlg)}).end().find("a#milestone").click(function(d){d.preventDefault();NISsave(a,SCMsaveMilestoneDlg)}).end().find("a#emptynodes").click(function(){NISupdateEmptyTreenodeDisplayStyle(a)}).end().find("#SRHbox").each(function(){a.ifware.SearchBox=
new SRHsearchField(a,$(this))}).end().find("#autocompletion, #annotations, #emptynodes, #project_pane_toggle, #thumbnail_toggle, #script_stopper").click(function(){a.ifware.focusLastFocussedElement()}).end();ifware.toolbar.sections.scriptExecutionSection(b.find("#scriptExecutionSection"),a);ifware.toolbar.sections.viewOptionsSection(b.find("#viewOptionsSection"),a);c||b.find("a#thumbnail_toggle").click(function(d){d.preventDefault();EDTtoggleThumbnail(a)});return b[0]}
function NIScreateStatusBar(a,b){b.html('<div class="an_sb">Auto-Completion: <span id="intellisense_status"></span></div><div class="an_sb an_sb_right">Annotations: <span id="annotations_status"></span></div>').find("#intellisense_status").each(function(){a.ifware.IntellisenseStatusContainer=this}).end().find("#annotations_status").each(function(){a.ifware.AnnotationsStatusContainer=this}).end()};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function NISclearAnnotationBlockData(a){for(var b={},c=a.ifware.BlockDataSet.length,d=0,e=0;e<c;++e){var f=a.ifware.BlockDataSet[e];if("annotation"!=a.ifware.BlockDataSet[e].type){b[d]=f;++d}}a.ifware.BlockDataSet=b;a.ifware.BlockDataSet.length=d}
function NISretrieveAnnotationBlockData(a,b){NISclearAnnotationBlockData(a);for(var c=b.length,d=a.ifware.BlockDataSet.length,e=0;e<c;++d,++e){var f=b[e],g={};g.t=f.t;g.c=f.c;g.w=f.w;g.s=f.scope.s;g.e=f.scope.e;g.type="annotation";a.ifware.BlockDataSet[d]=g;++a.ifware.BlockDataSet.length}a.ifware.AnnotationBlockDataSet=b}
var NISprocessAnnotation2=function(){var a=!ifware.storage.get("DisableNoSampleDataWarning");return function(b,c,d,e,f){e.ifware.AnnotationsStatusContainer.innerHTML="";if(b.ErrorMessage&&b.ErrorType=="Save"){NISshowSaveErrorDialog(b);e.ifware.AnnotationsStatusContainer.innerHTML="Save error"}else if(b.ErrorMessage)e.ifware.AnnotationsStatusContainer.innerHTML=b.ErrorMessage;else if(b.FileModified)NISshowFileModifiedDialog(b,e);else{e.ifware.AnnotationsStatusContainer.innerHTML=b.BlockData?'<span class="ok">Got data</span>':
"Disabled";console.log(b);if(!(e.getValue()||"").match(/^\s*$/))if(a&&e.ifware.CountOfSampleData==0){a=false;$('<div>               Annotations will use an empty string until you add some sample data.<br><br>               <label><input type="checkbox" id="disable-no-sample-data-warning">Don\'t remind me again.</label>            </div>').appendTo("body").dialog({title:"Warning: No Sample Data",buttons:{Close:function(){$(this).dialog("close")}},close:function(){$("#disable-no-sample-data-warning").get(0).checked&&
ifware.storage.set("DisableNoSampleDataWarning","true",365);e.focus()}})}else f&&e.focus();NISretrieveCodeBlockData(e);NISretrieveMergeConflictData(e);if(b.BlockData){NISlogWithTime("Got anotation data.");NISrefreshBlockInfo2(e,b.BlockData);NISlogWithTime("Refreshed blocks.");NISretrieveAnnotationBlockData(e,b.BlockData);NISmarkCurrentLine(e)}ETHscrollerControl.setStylizer(function(g){return NISretrieveBlockStyle(g)});ETHscrollerControl.setMaxLineLengthCalculator(function(g,j){return NISmaxLineOfCodeLength(g,
j)});ETHscrollerControl.setOptimalBlockWidthCalculator(function(g,j,l,h){return NISoptimalBlockWidth(g,j,l,h)});ETHscrollerControl.show(e);if(b.ScriptError&&!$("#importProjectAndData:visible").size()){if(!b.ScriptError.Description.length)b.ScriptError.Description=" ";NISdisplayScriptError(e,b.ScriptError)}if(e.ifware.scrollToLine){e.ifware.scrollToLine();e.ifware.scrollToLine=undefined}PRJrefreshProjectManager(b.file_info,e);e.ifware.SearchBox.updateSearchMatches();DCKdockController.refresh(b.FullArgumentResponses,
b.ScriptError);POPdialogsController.refresh(b.FullArgumentResponses,b.ScriptError)}}}();
function NISrefreshBlockInfo2(a,b){var c=a.ifware.CharWidth=NIScharWidth(a),d={},e;Blocks=a.ifware.BlockInfo;if(NISeditorIsEmpty(a)||!b)NISclearAnnotations(a);else{for(e=0;e<b.length;e++)d[b[e].scope.s]=e;NISlogWithTime("Set up new block table");for(e in Blocks)if(typeof d[e]=="undefined"){delete Blocks[e];$("#EDTeditor .CodeMirror #n"+e).remove()}NISlogWithTime("Removed blocks that no longer exist.");var f=NISgetLineLeft(),g=NISgetEditorScollArea();for(e in d){if(typeof Blocks[e]=="undefined")Blocks[e]=
{count:b[d[e]].scope.l};else{$("#EDTeditor .CodeMirror #n"+e).remove();Blocks[e].count=b[d[e]].scope.l}NIScreateBlock(a,c,f,b[d[e]],g)}}}function NISsetButtonVisibility(a,b){Images=a.find("img");Images.each(function(){var c=$(this).attr("src"),d=c.indexOf("/")>=0?c.lastIndexOf("/"):0,e=b?"dis":"ena";if(c.substr(e.length,3)!=e){c=c.substr(0,d+1)+e+c.slice(d+e.length+1,c.length);$(this).attr("src",c)}})}
function NISsetAllButtonVisibility(a,b){NISsetButtonVisibility(a.find("span.ncback"),b.p==1);NISsetButtonVisibility(a.find("span.ncforw"),b.p==b.l)}
function NIScontrolBlock2(a){return"<div class='annav'><span class='nv ncback'><img class='bb' src='/js/mapper/images/ena_l_stop_arrow.png'/><img class='b' src='/js/mapper/images/ena_l_arrow.png'/></span><span class='inner'><span style='white-space: pre' class='position'>"+a.p+"</span> of "+a.l+"</span><span class='nv ncforw'><img class='f' src='/js/mapper/images/ena_r_arrow.png'/><img class='ff' src='/js/mapper/images/ena_r_stop_arrow.png'/></span></span></div>"}
function NIShideNavControl(a){a=$(a).find(".annav:first");a.removeClass("hover");a=a.find(".nv");$.support.opacity?a.stop(true,true).fadeTo("fast",0):a.css("visibility","hidden")}function NISshowNavControl(a){a=$(a).find(".annav:first");a.addClass("hover");a=a.find(".nv");$.support.opacity?a.stop(true,true).fadeTo("fast",1):a.css("visibility","")}
function NISshowPopupOrDockTab(a,b,c,d){c=true;if(DCKdockController.tabExists(b)){c=false;DCKdockController.selectTab(b,true)}else if(POPdialogsController.dialogExists(b))POPdialogsController.bringToFrontAndHighlightDialog(b);else{if(COOKIEread("isdockable")!="true")POPdialogsController.dialog(b);else{c=false;DCKdockController.tab(b);DCKdockController.selectTab(b)}if(!d)if(a.ifware.projectSettings.disableAutoScriptExecution()){var e=null;ITMgetItems($("body")).each(function(){var f=$(this);if(f.data("Id")===
b){e=f;return false}});if(e!==null)c?POPdialogsController.setAnnotationToDefaultForAutoScriptExecutionDisabled(e):DCKdockController.setAnnotationToDefaultForAutoScriptExecutionDisabled(e)}else NISupdateAnnotations(a)}if(d){c?POPdialogsController.setHelpContent(b,d):DCKdockController.setHelpContent(b,d);prettyPrint()}a.ifware.focusLastFocussedElement()}function NISlongStringOnClick(a,b){NISshowPopupOrDockTab(a,b.id,b)}
function NIStreeviewOnClick(a,b,c){a.preventDefault();NISshowPopupOrDockTab(b,c.id,c)}function NISchangeFunctionIteration(a,b,c,d){var e=a.ifware.AnnotationBlockDataSet;a=null;for(var f=0;f<e.length;f++)if(e[f].scope.s==b){a=e[f];break}if(a&&a.scope&&a.scope.p!=c){c=Math.min(a.scope.l,c);b=$("#n"+b);NISchangeCurrentIteration(b,a.scope,c,d)}}
function NISjumpToFunctionCall(a,b,c,d,e,f){if(b===a.ifware.CurrentFileName){NISscrollToLine(a,e);NISsetEditorScrollLeft(0);NIShighlightLine(a,e);NISchangeFunctionIteration(a,c,d,f)}else if(b){a.ifware.scrollToLine=function(){NISscrollToLine(a,e);NISsetEditorScrollLeft(0);NIShighlightLine(a,e)};a.ifware.RequestFunctionBlock=c+":"+d;if(f)a.ifware.RequestFunctionBlock+=":"+f;NISgoToFile(b)}else PAGwarning("Source not available for this function.")}
function NISonFunctionCallClick(a,b,c){a.preventDefault();a=$(c).find("div").text().split(":");c=a[0];var d=parseInt(a[1]),e=parseInt(a[2]),f=parseInt(a[3])-1;NISjumpToFunctionCall(b,c,d,e,f,a.length>4?a[4]:undefined)}function NISonFunctionCallEnter(a,b){var c,d=$(b);c=d.hasClass("fcin")?'<img src="/js/mapper/images/step_in.png" />':'<img src="/js/mapper/images/step_out.png" />';var e=d.position();$(c).appendTo(d).css("top",e.top+"px").css("left",e.left-18+"px").css("border","none").show()}
function NISonFunctionCallLeave(a,b){$(b).find("img").stop(true,true).remove()}function NISupdateAnnBlock(a,b,c){console.log(a);if(a.ErrorMessage)b.find("span.content").html(a.ErrorMessage);else{NISpopulateBlock(a,b,c,true);b=c.ifware.AnnotationBlockDataSet;for(c=0;c<b.length;c++)if(b[c].scope.s==a.scope.s){b[c]=a;break}}}function NISchangeCurrentIteration(a,b,c,d){if(!(c==b.p&&!d)){b.c=[];b.p=c;a.closest("div.ANNblock").trigger("scopeiterationchange",{TargetCallee:d,Container:a,Scope:b})}}
function NISattachNavClick(a,b,c){b.find("span.inner").click(function(){NISinsertGotoIframe2($(this),b,c,a)}).end().find("img.bb").click(function(){NISchangeCurrentIteration(a,c,1)}).end().find("img.b").click(function(){NISchangeCurrentIteration(a,c,Math.max(1,c.p-1))}).end().find("img.f").click(function(){NISchangeCurrentIteration(a,c,Math.min(c.l,c.p+1))}).end().find("img.ff").click(function(){NISchangeCurrentIteration(a,c,c.l)}).end()}
function NIScreateBlock(a,b,c,d,e){var f=$("<div></div>");f.attr("id","n"+d.scope.s);f.addClass("ANNblock");f.css("position","absolute");var g=NISgetLineTop(a,d.scope.s-1);f.css("top",g+"px");f.css("left",b*(d.c+2)+c+"px");f.find(".topRightHoverMenu").css("visibility","hidden");f.hover(function(){f.find(".topRightHoverMenu").css("visibility","visible")},function(){f.find(".topRightHoverMenu").css("visibility","hidden")});f.find("a").click(function(j){j.preventDefault();NISclearAnnotations(a)}).hover(function(){$(this).addClass("ui-state-hover")},
function(){$(this).removeClass("ui-state-hover")});e.append(f);NISpopulateBlock(d,f,a);f.innerWidth()<102&&f.css("width","102px");f.mousedown(function(j){j.stopPropagation()})}
function NISpopulateBlock(a,b,c,d){if(a.scope.l>1){b.css("width","");b.html('<span class="content">'+a.scope.d+"</span>"+NIScontrolBlock2(a.scope)).children().andSelf().hover(function(){NISshowNavControl(this)},function(){NIShideNavControl(this)});NISsetAllButtonVisibility(b.find("div.annav"),a.scope);if(!d){d=b.find(".nv");$.support.opacity?d.fadeTo(0,0):d.css("visibility","hidden")}NISattachNavClick(b,b.find("div.annav"),a.scope)}else{b.children().not(".topRightHoverMenu").remove();b.append(a.scope.d)}b.unbind("scopeiterationchange").bind("scopeiterationchange",
{Container:b,Scope:a.scope,Editor:c},NISonScopeIterationChange);d=NIScreateLoopBlocks(b,a.scope,NIScharHeight(),c)+30;b.innerWidth()<d&&b.width(d);b.find("span.pv").click(function(){NISlongStringOnClick(c,this)});b.find("a.ntv").click(function(e){NIStreeviewOnClick(e,c,this);return false});b.find("a.fc, a.fr").mouseenter(function(){NISonFunctionCallEnter(c,this)}).mouseleave(function(){NISonFunctionCallLeave(c,this)}).click(function(e){NISonFunctionCallClick(e,c,this)});a.w=b.outerWidth()}
function NISbuildIterationTree(a){for(var b={i:a.p,c:[]},c=a.c.length,d=0;d<c;d++)b.c[d]=NISbuildIterationTree(a.c[d]);return b}
function NISonScopeIterationChange(a,b){var c=b.TargetCallee,d=a.data.Container,e=a.data.Scope,f=a.data.Editor,g={};g.ChannelGuid=f.ifware.ChannelGuid;g.FunctionLine=e.s;if(c)g.TargetCallAndCallee=e.p+":"+c;else{c=JSON&&JSON.stringify?JSON.stringify:$.toJSON;e=NISbuildIterationTree(e);g.IterationTree=c(e)}if(f.ifware.projectSettings.disableAutoScriptExecution()){e=b.Scope;c=b.Container;var j=c.find(".content");if(j.length>0){j.html('<pre>To display results <button class="iterationChange">Execute Script Now</button></pre>');
c.find(".ANNloopBlock").remove()}else{c.children().not(c.find(".annav:first").parent()).remove();c.append('<pre>To display results <button class="iterationChange">Execute Script Now</button></pre>')}c=c.find(".annav:first");c.find("span.position").html(e.p);NISsetAllButtonVisibility(c,e);$(".iterationChange").click(function(){ScriptRunner().post("/annotation_get_block",g,function(l){NISupdateAnnBlock(l,d,f)},function(){NISupdateAnnBlock({ErrorMessage:"Script cancelled."},d,f)})})}else ScriptRunner().post("/annotation_get_block",
g,function(l){NISupdateAnnBlock(l,d,f)},function(){NISupdateAnnBlock({ErrorMessage:"Script cancelled."},d,f)})}function NIScreateLoopBlocks(a,b,c,d){for(var e=b.c.length,f=0,g=0;g<e;g++){var j=NIScreateLoopBlock(a,b.c[g],b.s,c,d);if(j>f)f=j}return f}
function NIScreateLoopBlock(a,b,c,d,e){if(b.l!=0){a=$('<div class="ANNloopBlock" />').appendTo(a);a.css("top",(b.s-c)*d+"px");a.html(b.d);c=$(NIScontrolBlock2(b)).prependTo(a.find("pre:first"));NISsetAllButtonVisibility(c,b);NISattachNavClick(a,c,b);c.outerWidth();c=c.find(".nv");$.support.opacity?c.fadeTo(0,0):c.css("visibility","hidden");a.hover(function(){NISshowNavControl(this)},function(){NIShideNavControl(this)});b=NIScreateLoopBlocks(a,b,d,e)+30;a.innerWidth()<b&&a.width(b);return a.outerWidth()}}
function NISlineLength(a,b){return a.getLine(b).length}function NISmarkAnnotationAsStale(a,b){for(var c=a.ifware.Editor=NIScharWidth(a),d=b+1,e=0;e<a.ifware.AnnotationBlockDataSet.length;e++){var f=a.ifware.AnnotationBlockDataSet[e];if(d>=f.scope.s&&d<=f.scope.e){var g=a.getLine(b);g=c*(Math.max(f.c,g.length)+2)+NISgetLineLeft();$("#n"+f.scope.s).css("left",g+"px").fadeTo(125,0.6)}else if(f.scope.s>d)break}}
function NISmarkAllAnnotationsAsStale(){$("div.ANNblock").each(function(a,b){$(b).fadeTo(125,0.6)})}function NISerrorText(a){return a.FileName!=""?"Error in "+a.FileName+" on line "+a.LineNumber:"Error  on line "+a.LineNumber}function NISjumpToStackFrame(a,b){NISjumpToFunctionCall(a,b.f,b.s,b.c,b.l-1,b.t)}
function NISdisplayErrorStackTrace(a){$("#error_stack_container").size()||("true"==COOKIEread("isdockable")?DCKdockController.errorStackTab(a,true):POPdialogsController.errorStackDialog(a,true))}function NISfindErrorStackFrame(a){var b=a.CallStack;if(b)for(var c=b.length-1;c>=0;c--){var d=b[c];if(d.f==a.FileName&&d.l==a.LineNumber)return d}return null}
function NISdisplayScriptError(a,b){function c(){var h=NISfindErrorStackFrame(b);h?NISjumpToStackFrame(a,h):NISscrollToLine(a,e);NISshowErrorBox(a,e,b);ETHscrollerControl.showError(a,b,j)}var d=a.ifware.CharWidth=NIScharWidth(a);console.log("Script error:",b);if(!b.LineNumber)b.LineNumber=1;var e=b.LineNumber-1;$(a.ifware.AnnotationsStatusContainer).html('<a href="" class="el">'+NISerrorText(b)+"</a>"+(b.CallStack?'<a href="" class="ANNest_link">[Show Stack Trace]</a>':"")).find("a.el").click(function(h){h.preventDefault();
if(f)c();else{a.ifware.scrollToLine=c;NISgoToFile(b.FileName)}}).end().find("a.ANNest_link").click(function(h){h.preventDefault();NISdisplayErrorStackTrace(b)});var f=a.ifware.CurrentFileName===b.FileName&&b.FileName!=="";if(f){var g=NISfindErrorStackFrame(b);g&&NISchangeFunctionIteration(a,g.s,g.c,g.t);a.setLineClass(e,"error-highlight-row");a.ifware.ErrorLine=e;NISshowErrorBox(a,e,b);g=NISgetLineLeft();var j=a.getLine(e).length,l={};l.Description=NIStruncateErrorMessage(a,b.Description,d*(j+2)+
g);l.LineNumber=b.LineNumber;ETHscrollerControl.showError(a,l,j)}}
function NIStruncateErrorMessage(a,b,c){a=a.ifware.CharWidth=NIScharWidth(a);c=(NISeditorInnerWidth()+NISgetEditorScrollLeft()-c-70)/a;a="";for(var d=true,e=0;e<3&&d;e++){var f=b.search(/[\r\n]/),g=f;if(g==-1){g=b.length;d=false}var j=Math.max(48,c);a+=g>j?PAGhtmlEscape(b.substring(0,j))+"&hellip;":PAGhtmlEscape(b.substring(0,g));if(d){if(g>0)a+="\n";else e--;f=b.substring(f,f+2)=="\r\n"?f+2:f+1;b=b.substring(f)}}if(d)a+="&hellip;";return a}
function NISshowErrorBox(a,b,c){var d=a.ifware.CharWidth=NIScharWidth(a);if(!$("div.error-box").size()){var e=NISgetLineTop(a,b)-2,f=NISgetLineLeft(),g=NISlineLength(a,b);b=d*(g+2)+f;var j=$('<div class="error-box collapsed"><div class="error-toolbar"><span>ERROR (<a href="" title="Dismiss this error. Note that you need not explicitly dismiss each error; you may simply continue typing.">Dismiss</a>)</span><div class="error-buttons">'+(c.CallStack?'<img class="error-stack" src="/js/mapper/images/call_stack_button.gif" title="Show Stack Trace" />':
"")+'<img class="error-expand" src="/js/mapper/images/maximize_button_red.gif" title="Expand" /><img class="error-collapse" src="/js/mapper/images/minimize_button_red.gif" title="Collapse" /><img class="error-close" src="/js/mapper/images/close_button_red.gif" title="Close" /></div></div><div class="error-message"></div></div>');j.css("top",e+"px").css("left",b+"px");var l=NIStruncateErrorMessage(a,c.Description,b);j.attr("title","Expand/move this Message");j.find("img.error-stack").click(function(){NISdisplayErrorStackTrace(c)}).mousedown(function(h){h.stopPropagation()});
j.find("img.error-collapse").click(function(){j.removeClass("expanded");j.addClass("collapsed");j.attr("title","Expand/move this Message");j.find(".error-message").html(l);ETHscrollerControl.showError(a,c,g)});j.find("img.error-close, a").click(function(h){h.preventDefault();$(j).fadeOut("fast",function(){NISclearErrorBox()});ETHscrollerControl.clearError()}).mousedown(function(h){h.stopPropagation()});j.find("div.error-message").html(l).mousedown(function(h){j.hasClass("expanded")&&h.stopPropagation()});
NISgetEditorScollArea().append(j);j.draggable({stop:function(){j.addClass("moved");ETHscrollerControl.clearError();var h={};h.Description=c.Description;var q=$("#EDTeditor .CodeMirror-lines");q=q.children("div").offset().top-q.offset().top;h.LineNumber=Math.ceil(($(this).position().top-q)/NIScharHeight()+1);q=Math.ceil($(this).position().left/d-7);ETHscrollerControl.showError(a,h,q)}}).mousedown(function(h){h.stopPropagation();h.preventDefault();if(j.hasClass("collapsed")){j.removeClass("collapsed");
j.addClass("expanded");j.removeAttr("title");j.find(".error-message").hide().text(c.Description).fadeIn("fast");ETHscrollerControl.showError(a,c,g)}})}}
function NISinsertGotoIframe2(a,b,c){b=a.find(".position").get(0).innerHTML;var d=a.parent().width()+6,e=a.parent().height(),f="iframe"+c.s,g,j=$("#"+c.s).find("iframe"),l;if(l=j.length===0?NIScreateIframe(f,d,e,a.get(0).parentNode):j.get(0)){if(l.contentDocument)g=l.contentDocument;else if(l.contentWindow)g=l.contentWindow.document;else if(window.frames[l.name])g=window.frames[l.name].document;if(g){g.open();g.write('<html><body style="overflow: hidden; border: 1px solid #cccccc; -moz-border-radius:0 0 5px 5px; -webkit-border-radius:0 0 5px 5px; background: transparent url(/js/mapper/images/toolbar/bg_button_span.gif) no-repeat -5px -1px; font: normal 9px Lucida Sans, sans-serif; margin: 0px; padding: 0px;"><span style="padding: 0px 3px 0px 6px;">Go to </span><input id="input_field" style="width:20px; font-size: 9px; padding:1px 0px 0px 0px; margin:1px 5px 0px 0px; border:1px solid #CCCCCC;" type="text" value="'+
b+'" /><img src="/js/mapper/images/ok.png" style="position:absolute; cursor:pointer;"/></body></html>');g.close()}var h=$(g).find("#input_field");$(l).show();h.focus();h.select();var q=function(){var t=parseInt(h.get(0).value,10);if(!isNaN(t)){if(t<0)t=1;if(t>c.l)t=c.l;NISchangeCurrentIteration(a.closest("div.ANNblock"),c,t)}setTimeout(function(){$(l).remove()},100)},p=function(){setTimeout(function(){$(l).remove()},100)};h.blur(q);h.keydown(function(t){if(t.keyCode=="13")q();else t.keyCode=="27"&&
p()})}};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function BTRview(a){if(!a.Chunk&&!a.Index)a.Chunk=0;Ajax.post("/bulk_testing_results",a,function(b){BTRrenderResultsView(b,a)},"json")}function BTRresultRow(a,b,c){c.Id=a.Id;c.TotalSd=b;return'<tr><td class="BTRsd">'+PAGlink("EditSampleData",c,a.Index+1)+'<td class="BTRreason"><div>'+(a.ErrorMessage?'<span class="BTRerrorMessage">'+a.ErrorMessage+"</span>":"Main function returned false.")+"<td>"+PAGlink("OpenEditor",MAPretrieveParams("lua_editor",c),"View in Script...")}
function BTRbutton(a,b,c,d){return d?PAGlink(a,c,b):'<a class="BTRdisabled">'+b+"</a>"}
function BTRrenderResultsView(a,b){function c(){p.fadeTo("fast",0.5);p.append('<div class="BTRnavPaneBlocker"><img src="/js/mapper/images/spinner_wide.gif" /></div>');p.find("div.BTRnavPaneBlocker img").fadeIn("slow")}if(a.ErrorMessage)MPRapp.renderError(a.ErrorMessage,b);else{var d=a.ChannelGuid,e=MAPretrieveHeaderHTML("bulk_tests",b),f=a.Chunk,g=a.CountOfChunk-1,j=a.CountOfResult+" Failures";if(a.CountOfResult)j=a.ChunkBegin+1+" to "+(a.ChunkEnd+1)+" of "+j;e+='<div class="content_main">';b.Chunk=
0;var l=BTRbutton("BulkTestResults","&lt;&lt;",b,f>0);b.Chunk=Math.max(0,f-1);var h=BTRbutton("BulkTestResults","&lt;",b,f>0);b.Chunk=Math.min(g,f+1);var q=BTRbutton("BulkTestResults","&gt;",b,f<g);b.Chunk=g;f=BTRbutton("BulkTestResults","&gt;&gt;",b,f<g);delete b.Chunk;e+='<div class="BTRnavPane">';e+=BTNwrapper(l+h+'<span class="SPDnavText">'+j+"</span>"+q+f)+"</div>";e+='<div class="BTRdataTable"><table id="bulk_test_results_table" class="BTRdataTable"><tr><th>Sample Data<th class="BTRreason">Reason<th>Script';
j=a.Results.length;l=a.ScriptName;for(h=0;h<j;h++)e+=BTRresultRow(a.Results[h],a.TotalSd,b,l);e+="</table></div></div>";$("body").html(e);var p=$("div.BTRnavPane");p.find("a").click(function(){this.href!=""&&c()});a.CountOfResult&&p.find("span.BTRnavText").click(function(){var t=$("div.BTRgoto");if(t.size())t.remove();else{t=$('<div class="BTRgoto">Go to <input type="text" class="BTRgotoInput" /><img src="/js/mapper/images/ok.png" /></div>');$("body").append(t);var r=p.offset();t.css("left",r.left+
(p.outerWidth()-t.outerWidth())/2);t.css("top",r.top+p.outerHeight());var w=t.find("input");w.val(a.ChunkBegin+1);w.focus();w.select();var z=function(){var y=parseInt(w.val());if(isNaN(y)||NewSd<1)y=1;else if(y>a.CountOfMessage)y=a.CountOfMessage;y--;if(a.Index!=y){window.location=PAGhref("BulkTestResult",{ChannelGuid:d,Index:y});c()}t.remove()};w.keydown(function(y){if(y.keyCode=="13")z(y);else y.keyCode=="27"&&t.remove()});t.find("img").click(z)}})}};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function BTNbutton(a,b,c){return PAGlink(a,c,b)}function BTNtoolbar(a,b,c,d,e,f){return"<a href='"+(""!=a?PAGhref(a,c):"")+"' id="+e+" class='button_icon enabled "+d+"' title='"+f+"'><span>"+b+"</span></a>"}function BTNtoolbarDisabled(a,b){return"<div class='disabled' id='"+a+"' title='"+b+"'></div>"}function BTNtoolbarWithJavascript(a,b,c,d,e){return"<a href='"+a+"' id="+d+" class='button_icon enabled "+c+"' title='"+e+"'><span>"+b+"</span></a>"}
function BTNbuttonWithJavascript(a,b){return"<a href='"+a+"'>"+PAGescapeQuotes(b)+"</a>"}function BTNbuttonMinus(a,b,c){return"<a class='BTNnegative' href='"+PAGhref(a,c)+"'>"+PAGescapeQuotes(b)+"</a>"}function BTNbuttonMinusWithJavascript(a,b){return"<a class='BTNnegative' href='"+a+"'>"+PAGescapeQuotes(b)+"</a>"}function BTNbuttonPlus(a,b,c){return"<a class='BTNpositive' href='"+PAGhref(a,c)+"'>"+PAGescapeQuotes(b)+"</a>"}
function BTNbuttonPlusWithJavascript(a,b){return"<a class='BTNpositive' href='"+a+"'>"+PAGescapeQuotes(b)+"</a>"}function BTNwrapper(a){return"<div class='BTNbuttons'>"+a+"</div>"};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function COMresponseTest(a){console.log(a)}function COMcompRequest(a){var b="",c;for(c in a){b+=c;b+="=";b+=encodeURIComponent(a[c].Request);var d=a[c].Params,e;for(e in d){b+="&";b+=e;b+="=";b+=encodeURIComponent(d[e])}b+="&***=&"}return b}function COMcompositeAjax(a,b){var c="/composite?"+COMcompRequest(a);Ajax.post(c,{},b,"json")};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function DCKdock(){function a(){var o={};return o="popup"==COOKIEread(H)?$("div#popup_dock"):$("div#bottom_dock")}function b(o){return a().find("div.dock_tabs li."+o)}function c(){ITMgetItemsFromCookie(J).each(function(){var o=$(this);e(o);var n=o.data("Id");if(ITM_HELP_ID==n){var u=ITMretrieveMostRecentHelp(E);g(o,b(n),u)}l(n)&&DCKdockController.selectTab(n);ifware.Editor.ifware.projectSettings.disableAutoScriptExecution()&&DCKdockController.setAnnotationToDefaultForAutoScriptExecutionDisabled(o)});
DCKdockController.updateTabScrollButtons()}function d(o,n){setTimeout(function(){y(o,n)},0)}function e(o){var n=o.data("Id"),u=a(),m=I;if(u.is(":visible")){var s=u.find("ul.dock_tabs li:last");if(s.length){for(;!s.is(":visible");)DCKdockController.scrollForward();m=s.position().left+s.get(0).clientWidth+I}}else A();s=$("<li class='"+n+" waiting'></li>").appendTo(u.find("ul.dock_tabs"));s.addClass("visible");s.css("left",m+"px");s.css("top",M+"px");s.append("<div class='tab_content'><div><a href='' class='dock_tab_label ntv'>&nbsp;</a><a href='' id='dock_tab_close' class='dock_tab_button'><img src='/js/mapper/images/icon-close-small.png' title='Close Tab' /></a><a href='' id='dock_tab_popup' class='dock_tab_button'><img src='/js/mapper/images/popup.png' title='Pop Out' /></a></div></div>");
s.find("a#dock_tab_close").click(function(){z(n);E.ifware.focusLastFocussedElement();return false});s.find("a.dock_tab_label").html("Refreshing&hellip;");s.find("a#dock_tab_popup").unbind().click(function(){var v=o.data("Id");POPdialogsController.dialogFromExisting(o);w(v);COOKIEcreate(K,"false",ITM_COOKIE_EXPIRY);E.ifware.focusLastFocussedElement();return false});if(s.position().left+s.get(0).clientWidth>u.find("div.dock_toolbar").get(0).clientWidth-("popup"==COOKIEread(H)?50:90)){s.removeClass("visible").addClass("hidden").hide();
DCKdockController.scrollForward()}s.click(function(){$(this).hasClass("selected")||DCKdockController.selectTab(n);return false});u=$("<div class='"+n+" link_detail hidden'></div>").appendTo(u.find("div.dock_content"));u.append(o);u.bind(ITM_VIEW_MODE_CHANGE_EVENT,function(v,x){ITMupdateCookie(J,x)});return u}function f(o,n,u,m){m.removeClass("waiting");var s=m.find("a.dock_tab_label");s.removeClass("error");var v=s.attr("class");v&&s.attr("class",v.replace(/( ?)nt_\d+_\d+/,""));s.attr("style","").addClass(n).html(o.replace(/\s/g,
"&nbsp;"));m.attr("title",u)}function g(o,n,u){var m=ITM_HELP_TITLE,s=ITMsetLabelInfo(o,m,undefined,undefined,"help");f(m,s,"",n);ITMrenderStaticView(o,u);ITMstoreMostRecentHelp(E,u)}function j(o,n){ITMsetLabelInfo(n,ITM_ERROR_STACK_TITLE,undefined,undefined,"error_stack");var u=b(ITM_ERROR_STACK_ID);f(ITM_ERROR_STACK_TITLE,"error_stack","",u);ITMpopulateErrorStackTrace(E,o,n)}function l(o){var n=COOKIEread(F);return!n||n==o}function h(){var o=a().find("ul.dock_tabs li.selected");if(0!=o.length)for(var n=
0>o.position().left?DCKdockController.scrollBackward:DCKdockController.scrollForward;o.hasClass("hidden");)n()}function q(o){for(var n=a(),u=n.find("ul.dock_tabs li:visible").filter(":first").get(0).clientWidth;o.length;){o.css("left",o.position().left+u+I);o=o.prev()}n.find("ul.dock_tabs li.visible").filter(":first").prev().removeClass("hidden").addClass("visible")}function p(o){for(var n=a(),u=n.find("ul.dock_tabs li:visible").filter(":first").get(0).clientWidth;o.length;){o.css("left",o.position().left-
u-I);o=o.next()}o=n.find("ul.dock_tabs li.visible").filter(":last").position().left;n.find("ul.dock_tabs li.visible").filter(":last").next().removeClass("hidden").addClass("visible").show().css("left",o+u+I)}function t(){var o=$("div#bottom_dock:first");o.find("ul.dock_tabs li").remove();o.find("div.link_detail").remove();o.hide();$("div#EDTeditor:first").css("bottom","32px");ETHscrollerControl.resize(E);EDTonResize();E.refresh()}function r(){var o=$("div#popup_dock:first");o.find("ul.dock_tabs li").remove();
o.find("div.link_detail").remove();o.dialog("destroy")}function w(o){var n=a();ITMremoveItemFromCookie(J,o);n.find("div.dock_content div."+o).remove();o=n.find("ul.dock_tabs li."+o);var u=o.prev(),m=o.next();o.remove();if(n.find("ul.dock_tabs li").length){n.find("ul.dock_tabs li.visible").filter(":first").prev().length?q(u):p(m);if(!n.find("ul.dock_tabs li.selected").length)if(m.length)m.trigger("click");else u.length&&u.trigger("click");DCKdockController.updateTabScrollButtons()}else"popup"==COOKIEread(H)?
r():t()}function z(o){var n=a();ITMclearItemSpecificLocalData(E,o);w(o);if(!n.find("ul.dock_tabs li").length){COOKIEerase(J);COOKIEerase(F)}}function y(o,n){var u=n.data("Id");if(DCKdockController.tabExists(u)){u=b(u);if(o.ErrorMessage){var m=ITMsetLabelInfo(n,"Error",undefined,undefined,"error");f("Error",m,"",u);ITMrenderErrorView(o,n)}else if(o.Root){m=ITMsetTooltip(o,n);var s=ITMsetLabelInfo(n,o.Root.title,o.Root.pt,o.Root.nt,"error");f(o.Root.title,s,m,u);ITMrenderTreeviewView(E,o,n)}else if(o.ChunkInfo){m=
ITMsetTooltip(o,n);s=ITMsetLabelInfo(n,o.title,o.pt,o.nt,"error");f(o.title,s,m,u);ITMrenderGenericView(E,o,n)}}}function A(){if("popup"==COOKIEread(H)){var o=$("div#popup_dock"),n={beforeClose:function(){DCKdockController.close()},resize:function(){o.find("a.scroll").hide()},resizeStop:function(){DCKdockController.resize();o.find("a.scroll").show()},autoOpen:false,height:200,width:$(window).width()*0.9,minWidth:950,dialogClass:"ANNouterDockPopup"};o.attr("title","&nbsp;");o.dialog(n);o.dialog("open");
n=o.parents(".ui-dialog").find(".ui-dialog-titlebar");$('<a href="#" title="Dock to bottom" class="ui-corner-all ui-dialog-titlebar-dock"><span class="ui-icon ui-icon-arrowthick-1-sw">dock</span></a>').appendTo(n).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}).bind("click",function(u){u.preventDefault();DCKdockController.openDocked()});o.find("div.dock_tabs ul").addClass("dock_tabs");COOKIEcreate(H,"popup",ITM_COOKIE_EXPIRY)}else{$("div#bottom_dock").show();
$("div#bottom_dock div.dock_tabs").find("ul").addClass("dock_tabs");COOKIEcreate(H,"docked",ITM_COOKIE_EXPIRY);ETHscrollerControl.resize(E);EDTonResize()}DCKdockController.updateTabScrollButtons()}function B(o){o=b(o);var n=$('<div class="highlight_tab" />').appendTo(o);n.fadeOut("slow",function(){n.remove()})}function G(o){var n=ITMgetItems(a());COOKIEcreate(H,o,ITM_COOKIE_EXPIRY);n.each(function(){var u=$(this);DCKdockController.tabFromExisting(u,l(u.data("Id")))});(o=COOKIEread(F))&&DCKdockController.selectTab(o,
false);DCKdockController.updateTabScrollButtons()}var E,F,J,H="dock_view_state",K="isdockable",I=5,M=6;this.tabWidth=function(){return a().find("ul.dock_tabs li:first").get(0).clientWidth+I};this.updateTabScrollButtons=function(){var o=a(),n=o.find("a.dock_scroll_backward img");o=o.find("a.dock_scroll_forward img");if($("ul.dock_tabs li.hidden").length){n.css("visibility","visible");o.css("visibility","visible");$("ul.dock_tabs li.visible").filter(":first").prev().length?n.attr("src","/js/mapper/images/arrow-backward.png"):
n.attr("src","/js/mapper/images/arrow-backward-disabled.png");$("ul.dock_tabs li.visible").filter(":last").next().length?o.attr("src","/js/mapper/images/arrow-forward.png"):o.attr("src","/js/mapper/images/arrow-forward-disabled.png")}else{n.css("visibility","hidden");o.css("visibility","hidden")}};this.selectTab=function(o,n){COOKIEcreate(F,o,ITM_COOKIE_EXPIRY);var u=a();u.find("ul.dock_tabs li").removeClass("selected");u.find("ul.dock_tabs li."+o).addClass("selected");u.find("div.dock_content div.link_detail").removeClass("visible").addClass("hidden");
u.find("div.dock_content div."+o).removeClass("hidden").addClass("visible");h();n&&B(o)};this.tabExists=function(o){return b(o).length>0};this.scrollForward=function(){var o=a();o.find("ul.dock_tabs li.visible").filter(":first").removeClass("visible").addClass("hidden");p(o.find("ul.dock_tabs li").filter(":first"));DCKdockController.updateTabScrollButtons()};this.scrollBackward=function(){var o=a();o.find("ul.dock_tabs li.visible").filter(":last").removeClass("visible").addClass("hidden").hide();
q(o.find("ul.dock_tabs li").filter(":last"));DCKdockController.updateTabScrollButtons()};this.repositionTabs=function(){for(var o=a().find("ul.dock_tabs li").filter(".visible"),n=$(o.get(0)).width(),u=0,m=0;m<o.length;++m){var s=$(o.get(m));if(!s.hasClass("ui-sortable-helper")){s.css("left",n*u+I*(u+1)+"px");++u}}};this.resetOpenedTabsOrder=function(){var o=a(),n=COOKIEread(J),u="",m=o.find(".dock_content input[type='hidden']"),s=Array(m.length),v;for(v=0;v<m.length;++v){var x=$(m[v]).val();s[o.find("ul.dock_tabs li."+
x).index()]=x}for(v=0;v<m.length;++v){TabId=s[v];o=n.match(RegExp(TabId+":\\w*#","g"));u+=o}ITMresetCookie(J,u)};this.resize=function(){var o=a();if(o.is(":visible")){if("popup"!=COOKIEread(H))if(250<$("div.content_main").height()){$("div#EDTeditor").css("bottom",$(window).height()-$("div#bottom_dock").offset().top-10+"px");$("div#bottom_dock").css("height",Math.min($("div#bottom_dock").height(),$("div.content_main").height()-50))}else $("div#bottom_dock").css("height",Math.min($("div#bottom_dock").height(),
200));if(o.find("div.dock_toolbar").length&&o.find("ul.dock_tabs li").length){var n=o.find("div.dock_toolbar").get(0).clientWidth-("popup"==COOKIEread(H)?50:90),u=o.find("ul.dock_tabs li:first"),m=o.find("ul.dock_tabs li:last"),s=u.get(0).clientWidth,v=o.find("ul.dock_tabs li:visible").filter(":last"),x=v.position().left;if(x+2*(s+I)<n)for(;x+2*(s+I)<n&&(!m.is(":visible")||!u.hasClass("visible"));){m.is(":visible")?this.scrollBackward():v.next().removeClass("hidden").addClass("visible").show().css("left",
x+s+I);v=o.find("ul.dock_tabs li:visible").filter(":last");x=v.position().left}else if(x+s+I>n)for(;x+s+I>n;){v.removeClass("visible").addClass("hidden").hide();v=o.find("ul.dock_tabs li:visible").filter(":last");x=v.position().left}h();DCKdockController.updateTabScrollButtons()}}};this.openPopup=function(){G("popup");t()};this.openDocked=function(){G("docked");r()};this.close=function(){for(var o=ITMgetItems(a()),n=0;n<o.length;++n){var u=$(o[n]);z(u.data("Id"))}};this.tab=function(o){var n=ITMcreateNewItem(o);
ITMaddItemToCookie(J,n);e(n);DCKdockController.selectTab(o)};this.errorStackTab=function(o,n){if(DCKdockController.tabExists(ITM_ERROR_STACK_ID))n&&B(ITM_ERROR_STACK_ID);else{var u=ITMcreateNewItem(ITM_ERROR_STACK_ID);e(u);j(o,u);ITMpushItemToCookie(J,u)}DCKdockController.selectTab(ITM_ERROR_STACK_ID)};this.setHelpContent=function(o,n){var u=b(o),m=a().find("div.link_detail:has(input.link_id[value="+o+"])");m=ITMgetItems(m);g(m,u,n)};this.refresh=function(o,n,u){ITMgetItems(a()).each(function(){var m=
$(this),s=m.data("Id");if(!m.data("ContentIsStatic"))if(u)y({ErrorMessage:"Script did not finish executing because it was cancelled by the user."},m);else if(ITM_ERROR_STACK_ID==s)j(n,m);else o[s]?d(o[s],m):y({ErrorMessage:"Unknown error."},m)})};this.getFullArgumentRequests=function(o){var n=ITMgetItems(a());ITMitemsToRequests(n,o)};this.beforeRefresh=function(){for(var o=ITMgetItems(a()),n=0;n<o.length;n++){var u=$(o[n]);u.data("ContentIsStatic")||b(u.data("Id")).addClass("waiting")}};this.init=
function(o){E=o;F=E.ifware.ChannelGuid+"_"+E.ifware.User+"_SelectedDockTab";J=E.ifware.ChannelGuid+"_"+E.ifware.User+"_OpenedTabs";c();h()};this.tabFromExisting=function(o){var n=o.data("Title"),u=o.data("LabelClass"),m=o.data("Tooltip"),s=o.siblings().detach(),v=e(o);v.append(s);s=o.data("Id");s=b(s);f(n,u,m,s);ITMtriggerScrollEvent(v);ITMaddItemToCookie(J,o)};this.setAnnotationToDefaultForAutoScriptExecutionDisabled=function(o){y({ChunkInfo:{Chunks:[{ChunkNumber:0,Value:'To display this object <a href="#" class="execScriptButton executeNowText">run the script now</a>.'}],
TotalChunks:1,LinesInLastChunk:7},title:"&nbsp;",file_name:"",funct_name:"",call:1,line:-1},o);o=$(".execScriptButton");o.unbind("click");o.click(function(n){n.preventDefault();$(ifware).trigger("ExecuteScriptOnce")})}}var DCKdockController=new DCKdock;/*

 Copyright (c) 2010-2014 iNTERFACEWARE Inc.  All rights reserved.
*/
function EDTtoggleProjectPane(a){var b=$("#EDTprojectManager");if(a){b.show();$("#EDTeditor .CodeMirror").css("left",b.outerWidth()+"px")}else{b.hide();$("#EDTeditor .CodeMirror").css("left","0px")}}function EDTtoggleThumbnail(a){var b=$("div#EDTthumbnailScroll");if(b.is(":visible")){b.hide();$("#EDTeditor .CodeMirror").css("right","0px")}else{b.show();$("#EDTeditor .CodeMirror").css("right",b.css("width"));ETHscrollerControl.show(a)}}
function EDTscrollEditor(a,b){var c=$("#EDTeditor .CodeMirror-scroll"),d=(NISeditorScrollHeight()/NIScharHeight()+2)*ETHscrollerControl.retrieveVerticalScale(),e=NISeditorHeight();d=NISeditorScrollHeight()*((a.pageY-c.offset().top)/d)-0.5*e;e=NISeditorScrollWidth()/NIScharWidth(b)*ETHscrollerControl.retrieveHorizontalScale()*0.5;var f=NISeditorWidth();c=NISeditorScrollWidth()*((a.pageX-(c.offset().left+NISeditorWidth())-15)/e)-0.5*f;NISsetEditorScrollPosition(d,c)}
function EDTsetupHeader(a,b){var c=NIScreateToolbar(a,b);$("div.EDTtoolbar_wrapper").append(c);a.ifware.projectSettings.showProjectExplorer()||EDTtoggleProjectPane();NIScreateStatusBar(a,$("div.EDTstatus_bar"))}function EDTopenEditor(a){$("body:first").html('<div class="EDTloading" />');setTimeout(function(){EDTopenEditorImpl(a)},0)}
function EDTopenEditorImpl(a){var b=String(BrowserDetect.version),c=false;if("Explorer"==BrowserDetect.browser&&null!=b.match(/^8/))c=true;b=MAPretrieveHeaderHTML("lua_editor",a);b+='<div class="content_main floated_bottom">        <div class="EDTtoolbar_wrapper" />        <div id="EDTeditor">         <div id="EDTprojectManager" />';c||(b+='<div id="EDTthumbnailScroll" />');b+='</div>        <div id="bottom_dock">         <div class="dock_toolbar">          <div class="dock_tabs">           <ul class="dock_tabs">           </ul>          </div>          <div class="dock_buttons">           <a class="dock_scroll_backward scroll" href=""><img src="/js/mapper/images/arrow-backward-disabled.png" /></a><a class="dock_scroll_forward scroll" href=""><img src="/js/mapper/images/arrow-forward-disabled.png" /></a>           <a class="to_popup" href="">            <img src="/js/mapper/images/popup-big.png" />           </a>           <a class="dock_close" href="">            <img src="/js/mapper/images/icon-close.png" />           </a>          </div>         </div>         <div class="dock_content">         </div>        </div>        <div id="popup_dock">         <div class="dock_toolbar">          <div class="dock_tabs">           <ul class="dock_tabs">           </ul>          </div>          <div class="dock_buttons">           <a class="dock_scroll_backward scroll" href=""><img src="/js/mapper/images/arrow-backward-disabled.png" /></a><a class="dock_scroll_forward scroll" href=""><img src="/js/mapper/images/arrow-forward-disabled.png" /></a>          </div>         </div>         <div class="dock_content">         </div>        </div>        <div class="EDTstatus_bar" />       </div>';
$("body:first").append(b);c=$("#EDTprojectManager");c.resizable({handles:"e",minWidth:101});(b=COOKIEread("EDTprojectPaneWidth"))&&c.css("width",b);c=$("div#bottom_dock");c.resizable({handles:"n",resize:function(){$("div#bottom_dock").resizable("option","maxHeight",$("div.content_main").height()-50);$("div#bottom_dock").css("bottom","32px").css("top","").css("width","").css("right","0px");15>$("#EDTeditor .CodeMirror-scroll").get(0).clientHeight?$("#EDTeditor .CodeMirror-scroll").css("overflow","hidden"):
$("#EDTeditor .CodeMirror-scroll").css("overflow","auto");EDTonResize()},minHeight:101});(b=COOKIEread("EDTdockHeight"))||(b="101px");c.css("height",b);EDTonResize();$("a.dock_scroll_backward").bind("click",function(){$("ul.dock_tabs li:first").hasClass("hidden")&&DCKdockController.scrollBackward();return false});$("a.dock_scroll_backward img").attr("title","Scroll tabs backward");$("a.dock_scroll_forward").bind("click",function(){$("ul.dock_tabs li:last").hasClass("hidden")&&DCKdockController.scrollForward();
return false});$("a.dock_scroll_forward img").attr("title","Scroll tabs forward");$("a.to_popup").bind("click",function(){DCKdockController.openPopup();return false});$("a.to_popup img").attr("title","Undock");$("a.dock_close").click(function(){DCKdockController.close();return false});$("a.dock_close").attr("title","Close all");DCKdockController.updateTabScrollButtons();$(document).get(0).title=MAPretrieveDocTitle("lua_editor",a);$("ul.dock_tabs").sortable({axis:"x",opacity:0.5,items:"li"});$("ul.dock_tabs").disableSelection();
$("ul.dock_tabs").bind("sortstop",function(d,e){e.item.css("filter","");DCKdockController.repositionTabs();DCKdockController.resetOpenedTabsOrder()}).bind("sort",function(){var d=$("ul.dock_tabs li.ui-sortable-placeholder");if(0>$("ul.dock_tabs li.ui-sortable-helper").position().left){var e=$("ul.dock_tabs li:visible").get(0);if($(e).hasClass("ui-sortable-placeholder"))e=$(e).next();$(e).before(d)}else{e=Math.floor($("ul.dock_tabs li.ui-sortable-helper").position().left/DCKdockController.tabWidth());
NewIndex=Math.min($("ul.dock_tabs li:visible").length,e);e=$("ul.dock_tabs li:visible").get(NewIndex);if($(e).hasClass("ui-sortable-placeholder"))e=$(e).next();$(e).after(d)}DCKdockController.repositionTabs();$("ul.dock_tabs li.ui-sortable-helper").trigger("click")});console.log("Params below.");console.log(a);NIScreateEditor(document.getElementById("EDTeditor"),EDTsetupHeader,a)}
function EDTonResize(){var a=$("div#bottom_dock");a.css("display")!="none"&&$("div#EDTeditor").css("bottom",$(window).height()-a.offset().top-11+"px");var b=$("#EDTeditor").innerWidth()-201,c=$("#EDTprojectManager");c.resizable("option","maxWidth",b);c.outerWidth()>b&&c.css("width",b+"px");c.css("height",$("div#EDTeditor").innerHeight());COOKIEcreate("EDTprojectPaneWidth",c.css("width"),365);COOKIEcreate("EDTdockHeight",a.css("height"),365)}
ifware.initializeProjectSettings=function(a){var b={showEmptyNodes:false,disableAutoScriptExecution:false,showThumbnails:false,showProjectExplorer:true};return{showEmptyNodes:function(c){return ifware.LocalStorage.setOrGetState(b,"showEmptyNodes",c,a)},disableAutoScriptExecution:function(c){return ifware.LocalStorage.setOrGetState(b,"disableAutoScriptExecution",c,a)},showThumbnails:function(c){return ifware.LocalStorage.setOrGetState(b,"showThumbnails",c,a)},showProjectExplorer:function(c){return ifware.LocalStorage.setOrGetState(b,
"showProjectExplorer",c,a)}}};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function ETHscroller(a){function b(){return true}function c(){return{fill:"black"}}function d(r,w){for(var z=r.length,y=0,A=0;A<z;++A){var B=r[A];B=B.c+B.w/w;if(B>y)y=B}return y}function e(r,w,z,y){return Math.ceil(r.w/y)}function f(){var r=$("g#"+GroupId).attr("transform").match(/scale\s*\(\s*\d(\.\d+)?\s*\,\s*\d(\.\d+)?\s*\)/g)[0].match(/\d(\.\d+)?/g);return parseFloat(r[1])}function g(){var r=$("g#"+GroupId).attr("transform").match(/scale\s*\(\s*\d(\.\d+)?\s*\,\s*\d(\.\d+)?\s*\)/g)[0].match(/\d(\.\d+)?/g);
return parseFloat(r[0])}function j(r){$("rect.lua-scrollbar").remove();var w=$("#"+ContainerId),z=w.svg("get");if(undefined!=z){var y=z.getElementById(GroupId),A=NISeditorHeight()/NIScharHeight(),B=0;if(NISeditorHeight()<NISeditorScrollHeight())B=15;r=0.5*((NISeditorWidth()-B)/r.ifware.CharWidth)+1;var G=B=1;if(w.is(":visible")){w=parseInt($("svg").attr("height"))/NISeditorScrollHeight();B=NISgetEditorScrollTop()*w/f();w=parseInt($("svg").attr("width"))/NISeditorScrollWidth();G=NISgetEditorScrollLeft()*
w/g()}z.rect(y,G,B,r,A,{"class":"lua-scrollbar"})}}function l(r){if(r.attr("tooltip")){clearTimeout(TimeoutId);$("#"+ContainerId);TOOLtooltipLink(r.attr("tooltip"),null,null,0);TimeoutId=setTimeout("TOOLtooltipClose();",2E3)}}function h(r){var w=$("#"+ContainerId),z=w.offset().left;w=w.offset().top;var y=(r.clientX-z)/g(),A=(r.clientY-w)/f();$("rect").each(function(){if($(this).attr("tooltip")){var B=parseInt($(this).attr("x")),G=parseInt($(this).attr("y")),E=B+parseInt($(this).attr("width")),F=G+
parseInt($(this).attr("height"));if(y>=B&&y<=E&&A>=G&&A<=F){l($(this));return false}}})}function q(){$("rect[tooltip]").bind("mouseenter",function(){l($(this))});$("rect.lua-scrollbar").unbind().bind("mousemove",function(r){h(r)})}function p(r){var w=$("#"+ContainerId),z=w.get(0).clientWidth;w=w.get(0).clientHeight;var y=$("#"+ContainerId),A=y.svg("get");if(undefined!=A){A.configure({viewbox:"0 0 "+y.get(0).clientWidth+" "+y.get(0).clientHeight,preserveAspectRatio:"none"},false);A.configure({height:Math.min(y.get(0).clientHeight,
NISeditorScrollHeight()/NIScharHeight()+2)},false);A.configure({width:y.get(0).clientWidth},false)}y=0.5*(NISeditorScrollWidth()/r.ifware.CharWidth);A=NISeditorScrollHeight()/NIScharHeight();$("g#"+GroupId).attr("transform","scale("+z/y+","+Math.min(1,w/A)+")");j(r)}EmbeddedScrollBarWidth=5;GroupId="EDTthumbnail_group";ContainerId=a;BlockFilter=b;Stylizer=c;MaxLineLengthCalculator=d;OptimalBlockWidthCalculator=e;TimeoutId=-1;if(document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure",
"1.1")){this.setBlockFilter=function(r){BlockFilter=r?r:b};this.setStylizer=function(r){Stylizer=r?r:c};this.setMaxLineLengthCalculator=function(r){MaxLineLengthCalculator=r?r:d};this.setOptimalBlockWidthCalculator=function(r){OptimalBlockWidthCalculator=r?r:e};this.retrieveVerticalScale=f;this.retrieveHorizontalScale=g;this.initializeScroller=function(r){var w=$("#"+ContainerId);w.unbind("mousedown").bind("mousedown",r).bind("mousedown",function(){$(this).unbind("mousemove").bind("mousemove",r);
$("rect").unbind()});w.unbind("mouseup").bind("mouseup",function(){$(this).unbind("mousemove");q()});w.unbind("mouseleave").bind("mouseleave",function(){$(this).unbind("mousemove");q()});$("rect").unbind();$("g").unbind();$("svg").unbind()};var t;this.scroll=function(r){j(r);$("rect").unbind();clearTimeout(t);t=setTimeout(q,500)};this.clearError=function(){$("rect.lua-error").remove()};this.showError=function(r,w,z){var y=$("#"+ContainerId),A=y.svg("get");if(undefined!=A){var B;if($("rect.lua-error").length){z=
parseFloat($("rect.lua-error").attr("x"));B=parseFloat($("rect.lua-error").attr("y"))}else{z=0.5*z+5;B=w.LineNumber}ETHscrollerControl.clearError();var G=A.getElementById(GroupId);ErrorBlockWidth=0.5*$("div.error-box").get(0).clientWidth/NIScharWidth(r);ErrorBlockHeight=$("div.error-box").get(0).clientHeight/NIScharHeight();$("rect.lua-error-line").length||A.rect(G,1,w.LineNumber,y.get(0).clientWidth/g(),1,{"class":"lua-error-line"});A.rect(G,z,B,ErrorBlockWidth,ErrorBlockHeight,{"class":"lua-error"});
p(r)}};this.clear=function(){$("#"+ContainerId).svg("destroy")};this.resize=function(r){r.ifware.CharWidth=NIScharWidth(r);p(r)};this.show=function(r){this.clear(r);r.ifware.BlockDataSet&&$("#"+ContainerId).svg({onLoad:function(w){for(var z=r.ifware.CharWidth=NIScharWidth(r),y=$("#"+ContainerId),A=w.group(null,GroupId),B=MaxLineLengthCalculator(r.ifware.BlockDataSet,z),G=r.ifware.BlockDataSet.length,E=0;E<G;++E){var F=r.ifware.BlockDataSet[E],J=Stylizer(F.type),H=0.5*F.c,K=Math.max(0,OptimalBlockWidthCalculator(F,
B,y.get(0).clientWidth,z)-3);if(BlockFilter(F)){w.rect(A,EmbeddedScrollBarWidth+H,F.s,K,F.e-F.s,J);F.t&&$("rect:last").attr("tooltip",F.t)}else w.rect(A,EmbeddedScrollBarWidth+H,F.s,K,F.e-F.s,{fill:$("div#EDTthumbnailScroll svg").css("background-color")})}p(r);q()}});TOOLinitialize()}}else{this.setBlockFilter=function(){};this.setStylizer=function(){};this.setMaxLineLengthCalculator=function(){};this.setOptimalBlockWidthCalculator=function(){};this.retrieveHorizontalScale=this.retrieveVerticalScale=
1;this.initializeScroller=function(){};this.scroll=function(){};this.clearError=function(){};this.showError=function(){};this.clear=function(){};this.resize=function(){};this.show=function(){}}}var ETHscrollerControl=new ETHscroller("EDTthumbnailScroll");/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function ERRrenderError(a,b,c){b=MAPretrieveHeaderHTML("error",b);b+="<div class='content_main'><div class='error'>"+a+"</div>";if(c&&history.length>1)b+="<hr>"+BTNwrapper(BTNbuttonWithJavascript("javascript:history.go(-2);","Back"));$(document).find("body").html(b);a=location.href.split("#");location.href=a[0]+"#error"}
function ERRrenderDefaultError(a,b){var c=MAPretrieveDefaultHeaderHTML();c+="<div class='content_main'><div class='error'>"+a+"</div>";if(b&&history.length>1)c+="<hr>"+BTNwrapper(BTNbuttonWithJavascript("javascript:history.go(-2);","Back"));$(document).find("body").html(c);c=location.href.split("#");location.href=c[0]+"#error"};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function ITSinitIntellisense(a,b){function c(){return $(B).find(".intellisenseOptionsList tr.hover").get(0)}function d(){var n=c();if(n){var u=$(".intellisenseOptionsContainer",B).get(0),m=n.offsetTop-2;n=n.offsetTop+n.offsetHeight+2+20;var s=u.scrollTop,v=u.scrollHeight-u.offsetHeight+20;if(n>u.scrollTop+u.offsetHeight)u.scrollTop=Math.max(0,Math.min(v,n-u.offsetHeight))+4;if(m<s)u.scrollTop=Math.max(0,Math.min(v,m))}}function e(n){$(n).addClass("hover")}function f(){var n=c();n&&g(n);e($(B).find(".intellisenseOptionsList tr").get(0))}
function g(n){$(n).removeClass("hover")}function j(){if(G){g(c());e(this)}}function l(){G&&g(this)}function h(n,u,m,s){var v=document.createElement("tr");v.onmouseover=j;v.onmouseout=l;v.onclick=function(C,D){var L=n.ft,P=!n.s;A();var O=a.getLine(m),Q=O.substring(0,s-u.length),N=L.length,R=N&&(L[N-1]=="("||L[N-1]=="{"),S=N&&D=="="&&L[N-1]=="=";if(!P&&(R&&D||S)){L=L.substring(0,N-1);R=false}if(D)L+=D;Q+=L;Q+=O.substring(s);a.setLine(m,Q);a.setCursor({line:m,ch:s+(L.length-u.length)});a.focus();if(P&&
!D)y(L);else if(R||D)y()};var x=document.createElement("td");x.className="nt_"+n.pt+"_"+n.nt;if(n.r)x.className+=" r";x.innerHTML=n.dt;v.appendChild(x);return v}function q(n){var u=n<0?1:-1,m=c();if(!m){f();m=c();n+=u}for(;n!=0&&m;){var s=n<0?$(m).prev().get(0):$(m).next().get(0);if(s){g(m);e(s)}m=s;n+=u}d()}function p(n,u){switch(n){case 32:case 13:c().onclick();return true;case 38:q(-1);return true;case 9:u?q(-1):q(1);return true;case 40:q(1);return true;case 33:q(-7);return true;case 34:q(7);return true;
case 36:f();d();return true;case 35:var m=c();m&&g(m);m=$(B).find(".intellisenseOptionsList tr").get();e(m[m.length-1]);d();return true;case 27:A();return true;case 112:F&&$(".intellisenseHelpButtons",B).is(":visible")&&F();return true}return false}function t(n,u,m){var s=n.getCursor();u=u.substring(0,s.ch-m);return n.charCoords({line:s.line,ch:u.length})}function r(n,u,m,s){F=function(){var v=$(s).find(".intellisenseHelpData").clone();v.show();NISshowPopupOrDockTab(n,ITM_HELP_ID,undefined,v);n.focus()};
$(s).prepend('<div class="intellisenseHelpTitle">HELP<div class="intellisenseHelpButtons">'+M+"</div></div>");$(".intellisenseHelpTitle",s).click(F);$(".intellisenseHelpButtons-close",s).click(A)}function w(n,u,m,s){n=t(n,u,m.length);B.style.left=n.x+"px";B.style.top=n.yBot+"px";B.style.height="";B.style.width="";if($(B).outerHeight()>s){B.style.height=s+"px";B.style.width=$(B).innerWidth()+18+"px"}s=WINgetWindowWidth()-n.x-50;u=$(B).outerWidth();if(u>s)B.style.width=s+"px";else if(u<80)B.style.width=
"80px";var v=$(B).outerHeight();$(".intellisenseHelpTitle",B).each(function(){var x=$(".intellisenseOptionsContainer:visible,.intellisenseHelpData:visible").height("100%").outerHeight();if(x>v-$(this).outerHeight()){x-=$(this).outerHeight();$(".intellisenseOptionsContainer:visible,.intellisenseHelpData:visible").height(x)}v=$(B).outerHeight()});if(n.yBot+v>WINgetWindowHeight())B.style.top=n.y-v+"px"}function z(n){b.innerHTML="";if(n.ErrorMessage)b.innerHTML=n.ErrorMessage;else{var u=n.Options;if(u&&
u.length>0){var m=a.getCursor(),s=m.line,v=a.getLine(s);n.LineNumber--;if(s==n.LineNumber&&m.ch==n.CursorPosition){var x=document.createElement("table");$(x).addClass("intellisenseOptionsList");for(var C=0;C<u.length;C++)x.appendChild(h(u[C],n.FullExpression,s,m.ch));if(n.OptionsTruncated){u=document.createElement("tr");C=document.createElement("td");C.className="intellisenseOptionsTruncatedWarning";C.innerHTML="Not all results could be displayed.";u.appendChild(C);x.appendChild(u)}B.cursorPos=m.ch;
B.lineNo=s;$(B).empty();if(n.HelpHtml){m=$('<div class="intellisenseOptionsContainer intellisenseHelpParams"></div>                                         <div style="display: none" class="intellisenseHelpData">'+n.HelpHtml+"</div>");$(x).addClass("intellisenseOptionsHelp");$(B).append(m);$(".intellisenseHelpParams",B).append(x);r(a,v,n.SearchString,B)}else{$(x).addClass("intellisenseOptions");m=$('<div class="intellisenseOptionsContainer"></div>');m.append(x);$(B).append(m)}B.style.display="";w(a,
v,n.SearchString,I)}}else if(n.HelpHtml){x=a.getCursor();m=x.line;v=a.getLine(m);n.LineNumber--;if(m==n.LineNumber&&x.ch==n.CursorPosition){B.cursorPos=x.ch;B.lineNo=m;$(B).empty();$(B).append('<div class="intellisenseOptionsContainer intellisenseHelpUsage"></div>                               <div style="display: none" class="intellisenseHelpData"></div>');r(a,v,n.SearchString,$(B));if(n.UsageHelpHtml){x=n.UsageHelpHtml;$(".intellisenseHelpUsage",B).append(x).show();$(".intellisenseHelpData",B).append(n.HelpHtml).hide()}else if(n.HelpHtml){$(".intellisenseHelpUsage",
B).hide();$(".intellisenseHelpButtons",B).hide();$(".intellisenseHelpData",B).append(n.HelpHtml).show()}B.style.display="";w(a,v,n.SearchString,K)}}}}function y(n){if(!a.ifware.projectSettings.disableAutoScriptExecution()){var u=a.getCursor();A();b.innerHTML='<img src="/js/mapper/images/spinner.gif" />';u={LineNumber:u.line+1,CursorPosition:u.ch};if(n)u.AdditionalRequestExpression=n;NISprepareLuaPostInfo(a,u,true);o.post("/get_intellisense_options",u,z,function(){b.innerHTML="Cancelled."})}}function A(n){n&&
n.stopPropagation&&n.stopPropagation();if($(B).is(":visible")){$(B).empty().hide();a.focus()}}var B=$("body:first").prepend('<div class="ITSpopupProtector"><div class="intellisensePopup" style="display:none;"></div></div>').find("div.intellisensePopup:first")[0],G=false,E=false;$(B).mousemove(function(){G=true});var F,J={40:"(",41:")",44:",",46:".",58:":",61:"=",91:"[",93:"]",123:"{",125:"}"},H=/^(\s*--.*|\W*)$/,K=400,I=175,M='<img class="intellisenseHelpButtons-expand" title="Pop out" src="/js/mapper/images/maximize_button_yellow.gif">                             <img class="intellisenseHelpButtons-close" title="Close" src="/js/mapper/images/close_button_yellow.gif">',
o=ScriptRunner();a.ifware.addKeyEventListener(function(n,u){if(n.ifware.projectSettings.disableAutoScriptExecution())return false;var m=window.event?event.keyCode:u.keyCode,s=c(),v=u.type=="keypress",x=undefined;if(v)x=J[u.charCode===undefined?m:u.charCode];if(x&&s){s.onclick(null,x);u.stop();return true}if(v)E=false;a:{if(u.type=="keypress"){if(u.charCode!=0&&m!=13||m==8){x=true;break a}}else if(u.type=="keydown"&&m==8){x=true;break a}x=false}if(x){E=true;return false}if(B.style.display=="none"||
!s&&(m==13||m==32))return false;G=false;switch(m){case 13:if(v)u.stop();else return false;break;case 9:case 32:case 38:case 40:case 33:case 34:case 36:case 35:case 27:case 112:if(m==112){document.onhelp=function(){return false};window.onhelp=function(){return false}}u.stop();if(u.type!="keydown")return true}return p(m,u.shiftKey)?true:false});a.ifware.addCursorActivityListener(function(){b.innerHTML="";var n=a.getCursor();if(B.style.display==""&&(B.cursorPos!=n.ch||B.lineNo!=n.line))A()});a.ifware.addScrollListener(A);
a.ifware.addChangeListener(function(n){if(E){E=false;var u=n.getCursor();n=n.getLine(u.line).substring(0,u.ch);H.test(n)||y()}})};var ITM_CHUNK_SIZE=200,ITM_ERROR_STACK_ID="error_stack",ITM_ERROR_STACK_TITLE="Error Stack",ITM_HELP_ID="help",ITM_HELP_TITLE="Help",ITM_VIEW_MODE_CHANGE_EVENT="itemviewmodechange",ITM_COOKIE_EXPIRY=60;function ITMgetContainerLineHeight(a){a=$("<div>\n</div>").appendTo(a);var b=a.outerHeight();a.remove();return b}
function ITMonScrollNearEmptyChunk(a,b,c,d){var e=b.attr("id").split("_")[1];Ajax.post("/annotation_full_arg",{ChannelGuid:a.ifware.ChannelGuid,Id:c,ViewMode:d,Chunk:e},function(f){f.ErrorMessage?b.removeClass("empty").addClass("error").text(f.ErrorMessage):b.removeClass("empty").css("height","").html(f.ChunkInfo.Chunks[0].Value)},"json")}
function ITMsetChunkScrollHandler(a,b,c,d,e){b.unbind("scroll");e.Chunks.length!=e.TotalChunks&&b.scroll(function(){for(var f=this.scrollTop-200,g=this.scrollTop+b.outerHeight()+200,j=b.children("div.chunk.empty"),l=0,h=j.length;l<h;l++){var q=$(j[l]),p=q.get(0).offsetTop,t=p+q.outerHeight();if(f<=t&&t<=g||f<=p&&p<=g||p<=f&&g<=t)ITMonScrollNearEmptyChunk(a,q,c,d)}})}
function ITMrenderChunks(a,b,c,d,e){for(var f=ITMgetContainerLineHeight(b),g="",j=f*ITM_CHUNK_SIZE,l=0,h=e.TotalChunks;l<h;l++)g+='<div class="chunk empty" id="chk_'+l+'" style="height:'+j+'px;" />';b.html(g);l=0;for(h=e.Chunks.length;l<h;l++){g=e.Chunks[l];b.children("#chk_"+g.ChunkNumber).removeClass("empty").css("height","").html(g.Value)}b.children("div.chunk:last").css("height",f*e.LinesInLastChunk+"px");ITMsetChunkScrollHandler(a,b,c,d,e)}
function ITMonViewModeChange(a,b,c){var d=b.parent(),e=ITMgetContentDiv(d);d=ITMitemToRequest(b);d.ChannelGuid=a.ifware.ChannelGuid;c.addClass("waiting");Ajax.post("/annotation_full_arg",d,function(f){c.removeClass("waiting");b.trigger(ITM_VIEW_MODE_CHANGE_EVENT,[b]);if(f.ErrorMessage){var g=e.children("div.chunk");g.empty().addClass("error");$(g[0]).text(f.ErrorMessage);e.scrollTop(0)}else ITMrenderGenericView(a,f,b)},"json")}
function ITMrenderViewOptions(a,b,c,d){if(!b.find(".string_slider").size()){b.html('<div class="string_slider"><a href="" class="slide_arrow" title="Show/hide view options"></a><div class="content"></div></div><div class="view_options"><div class="view_options_title">View Mode:</div><a href="" class="string_pt">Plain Text</a><a href="" class="string_et">Escaped Text</a><a href="" class="string_hx">Hexadecimal</a></div>');b.find("a.slide_arrow").click(function(e){e.preventDefault();e=b.find("div.string_slider");
e.stop(true,true).toggleClass("expanded");var f=e.hasClass("expanded")?"0px":"110px";e.animate({left:f},"fast")});b.find("div.view_options a").click(function(e){e.preventDefault();e=$(this);e.siblings().andSelf().removeClass("selected").removeClass("waiting");var f=this.className;e.addClass("selected");if(d.data("ViewMode")!=f){d.data("ViewMode",f);ITMonViewModeChange(a,d,e)}}).filter("."+c).addClass("selected")}}
function ITMremoveViewOptions(a){if(a.find(".string_slider").size()){var b=a.find("div.content").detach();a.children("div").remove();a.append(b)}}function ITMonShowNoDataError(a){if("Details"==$("a#no_data_toggle_"+a).html()){$("a#no_data_toggle_"+a).html("Hide");$("div#no_data_details_"+a).show()}else{$("a#no_data_toggle_"+a).html("Details");$("div#no_data_details_"+a).hide()}}
function ITMnoDataErrorToDisplay(a,b){var c="";if("Unknown error."==a)c="No data.  Tracepoint not reached.";else{if(!b.id)b.id=b.data("Id");c="No data.  The script was stopped or an error occurred. <br><a id='no_data_toggle_"+b.id+"' href='javascript:ITMonShowNoDataError(\""+b.id+"\")'>Details</a>";c+="<div id='no_data_details_"+b.id+"' style='display:none;'>"+a.replace(/^.*@@<><>.+<><>@@/,"")+"</div>"}return c}function ITMsetContentItem(a,b){a.append(b)}
function ITMgetContentDiv(a){var b=a.find("div.content:first");b.size()||(b=$('<div class="content"></div>').appendTo(a));return b}function ITMappendStackFrame(a,b,c){var d=PAGhtmlEscape(c.fd);$('<tr><td width="1%"><a href="" class="fc fcin" title="Step into '+c.n+" at "+d+":"+c.l+'">'+c.n+"</a></td><td>("+d+":"+c.l+")</td></tr>").appendTo(b).find("a.fc").click(function(e){e.preventDefault();NISjumpToStackFrame(a,c)})}
function ITMsetLabelInfo(a,b,c,d,e){c=undefined===c||undefined===d?e:"nt_"+c+"_"+d;a.data("Title",b);a.data("LabelClass",c);return c}
function ITMsetTooltip(a,b){if(a.title==="&nbsp;")return"This information cannot be displayed until the script is re-run.";var c=a.funct_name;if(undefined!=c){var d="",e=b.data("Id").replace(/^(.+_)+/,"").split("-");if("a"==e[2])d+="Argument "+parseInt(e[1]);else if("r"==e[2])d+="Return "+parseInt(e[1]);if("main"==c)d+=" of "+c;else{d+=" of call "+a.call+" of "+c;d+=" at "+a.file_name+":"+a.line}b.data("Tooltip",d);return d}else return""}
function ITMpopulateErrorStackTrace(a,b,c){var d=c.parent();if(d.size()){c.detach();d.empty();d=$('<div class="error_stack_container"></div>').appendTo(d);if(b&&b.CallStack){b=b.CallStack;for(var e=$('<table class="ANNest"></table>').appendTo(d),f=b.length-1;f>=0;f--)ITMappendStackFrame(a,e,b[f]);e.find("a.fc").mouseenter(function(){NISonFunctionCallEnter(a,this)}).mouseleave(function(){NISonFunctionCallLeave(a,this)})}else d.html('<div class="ANNest_none">There is no error in the script for which a stack trace can be provided.</div>');
ITMsetContentItem(d,c)}}function ITMrenderErrorView(a,b){var c=b.parent();b.detach();ITMgetContentDiv(c).html(ITMnoDataErrorToDisplay(a.ErrorMessage,b));ITMsetContentItem(c,b)}function ITMrenderStaticView(a,b){var c=a.parent();a.detach();ITMgetContentDiv(c).empty().append(b);ITMsetContentItem(c,a);a.data("ContentIsStatic",true)}
function ITMrenderTreeviewView(a,b,c){var d=c.parent();ITMremoveViewOptions(d);c.detach();var e=ITMgetContentDiv(d);e.html('<ul class="ifwareTreeview"></ul>');NTRinitTreeview(b.Root,e.find("ul.ifwareTreeview").get(0),c,"/annotation_full_arg",{ChannelGuid:a.ifware.ChannelGuid},true);ITMsetContentItem(d,c)}
function ITMrenderGenericView(a,b,c){var d=c.parent();c.detach();var e=b.pt===0&&b.nt===4,f=c.data("ViewMode")||"string_pt";if(e){ITMrenderViewOptions(a,d,f,c);e=d.find("div.content")}else{ITMremoveViewOptions(d);e=ITMgetContentDiv(d)}ITMrenderChunks(a,e,c.data("Id"),f,b.ChunkInfo);ITMsetContentItem(d,c)}
function ITMgetVisibleChunks(a){var b=a.find("div.content");if(b.children("div.chunk:first").size()==0)return[];a=ITMgetContainerLineHeight(b);var c=Math.max(0,b.scrollTop()-200);b=b.scrollTop()+b.outerHeight()+200;c=Math.floor(Math.floor(c/a)/ITM_CHUNK_SIZE);a=Math.floor(Math.floor(b/a)/ITM_CHUNK_SIZE);return c!=a?[c,a]:[c]}
function ITMaddItemToCookie(a,b){var c=COOKIEread(a),d=b.data("Id"),e=d+":"+(b.data("ViewMode")||"")+"#";if(undefined==c)COOKIEcreate(a,e,ITM_COOKIE_EXPIRY);else{d=RegExp(d+":\\w*#","g");if(c.search(d)!=-1){c=c.replace(d,e);COOKIEcreate(a,c,ITM_COOKIE_EXPIRY)}else COOKIEcreate(a,c+e,ITM_COOKIE_EXPIRY)}}
function ITMpushItemToCookie(a,b){var c=COOKIEread(a),d=b.data("Id"),e=d+":"+(b.data("ViewMode")||"")+"#";if(undefined==c)COOKIEcreate(a,e,ITM_COOKIE_EXPIRY);else{c=c.replace(RegExp(d+":\\w*#","g"),"");COOKIEcreate(a,c+e,ITM_COOKIE_EXPIRY)}}function ITMupdateCookie(a,b){var c=b.data("Id"),d=c+":"+(b.data("ViewMode")||"")+"#",e=COOKIEread(a);e&&COOKIEcreate(a,e.replace(RegExp(c+":\\w*#","g"),d),ITM_COOKIE_EXPIRY)}
function ITMremoveItemFromCookie(a,b){var c=COOKIEread(a);if(undefined!=c){c=c.replace(RegExp(b+":\\w*#","g"),"");""==c?COOKIEerase(a):COOKIEcreate(a,c,ITM_COOKIE_EXPIRY)}}function ITMresetCookie(a,b){COOKIEcreate(a,b,ITM_COOKIE_EXPIRY)}function ITMgetItems(a){return a.find('input[type="hidden"]')}
function ITMitemToRequest(a){var b=a.data("Id"),c={Id:b},d=a.data("ViewMode");if(d)c.ViewMode=d;a=a.parent();if(a.find("div.chunk:first").size()!=0){if(b=ITMgetVisibleChunks(a)){if(b.length>0)c.Chunk=b[0];if(b.length>1)c.ExtraChunk=b[1]}}else c.ExpansionTree=NTRgetExpansionTreeFromCookie(b);return c}function ITMitemsToRequests(a,b){for(var c=0;c<a.length;c++){var d=$(a[c]);d.data("ContentIsStatic")||(b[b.length]=ITMitemToRequest(d))}}
function ITMcreateNewItem(a){var b=$('<input class="link_id" type="hidden" />');b.val(a);b.data("Id",a);return b}function ITMgetItemsFromCookie(a){var b=$([]);if(a=COOKIEread(a)){a=a.split("#");for(var c=0;c<a.length-1;++c){var d=a[c].split(":"),e=ITMcreateNewItem(d[0]);e.data("ViewMode",d[1]);b=b.add(e)}}return b}function ITMtriggerScrollEvent(a){ITMgetContentDiv(a).trigger("scroll")}
function ITMclearItemSpecificLocalData(a,b){COOKIEerase(b+"_expanded_tree_nodes");ITM_HELP_ID==b&&ITMremoveMostRecentHelp(a)}var ITMstoreMostRecentHelp,ITMretrieveMostRecentHelp,ITMremoveMostRecentHelp,key=function(a){return a.ifware.ChannelGuid+"_"+a.ifware.User+"_MostRecentHelpHtml"};ITMstoreMostRecentHelp=function(a,b){var c=b.clone().wrap("<p>").parent().html();ifware.storage.set(key(a),c,ITM_COOKIE_EXPIRY)};ITMretrieveMostRecentHelp=function(a){return $(ifware.storage.get(key(a))||"<span>No function selected.</span>")};
ITMremoveMostRecentHelp=function(a){ifware.storage.remove(key(a))};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function NAVheader(a){var b=MPRapp.header;b+="<span class='crumb'>"+a+"</span>";b+="</div>";b+="<div class='content_main'>";return b}function NAVfooter(){return"</div>"};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var NTRtoJson=JSON&&JSON.stringify?JSON.stringify:$.toJSON;function NTRcreateTreeNode(a){var b="nt_"+a.pt+"_"+a.nt,c="";if(a.e){b+=" e";c="e"}if(a.r)b+=" r";var d=!a.l&&a.c;b=TRVcreateNode(a,c,b,!a.l,d,d?a.ev:a.cv,NTRonNodeToggled);if(d){d=TRVgetChildContainer(b);for(c=0;c<a.c.length;c++)d.appendChild(NTRcreateTreeNode(a.c[c]))}return b}
function NTRscrollToChildren(a,b){var c=a.closest("ul.ifwareTreeview").parent(),d=c.scrollTop(),e=c.innerHeight(),f=$(b).position().top,g=$(b).outerHeight();f=f+g+20;if(f-d>e){g=d=a.position().top;if(f-d<e)g=f-e+5;c.stop().animate({scrollTop:g},"fast")}}function NTRgetNodeAddress(a){var b=a.data("DataNode"),c={};for(c[b.n]={};!a.closest("ul").hasClass("ifwareTreeview");){a=a.parent().closest("li");b=a.data("DataNode");var d={};d[b.n]=c;c=d}return c}
var NTRrequestChildren=function(){var a=ScriptRunnerDict();return function(b,c,d){d.addClass("waiting");var e=d.closest("li");e=NTRgetNodeAddress(e);e=NTRtoJson(e);var f=c.data("Id"),g=c.data("BranchUrl"),j=c.data("BranchVars"),l={Id:f,RootAddress:e};for(VarKey in j)l[VarKey]=j[VarKey];a(f+":"+e).post(g,l,function(h){d.removeClass("waiting");if(h.ErrorMessage){$(b).addClass("error").text(h.ErrorMessage);NTRonErrorResponse&&NTRonErrorResponse(h)}else{h=h.Root.c;for(var q=h.length,p=0;p<q;++p)b.appendChild(NTRcreateTreeNode(h[p]));
NTRshowOrHideEmptyNodes(c);NTRscrollToChildren(d,b)}},function(){d.removeClass("waiting");$(b).addClass("error").text("Request cancelled")})}}();function NTRonNodeToggled(a,b,c,d){var e=TRVgetTreeRoot(c),f=e.data("CookieName");if(d){b.innerHTML=a.ev;NTRrequestChildren(c,e,$(b))}else{b.innerHTML=a.cv;NTRshowOrHideEmptyNodes(e)}a=NTRgetExpansionTree(e.get(0));if(f){a=a.replace(/^{('|")r('|"):{}}$/,"");""!=a?COOKIEcreate(f,a,60):COOKIEerase(f)}}
function NTRpopulateExpansionTree(a,b){a=$(a);TRVgetChildren(a).each(function(){var c=$(this).data("DataNode");if(c.n!=""&&!b[c.n])b[c.n]={};var d=TRVgetChildContainer(this);NTRpopulateExpansionTree(d,b[c.n])})}function NTRgetDropdown(a){return a.closest(".content").siblings(".emptyNodeDropdown")}function NTRshowOrHideEmptyNodes(a){var b=a.find("li.e");a.data("ShowEmptyNodes")?b.show():b.hide();a=NTRgetDropdown(a);b.size()>0?a.show():a.hide()}
function NTRgetExpansionTree(a){var b={};NTRpopulateExpansionTree(a,b);return NTRtoJson(b)}function NTRgetExpansionTreeFromCookie(a){return COOKIEread(a+"_expanded_tree_nodes")}
function NTRinitTreeview(a,b,c,d,e,f){b.innerHTML="";var g=c.data("Id"),j=c.data("ViewMode")=="show_empty_nodes",l=g+"_expanded_tree_nodes",h=$(b);f&&h.data("CookieName",l);h.data("Id",g).data("BranchUrl",d).data("BranchVars",e).data("ShowEmptyNodes",j);b.appendChild(NTRcreateTreeNode(a));NTRgetDropdown(h).remove();a=$('<div class="emptyNodeDropdown">                         <label title="This tree contains some empty nodes. You can select whether or not you want these nodes to be visible.">                            <input type="checkbox" name="showEmptyNodes" />                            Show Empty Nodes                         </label>                      </div>');h.closest(".content").after(a);
a=a.find("input");j&&a.attr("checked","checked");a.change(function(){var q=$(this).is(":checked");c.data("ViewMode",q?"show_empty_nodes":"hide_empty_nodes");c.trigger(ITM_VIEW_MODE_CHANGE_EVENT,[c]);h.data("ShowEmptyNodes",q);NTRshowOrHideEmptyNodes(h)});NTRshowOrHideEmptyNodes(h)}var NTRonErrorResponse=null;/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function POPdialogs(a){function b(m){return $("div.ANNpopup:has(input.link_id[value="+m+"])")}function c(m){m=b(m).siblings("div.ui-dialog-titlebar");var s=$("<div class='highlight_title' />").prependTo(m);s.fadeOut("slow",function(){s.remove()})}function d(m){m=m.parents().filter(".ANNouterPopup");COOKIEcreate(G,m.position().top,ITM_COOKIE_EXPIRY);COOKIEcreate(E,m.position().left,ITM_COOKIE_EXPIRY);COOKIEcreate(F,m.width(),ITM_COOKIE_EXPIRY);COOKIEcreate(J,m.height(),ITM_COOKIE_EXPIRY)}function e(m,
s,v,x){if(o+I-20<m+v||M+K-20<s+x)return false;if(o>m||M>s)return false;v=$("div.ANNouterPopup");x={};x.key={};x.val={};for(var C=0;C<v.length;C++){var D=v.eq(C);x.key[C]=[D.position().left,D.position().top];x.val[C]=D}D=false;for(C=0;C<v.length;C++)if(m==x.key[C][0]&&s==x.key[C][1])break;if(C==v.length)D=true;return D}function f(m,s,v,x){var C=m+n,D=s+n;if(e(C,D,v,x))return[C,D];C=m-n;D=s-n;if(e(C,D,v,x))return[C,D];C=m-n;D=s+n;if(e(C,D,v,x))return[C,D];C=m+n;D=s-n;if(e(C,D,v,x))return[C,D];return null}
function g(m,s,v,x){var C=f(m,s,v,x);if(null!=C)return C;C=f(m+n,s,v,x);if(null!=C)return C;C=f(m,s+n,v,x);if(null!=C)return C;C=f(m-n,s,v,x);if(null!=C)return C;C=f(m,s-n,v,x);if(null!=C)return C;return[o+(I-v)/2,M+(K-x)/2]}function j(m,s){m.append(s);var v=s.data("Id"),x=$("div.CodeMirror-scroll").height()/2,C=$("div.CodeMirror-scroll").width()/2,D=M+(K-x)/2,L=o+(I-C)/2;if(null!=COOKIEread(G)){x=parseInt(COOKIEread(J));C=parseInt(COOKIEread(F));D=parseInt(COOKIEread(G));L=parseInt(COOKIEread(E));
D=g(L,D,C,x)}else D=[L,D];m.dialog({focus:function(){if(!(u.length>0&&u[u.length-1]==v)){z(v);u.push(v)}},close:function(){ITMremoveItemFromCookie(H,v);$(this).dialog("destroy").remove();z(v);A.ifware.focusLastFocussedElement()},autoOpen:false,width:C,height:x,position:D,dialogClass:"ANNouterPopup",minWidth:230});m.dialog("open");d(m);$(".ANNouterPopup").filter(":last").css("position","absolute").css("top",D[1]).css("left",D[0]);m.unbind().bind("dialogfocus",function(){ITMpushItemToCookie(H,s);d(m)}).bind("dialogbeforeclose",
function(){ITMclearItemSpecificLocalData(A,v)}).bind("dialogdragstop",function(){d(m)}).bind("dialogresizestop",function(){d(m)}).bind(ITM_VIEW_MODE_CHANGE_EVENT,function(P,O){ITMupdateCookie(H,O)})}function l(){if(null!=COOKIEread(G)){var m=parseInt(COOKIEread(J)),s=parseInt(COOKIEread(F));COOKIEcreate(G,M+(K-m)/2-n,ITM_COOKIE_EXPIRY);COOKIEcreate(E,o+(I-s)/2-n,ITM_COOKIE_EXPIRY)}ITMgetItemsFromCookie(H).each(function(){var v=$(this),x=r(v);if(ITM_HELP_ID==v.data("Id")){var C=ITMretrieveMostRecentHelp(A);
p(v,x,C);prettyPrint()}ifware.Editor.ifware.projectSettings.disableAutoScriptExecution()&&POPdialogsController.setAnnotationToDefaultForAutoScriptExecutionDisabled(v)})}function h(m,s){setTimeout(function(){t(m,s)},0)}function q(m,s,v){var x=m.dialog("widget").find("div.title.ntv:first");x[0].className="title ntv "+v;Title=$(x[0]);if("waiting"==v)Title.html("Refreshing&hellip;");else{v=s.data("Title")||" ";v=v.replace(/\s/g,"&nbsp;");Title.html(v);v=m.parents(".ui-dialog").find(".ui-dialog-titlebar");
$('<a title="Snap to dock" href="#" class="ui-corner-all ui-dialog-titlebar-dock"><span class="ui-icon ui-icon-arrowthick-1-sw">dock</span></a>').appendTo(v).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}).bind("click",function(C){C.preventDefault();DCKdockController.tabFromExisting(s);DCKdockController.selectTab(s.data("Id"));m.unbind("dialogbeforeclose").dialog("close");COOKIEcreate("isdockable","true",ITM_COOKIE_EXPIRY)});v.find(".ui-icon").attr("style",
"background-image:url(/js/jquery-ui-1-8-16/css/ui-lightness/images/ui-icons_847e71_256x240.png);")}}function p(m,s,v){var x=ITMsetLabelInfo(m,ITM_HELP_TITLE,undefined,undefined,"help");q(s,m,x);ITMrenderStaticView(m,v);ITMstoreMostRecentHelp(A,v)}function t(m,s){var v=b(s.data("Id"));if(v.length)if(m.ErrorMessage){var x=ITMsetLabelInfo(s,"Error",undefined,undefined,"error");q(v,s,x);ITMrenderErrorView(m,s)}else if(m.Root){ITMsetTooltip(m,s);x=ITMsetLabelInfo(s,m.Root.title,m.Root.pt,m.Root.nt,"error");
q(v,s,x);ITMrenderTreeviewView(A,m,s)}else if(m.ChunkInfo){ITMsetTooltip(m,s);x=ITMsetLabelInfo(s,m.title,m.pt,m.nt,"error");q(v,s,x);ITMrenderGenericView(A,m,s)}}function r(m){var s=m.data("Id");s=b(s);if(!s.length){s=$("<div class='ANNpopup'></div>").appendTo($("body"));s.attr("title",y);j(s,m)}return s}function w(m,s){var v=b(s.data("Id")),x=ITMsetLabelInfo(s,ITM_ERROR_STACK_TITLE,undefined,undefined,"error_stack");q(v,s,x);ITMpopulateErrorStackTrace(A,m,s)}function z(m){m=u.indexOf(m);m!=-1&&
u.splice(m,1)}var y="<div class='title ntv waiting'>Refreshing&hellip;</div>",A=a,B,G,E,F,J,H,K=0,I=0,M=0,o=0,n=30,u=[];this.setEditorDimensions=function(){var m=$("div.CodeMirror-scroll");if(m.length){K=m.height();I=m.width();o=m.position().left;M=83}};this.moveDialogs=function(){$.each($("div.ANNpopup"),function(){var m=$(this).parents().filter(".ANNouterPopup"),s=m.position().left,v=m.position().top,x=false,C=m.height(),D=m.position().top;if(C+D>K+M){x=true;v=K+M-m.height()}C=m.width();D=m.position().left;
if(C+D>I+o){x=true;s=I+o-m.width()}x&&$(this).dialog("option","position",[s,v])})};this.dialog=function(m){m=ITMcreateNewItem(m);r(m);ITMpushItemToCookie(H,m)};this.bringToFrontAndHighlightDialog=function(m){var s=b(m);if(s.length){s.dialog("moveToTop");c(m);ITMpushItemToCookie(H,ITMgetItems(s))}};this.errorStackDialog=function(m,s){var v;if(POPdialogsController.dialogExists(ITM_ERROR_STACK_ID)){v=b(ITM_ERROR_STACK_ID).dialog("moveToTop");v=ITMgetItems(v);s&&c(ITM_ERROR_STACK_ID)}else{v=ITMcreateNewItem(ITM_ERROR_STACK_ID);
r(v);w(m,v)}ITMpushItemToCookie(H,v)};this.setHelpContent=function(m,s){var v=b(m),x=ITMgetItems(v);p(x,v,s)};this.dialogExists=function(m){return b(m).length>0};this.refresh=function(m,s,v){ITMgetItems($("div.ANNpopup")).each(function(){var x=$(this),C=x.data("Id");if(!x.data("ContentIsStatic"))if(v)t({ErrorMessage:"Script did not finish executing because it was cancelled by the user."},x);else if(ITM_ERROR_STACK_ID==C)w(s,x);else m[C]?h(m[C],x):t({ErrorMessage:"Unknown error."},x)})};this.getFullArgumentRequests=
function(m){var s=ITMgetItems($("div.ANNpopup"));ITMitemsToRequests(s,m)};this.beforeRefresh=function(){$("div.ANNpopup").each(function(){var m=ITMgetItems($(this));m.data("ContentIsStatic")||q($(this),m,"waiting")})};this.init=function(m){A=m;B=A.ifware.ChannelGuid+"_"+A.ifware.User;G=B+"_PopupTop";E=B+"_PopupLeft";F=B+"_PopupWidth";J=B+"_PopupHeight";H=B+"_OpenedPopup";POPdialogsController.setEditorDimensions();l();$(window).resize(function(){POPdialogsController.setEditorDimensions();POPdialogsController.moveDialogs()})};
this.dialogFromExisting=function(m){var s=m.data("LabelClass"),v=m.siblings().detach(),x=r(m);x.append(v);q(x,m,s);ITMtriggerScrollEvent(x);ITMpushItemToCookie(H,m)};this.closeFrontmostPopup=function(){if(u.length>0){var m=u.pop();b(m).dialog("close");return true}return false};this.setAnnotationToDefaultForAutoScriptExecutionDisabled=function(m){t({ChunkInfo:{Chunks:[{ChunkNumber:0,Value:'To display this object <a href="#" class="execScriptButton executeNowText">run the script now</a>.'}],TotalChunks:1,
LinesInLastChunk:7},title:"&nbsp;",file_name:"",funct_name:"",call:1,line:-1},m);m=$(".execScriptButton");m.unbind("click");m.click(function(s){s.preventDefault();$(ifware).trigger("ExecuteScriptOnce")})}}var POPdialogsController=new POPdialogs;/*

 Copyright (c) 2010-2014 iNTERFACEWARE Inc.  All rights reserved.
*/
var tmpChannelGuid;function PRJinitProjectManager(a,b,c){c.prepend('<div class="PRJtitle"><span>Project Files</span></div><div id="PRJcontents" />');c=c.find("#PRJcontents");c.mouseover(function(){$("div.PRJfileContextMenu").remove()});b.ifware.ProjectManager=c;PRJrefreshProjectManager(a,b)}function PRJonFolderToggled(a,b,c,d){d&&PRJappendFileNodes(c,a)}
function PRJonFileClicked(a,b){console.log("Caught click.");console.log(a);if(PAGcurrentModule!=a.label){NISgoToFile(a.label);$(b).addClass("w")}}function PRJdiffFile(a){SCMshowDiffRequest(a.editor,"","","",a.label,"",{modal:true,showWaiting:true,friendlyError:true})}function PRJshouldShowDiff(a){return a.status!="unchanged"&&a.status!="new"}function PRJfileHistory(a){SCMviewFileHistoryRequest(a.editor,a.label,a.type)}
function PRJexportProject(a){a=a.editor;!a.ifware.UsesParameter||a.ifware.CountOfSampleData==0?SCMexportRequest(a.ifware.ChannelGuid,false):SCMincludeSampleConfirm(a.ifware.ChannelGuid)}function PRJimportProject(a){NISsave(a.editor,function(b){SCMimportProjectAndData(b)})}
function PRJdoRemoveFile(a,b,c){c.html('<img src="/js/mapper/images/spinner.gif" /> Removing '+PAGhtmlEscape(a.label)+"...");c.dialog("option","buttons",{});c.bind("dialogbeforeclose",function(){return false});var d={};d.ChannelGuid=a.editor.ifware.ChannelGuid;d.File=a.label;Ajax.post("/remove_project_file",d,function(e){c.unbind("dialogbeforeclose");if(e.ErrorMessage){c.html('<span class="PRJerror">'+e.ErrorMessage+"</span>");c.dialog("option","buttons",{OK:function(){c.dialog("close")}})}else{c.dialog("close");
b.remove();e=a.editor;if(a.current){var f=location.href;f=f.replace(/&Module=[^&]*/g,"");location.href=f+"&Module="+e.ifware.MainLuaFile}else NISupdateAnnotations(e)}},"json")}
function PRJremoveFile(a,b){$("#EDTconfirmDialog").remove();var c={};c.No=function(){$(this).dialog("close")};c.Yes=function(){PRJdoRemoveFile(a,b,$(this))};$('<div id="EDTconfirmDialog"><p>Are you sure you want to remove this file from the project?</p>    <p>Warning: if the file is still in use by your script, it will be automatically added to the project again.</div>').appendTo("body").dialog({title:"Remove File",width:375,modal:true,draggable:false,resizable:false,buttons:c})}
function PRJdownloadFile(a,b){a.attr("target","_blank");a.attr("href","/download_project_file?FilePath="+encodeURIComponent(b.path)+"&FileLabel="+encodeURIComponent(b.label)+"&FileType="+encodeURIComponent(b.type)+"&ChannelGuid="+b.editor.ifware.ChannelGuid)}
function PRJcheckExtension(a,b,c){var d=/\.\w+$/,e=d.exec(a.path);b=d.exec(b.val());e=e?e[0]:"no extension";b=b?b[0]:"no extension";if(e==b)return true;else{$("#PRJextensionWarning").remove();var f=$('<div id="PRJextensionWarning">                         <p class="PRJerror">The file extension of the existing file ('+e+") does not match the extension of the new file ("+b+").</p>                         <p>Are you sure you want to replace the contents of "+PAGhtmlEscape(a.label)+" with the contents of the new file?</p>                        </div>").appendTo("body");
a={};a.Cancel=function(){f.dialog("close")};a.Replace=function(){f.dialog("close");c&&c()};f.dialog({modal:false,width:375,title:"File Extensions Don't Match",draggable:false,resizable:false,buttons:a});return false}}
function PRJcheckModuleName(a,b){var c=/\.\w+$/.exec(a.val());c=c?c[0]:"no extension";if(c==".lua")return true;else{$("#PRJextensionWarning").remove();var d=$('<div id="PRJextensionWarning">                         <p class="PRJerror">The file extension ('+c+") indicates that this is not a Lua file.</p>                         <p>Are you sure you want to upload "+PAGhtmlEscape(a.val())+" as a Lua module?</p>                        </div>").appendTo("body");c={};c.No=function(){d.dialog("close")};
c.Yes=function(){d.dialog("close");b&&b()};d.dialog({modal:false,width:"auto",title:"File is not a Lua Module",draggable:false,resizable:false,buttons:c});return false}}
function PRJdoUploadFile(a,b,c,d,e){if(e||PRJcheckExtension(a,c,function(){PRJdoUploadFile(a,b,c,d,true)})){d.dialog("option","buttons",{});d.bind("dialogbeforeclose",function(){return false});AFUuploadFile("/upload_project_file",b,function(){c.attr("disabled","disabled").after('<img src="/js/mapper/images/spinner.gif" />')},function(f){d.unbind("dialogbeforeclose");if(f.ErrorMessage){d.html('<span class="PRJerror">'+f.ErrorMessage+"</span>");d.dialog("option","buttons",{OK:function(){d.dialog("close")}})}else{d.dialog("close");
a.editor.ifware.CurrentFileName==a.label?NISreloadCurrentFile(a.editor):NISupdateAnnotations(a.editor)}})}}
function PRJuploadFile(a){$("#PRJuploadDialog").remove();var b='<div id="PRJuploadDialog">                 <form>                  <input type="file" name="NewFile" />                  <input type="hidden" name="ChannelGuid" value="'+a.editor.ifware.ChannelGuid+'" />                  <input type="hidden" name="FileLabel" value="'+PAGhtmlEscape(a.label)+'" />                  <input type="hidden" name="FileType" value="'+PAGhtmlEscape(a.type)+'" />                 </form>                </div>',c=
$(b).appendTo("body"),d=c.find("form");d.find('input[type="file"]').change(function(){PRJdoUploadFile(a,d,$(this),c)});c.dialog({modal:true,title:"Replace "+PAGhtmlEscape(a.label),minHeight:85,resizable:false,buttons:{Cancel:function(){c.dialog("close")}}})}
var PRJoptionDiff={name:"Diff",className:"PRJoptionDiff",func:PRJdiffFile,shouldShowFunc:PRJshouldShowDiff},PRJoptionFileHistory={name:"File History",className:"PRJoptionFileHistory",func:PRJfileHistory},PRJoptionExportProject={name:"Export Project",className:"PRJoptionDownload",func:PRJexportProject},PRJoptionImportProject={name:"Import Project",className:"PRJoptionUpload",func:PRJimportProject},PRJoptionRemove={name:"Remove",className:"PRJoptionRemove",func:PRJremoveFile},PRJoptionDownload={name:"Get",
className:"PRJoptionDownload",hrefFunc:PRJdownloadFile},PRJoptionUpload={name:"Replace",className:"PRJoptionUpload",func:PRJuploadFile};function PRJaddFileToProject(a,b,c){Ajax.post("/add_project_file",{ChannelGuid:a.ifware.ChannelGuid,FileLabel:b,IsModule:c},function(d){if(d.ErrorMessage)console.log(d.ErrorMessage);else if(d.file_info){PRJrefreshProjectManager(d.file_info,a);NISupdateAnnotations(a)}},"json")}
function PRJdoNewFileUpload(a,b,c,d,e,f){function g(){a.dialog("option","buttons",{});a.bind("dialogbeforeclose",function(){return false});AFUuploadFile("/upload_project_file",b,function(){c.attr("disabled","disabled").after('<img src="/js/mapper/images/spinner.gif" />')},function(j){a.unbind("dialogbeforeclose");if(j.ErrorMessage){a.html('<span class="PRJerror">'+j.ErrorMessage+"</span>");a.dialog("option","buttons",{OK:function(){a.dialog("close")}})}else{a.dialog("close");f(j.FileLabel)}})}if(e)PRJcheckModuleName(c,
g)&&g();else g()}function PRJnewModuleError(a,b,c){a.find("#PRJnewModuleError").text(c);b.get(0).focus();return true}
function PRJdoAddNewModule(a,b,c,d){var e=jQuery.trim(c.val());if(e=="")PRJnewModuleError(a,c,"You must enter a name for the new module.");else{c.attr("disabled","disabled");b.css("display","none").after('<img src="/js/mapper/images/spinner.gif" />');a.bind("dialogbeforeclose",function(){return false});Ajax.post("/add_new_module",{ChannelGuid:d.ifware.ChannelGuid,FileLabel:e},function(f){a.unbind("dialogbeforeclose");if(f.ErrorMessage){c.attr("disabled","");b.css("display","").next().remove();PRJnewModuleError(a,
c,f.ErrorMessage)}else{a.dialog("close");PRJrefreshProjectManager(f.file_info,d);NISupdateAnnotations(d)}})}}
function PRJdoAddExistingFile(a,b,c,d){var e=b.val();if(e!=""){b.attr("disabled","disabled").after('<img src="/js/mapper/images/spinner.gif" />');a.bind("dialogbeforeclose",function(){return false});Ajax.post("/add_project_file",{ChannelGuid:d.ifware.ChannelGuid,FileLabel:e,IsModule:c},function(f){a.unbind("dialogbeforeclose");if(f.ErrorMessage){a.html('<span class="PRJerror">'+f.ErrorMessage+"</span>");a.dialog("option","buttons",{OK:function(){a.dialog("close")}})}else{a.dialog("close");PRJrefreshProjectManager(f.file_info,
d);NISupdateAnnotations(d)}})}}function PRJinFileSet(a,b){for(var c=0;c<b.length;c++)if(a==b[c].label)return true;return false}
function PRJaddOtherFile(a,b){Ajax.post("/get_all_other_files",{ChannelGuid:a.ifware.ChannelGuid},function(c){var d;if(c.ErrorMessage)d='<span class="PRJerror">Could not retrieve list of existing files. Reason:<br />'+c.ErrorMessage+"</span>";else if(c.length){d='<select><option value=""></option>';for(var e=0;e<c.length;e++)if(!PRJinFileSet(c[e],b)){var f=PAGhtmlEscape(c[e]);d+='<option value="'+f+'">'+f+"</option>"}d+="</select>"}else d="There are no existing files.";$("#PRJaddOtherFileDialog").remove();
var g=$('<div id="PRJaddOtherFileDialog"><table>                  <tr><td><fieldset><legend>Add a new file</legend>                   <form>                    <input type="file" name="NewFile" size="15" />                    <input type="hidden" name="ChannelGuid" value="'+a.ifware.ChannelGuid+'" />                   </form>                  </fieldset>                  <tr><td><fieldset><legend>Or select an existing file</legend>'+d+"                  </fieldset>                 <table></div>").appendTo("body").dialog({modal:true,
title:"Add File",resizable:false,buttons:{Cancel:function(){$(this).dialog("close")}}}),j=g.find("form");j.find('input[type="file"]').change(function(){PRJdoNewFileUpload(g,j,$(this),a,false,function(l){PRJaddFileToProject(a,l,false)})});g.find("select").change(function(){PRJdoAddExistingFile(g,$(this),"false",a)})})}
function PRJaddSharedFile(a,b){Ajax.post("/get_all_shared_files",{ChannelGuid:a.ifware.ChannelGuid},function(c){var d;if(c.ErrorMessage)d='<span class="PRJerror">Could not retrieve list of existing modules. Reason:<br />'+c.ErrorMessage+"</span>";else if(c.length){d='<select><option value=""></option>';for(var e=0;e<c.length;e++)if(!PRJinFileSet(c[e],b)){var f=PAGhtmlEscape(c[e]);d+='<option value="'+f+'">'+f+"</option>"}d+="</select>"}else d="There are no existing modules.";$("#PRJaddSharedFileDialog").remove();
var g=$('<div id="PRJaddSharedFileDialog"><table>                  <tr><td><fieldset><legend>Create a new module</legend>                   <table><tr>                    <td><input type="text" />                    <td><div class="BTNbuttons"><a id="PRJsubmitNewShared" href="#">Create</a>                   </table>                   <div id="PRJnewModuleError" class="PRJerror"></div>                  </fieldset>                  <tr><td><fieldset><legend>Or upload a module</legend>                   <form>                    <input type="file" name="NewFile" size="15" />                    <input type="hidden" name="ChannelGuid" value="'+
a.ifware.ChannelGuid+'" />                    <input type="hidden" name="FileType" value="lua" />                   </form>                  </fieldset>                  <tr><td><fieldset><legend>Or select an existing module</legend>'+d+"                  </fieldset>                 </table></div>").appendTo("body").dialog({modal:true,title:"Add Module",resizable:false,buttons:{Cancel:function(){$(this).dialog("close")}}}),j=g.find("form");j.find('input[type="file"]').change(function(){PRJdoNewFileUpload(g,
j,$(this),a,true,function(h){PRJaddFileToProject(a,h,true)})});var l=g.find("#PRJsubmitNewShared").click(function(h){h.preventDefault();PRJdoAddNewModule(g,$(this),g.find('input[type="text"]'),a)});g.find('input[type="text"]').keypress(function(h){(window.event?event.keyCode:h.keyCode)==13&&l.trigger("click")});g.find("select").change(function(){PRJdoAddExistingFile(g,$(this),"true",a)})})}
function PRJopenFileContextMenu(a){a.stopPropagation();var b=$(this).find("img"),c=b.offset();if(c){$("div.PRJfileContextMenu").remove();var d=$('<div class="PRJfileContextMenu"><div class="PRJleft" /><div class="PRJinner" /></div>'),e=d.find("div.PRJinner"),f=a.data,g=b.closest("li");for(a=0;a<f.options.length;a++){b=f.options[a];var j=b.shouldShowFunc;if(!j||j(f,g)){j=$('<a href="#"><div class="'+b.className+'">'+b.name+"</div></a>").appendTo(e);b.hrefFunc&&b.hrefFunc(j,f);j.bind("click",b,function(l){d.remove();
if(l.data.func){l.preventDefault();l.data.func(f,g)}else window.MiniLogin&&!MiniLogin.loggedIn()&&l.preventDefault()})}}d.appendTo(document.body).bind("mouseleave",d,PRJcloseFileContextMenu);d.css("left",c.left+15+"px");d.css("top",c.top-5+"px");d.fadeIn("fast")}}function PRJcloseFileContextMenu(a){$(a.data).remove()}
function PRJcreateFileNode(a,b,c,d){a.editor=b;a.options=d;d="PRJfile PRJft_"+a.type+" PRJfs_"+a.status;if(a.current){b.ifware.LuaFileSourceHash=a.sourceHash;d+=" c"}if(c)d+=" s";b=PAGhtmlEscape(a.label)+' <a class="PRJcontextMenuButton"><img src="/js/treeview/images/arrow-contracted.gif" /></a>';c=TRVcreateNode(a,"",d,false,false,b,null,c?PRJonFileClicked:null);$(c).find("a.PRJcontextMenuButton").bind("mouseenter",a,PRJopenFileContextMenu);return c}
function PRJappendFileNodes(a,b,c){var d=b.files;console.log("Appending file nodes.");console.log(b);console.log(c);for(var e=0;e<d.length;e++){console.log(d[e]);a.appendChild(PRJcreateFileNode(d[e],b.editor,d[e].editable,c))}}
function PRJrefreshProjectManager(a,b){console.log("Info next.");console.log(a);var c=b.ifware.ProjectManager,d=!c.find("li.shared").hasClass("expandable"),e=!c.find("li.other").hasClass("expandable"),f=document.createElement("ul");f.className="ifwareTreeview";var g=c.siblings("div.PRJtitle").children("span");a.project.status=="unchanged"?g.removeClass("PRJps_edited").attr("title",""):g.addClass("PRJps_edited").attr("title","Files have been added/removed since the last saved milestone.");f.appendChild(PRJcreateFileNode(a.main,
b,true,[PRJoptionDownload,PRJoptionUpload,PRJoptionDiff,PRJoptionFileHistory,PRJoptionExportProject,PRJoptionImportProject]));g={files:a.shared,editor:b};var j=TRVcreateNode(g,"shared","PRJfolder",true,d,'shared [<a href="#" id="PRJaddShared">Add...</a>]',PRJonFolderToggled);d&&PRJappendFileNodes(TRVgetChildContainer(j),g,[PRJoptionDownload,PRJoptionUpload,PRJoptionDiff,PRJoptionFileHistory,PRJoptionRemove]);f.appendChild(j);d={files:a.other,editor:b};g=TRVcreateNode(d,"other","PRJfolder",true,e,
'other [<a href="#" id="PRJaddOther">Add...</a>]',PRJonFolderToggled);if(e){e=[PRJoptionDownload,PRJoptionUpload,PRJoptionDiff,PRJoptionFileHistory,PRJoptionRemove];if(MPRapp&&MPRapp.ExtraOtherFileMenuOptions)e=e.concat(MPRapp.ExtraOtherFileMenuOptions);PRJappendFileNodes(TRVgetChildContainer(g),d,e)}f.appendChild(g);$(f).find("span.PRJfs_new").attr("title","File has been created since last saved milestone.").end().find("span.PRJfs_edited").attr("title","File has been modified since last saved milestone.").end().find("span.PRJfs_missing").attr("title",
"Problem encountered while loading file.");c.empty().append(f).find("a#PRJaddOther").click(function(l){l.preventDefault();l.stopPropagation();PRJaddOtherFile(b,a.other)}).end().find("a#PRJaddShared").click(function(l){l.preventDefault();l.stopPropagation();PRJaddSharedFile(b,a.shared)})}function PRJrequestProjectManagerRefresh(a){Ajax.post("/project_files",{ChannelGuid:a.ifware.ChannelGuid},function(b){b.ErrorMessage||PRJrefreshProjectManager(b.file_info,a)})};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var CurrentChunk=0;
function SPDview(a){var b={Guid:PAGgetField(a,"ChannelGuid"),Name:PAGgetOptionalField(a,"ChannelName")},c=MAPretrieveHeaderHTML("message_preview",a);c+='<div class="content_main">';c+='<div class="EDTtoolbar_wrapper">';c+='<div class="back"><span class="label">';c+="&larr; Back to:&nbsp;&nbsp;";c+=PAGlink("OpenEditor",MAPretrieveParams("lua_editor",a),"Script");c+="</span></div>";c+='<span class="heading">Sample Data</span>';c+="</div>";c+='<div class="SPDnavPane"></div>';c+='<div class="SPDnavPanePadding"></div>';c+=
'<div class="SPDdataTable"></div>';c+='<div id="status"></div>';c+="</div>";$("body").html(c);SPDimportDialog(b,a);if(!a.Chunk&&!a.Index)a.Chunk=0;a.MPRapp=MPRapp.type;Ajax.post("/sample_preview",a,function(d){SPDrenderEncodings(d);SPDrenderSampleDataView(d,a)},"json")}
function SPDrenderEncodings(a){function b(d){$.each(a.Encodings,function(e,f){f.Name&&f.Desc&&d(f)&&$("<option></option>").attr("value",f.Name).text(f.Desc).appendTo(c)})}var c=$('select[name="SPDimportEncoding"]');b(function(d){return d.Default});c.append('<option value="">Binary (no conversion)</option>');c.append('<option value="no encoding selected">--</option>');b(function(d){return!d.Default})}
function SPDpreviewRow(a,b,c){c.Id=a.id;c.NewMsg=0;c.Index=a.index+1;return"<tr"+(b?' class="SPDnewRow"':"")+'><td class="SPDindex">'+(a.index+1)+'&nbsp;<td class = "SPDdeleteRow"><input type = "checkbox" class = "SPDdeleteBox" value = '+c.Id+'/><td class = "SPDsampleName" onclick = "location.href = \''+PAGhref("EditSampleData",c)+'\';" style = "cursor:pointer;width:200px;" title="Click to edit this message">'+a.name+'<td class = "SPDsampleText" onclick = "location.href = \''+PAGhref("EditSampleData",
c)+'\';" style = "cursor:pointer;" title="Click to edit this message">'+a.text}function SPDbutton(a,b,c,d){return d?PAGlink(a,c,b):'<a class="SPDdisabled">'+b+"</a>"}
function SPDupdateSampleDataView(a,b){if(a)if(a.ErrorMessage)MPRapp.renderError(a.ErrorMessage,b);else{CurrentChunk=a.Chunk;var c=a.CountOfChunk-1,d=a.CountOfMessage+" Messages";if(a.CountOfMessage)d=a.ChunkBegin+1+" to "+(a.ChunkEnd+1)+" of "+d;delete b.Index;delete b.Id;delete b.SDIndex;var e=b.SavedMsgIndex;delete b.SavedMsgIndex;b.Chunk=0;var f=SPDbutton("SampleData","&lt;&lt;",b,CurrentChunk>0);b.Chunk=Math.max(0,CurrentChunk-1);var g=SPDbutton("SampleData","&lt;",b,CurrentChunk>0);b.Chunk=Math.min(c,
CurrentChunk+1);var j=SPDbutton("SampleData","&gt;",b,CurrentChunk<c);b.Chunk=c;c=SPDbutton("SampleData","&gt;&gt;",b,CurrentChunk<c);delete b.Chunk;b.TotalSd=a.CountOfMessage;var l='<input type = "checkbox" class = "DeleteAll"  value = "abc"/><a class="SPDdeleteBTN">Delete</a>';l+=BTNwrapper(f+g+'<span class="SPDnavText">'+d+"</span>"+j+c);l+='<a class="SPDimportBTN">Import</a>';l+='<a class="SPDaddBTN" href = "">Add</a>';$("div.SPDnavPane").html(l);d='<table id="sample_data_table" class="SPDdataTable">';
f=a.Previews.length;g=a.Imported;for(j=0;j<f;j++)d+=SPDpreviewRow(a.Previews[j],SPDisNew(a,j,e),b);d+="</table>";$("div.SPDdataTable").html(d);SPDrowClickRegister();SPDpopulateAddNewSample(b,a.CountOfMessage);SPDalertBox("No messages are selected");SPDconfirmationDialog();$(".DeleteAll").change(function(){var h=$(this).attr("checked");$("input[class = SPDdeleteBox]").attr("checked",h)});$("input[class = SPDdeleteBox]").change(function(){$(this).attr("checked")==false&&$("input[class = DeleteAll]").attr("checked",
false)});$("a.SPDdeleteBTN").click(function(){if($("input[class = DeleteAll]:checked").length)b.TotalSd>0?$("#ConfirmBox").dialog("open"):$("#AlertBox").dialog("open");else $("input[class = SPDdeleteBox]:checked").length==0?$("#AlertBox").dialog("open"):$("#ConfirmBox").dialog("open")});$(".SPDimportBTN").click(function(){$(".SPDuploadDlg").dialog("open")});$("div#file_chooser").html('<input type="file" class="medium" id="import_file" name="ImportFile" />');$("#status").html("");$("input#SPDimportOverwrite").attr("checked",
false);$("div#SPDimportOverwriteContainer").toggle(f>0);if(g){e=$("#status");e.html('<span class="SPDsuccessMessage">'+a.Imported+" message"+(a.Imported!=1?"s":"")+" imported.</span>");e.get(0).scrollIntoView(false)}$("tr.SPDnewRow").each(function(){var h=$(this);h.removeClass("SPDnewRow");h.css("background-color","#C6FF83");setTimeout(function(){h.animate({"background-color":"#FDFDFD"},2E3)},4E3)})}else MPRapp.renderError("Unable to get sample data from server. Check if it is running.",b)}
function SPDrenderSampleDataView(a,b){function c(){p.fadeTo("fast",0.5);p.append('<div class="SPDnavPaneBlocker"><img src="/js/mapper/images/spinner_wide.gif" /></div>');p.find("div.SPDnavPaneBlocker img").fadeIn("slow")}if(a.ErrorMessage)MPRapp.renderError(a.ErrorMessage,b);else{var d={Guid:PAGgetField(b,"ChannelGuid"),Name:PAGgetOptionalField(b,"ChannelName")};CurrentChunk=a.Chunk;var e=a.CountOfChunk-1,f=a.CountOfMessage+" Messages";if(a.CountOfMessage)f=a.ChunkBegin+1+" to "+(a.ChunkEnd+1)+" of "+
f;delete b.Index;delete b.Id;delete b.SDIndex;var g=b.SavedMsgIndex;delete b.SavedMsgIndex;b.Chunk=0;var j=SPDbutton("SampleData","&lt;&lt;",b,CurrentChunk>0);b.Chunk=Math.max(0,CurrentChunk-1);var l=SPDbutton("SampleData","&lt;",b,CurrentChunk>0);b.Chunk=Math.min(e,CurrentChunk+1);var h=SPDbutton("SampleData","&gt;",b,CurrentChunk<e);b.Chunk=e;e=SPDbutton("SampleData","&gt;&gt;",b,CurrentChunk<e);delete b.Chunk;b.TotalSd=a.CountOfMessage;var q='<input type = "checkbox" class = "DeleteAll"  value = "abc"/><a class="SPDdeleteBTN">Delete</a>';
q+=BTNwrapper(j+l+'<span class="SPDnavText">'+f+"</span>"+h+e);q+='<a class="SPDimportBTN">Import</a>';q+='<a class="SPDaddBTN" href = "">Add</a>';$("div.SPDnavPane").html(q);f='<table id="sample_data_table" class="SPDdataTable">';j=a.Previews.length;for(l=0;l<j;l++)f+=SPDpreviewRow(a.Previews[l],SPDisNew(a,l,g),b);f+="</table>";$("div.SPDdataTable").html(f);SPDrowClickRegister();SPDpopulateAddNewSample(b,a.CountOfMessage);SPDalertBox("No messages are selected");SPDconfirmationDialog();$(".DeleteAll").change(function(){var t=
$(this).attr("checked");$("input[class = SPDdeleteBox]").attr("checked",t)});$("input[class = SPDdeleteBox]").change(function(){$(this).attr("checked")==false&&$("input[class = DeleteAll]").attr("checked",false)});$("a.SPDdeleteBTN").click(function(){if($("input[class = DeleteAll]:checked").length)b.TotalSd>0?$("#ConfirmBox").dialog("open"):$("#AlertBox").dialog("open");else $("input[class = SPDdeleteBox]:checked").length==0?$("#AlertBox").dialog("open"):$("#ConfirmBox").dialog("open")});$(".SPDimportBTN").click(function(){$(".SPDuploadDlg").dialog("open")});
0>=j&&$("div#SPDimportOverwriteContainer").hide();g=$("tr.SPDnewRow");g.each(function(){var t=$(this);t.removeClass("SPDnewRow");t.css("background-color","#C6FF83");setTimeout(function(){t.animate({"background-color":"#FDFDFD"},2E3)},4E3)});g.length>0&&g.last().children("td").first().get(0).scrollIntoView(false);var p=$("div.SPDnavPane");p.find("a").click(function(){this.href!=""&&c()});a.CountOfMessage&&p.find("span.SPDnavText").click(function(){var t=$("div.SPDgoto");if(t.size())t.remove();else{t=
$('<div class="SPDgoto">Go to <input type="text" class="SPDgotoInput" /><img src="/js/mapper/images/ok.png" /></div>');$("body").append(t);var r=p.offset();t.css("left",r.left+(p.outerWidth()-t.outerWidth())/2);t.css("top",r.top+p.outerHeight());var w=t.find("input");w.val(a.ChunkBegin+1);w.focus();w.select();var z=function(){var y=parseInt(w.val());if(isNaN(y)||y<1)y=1;else if(y>a.CountOfMessage)y=a.CountOfMessage;y--;if(a.Index!=y){window.location=PAGhref("SampleData",{ChannelGuid:d.Guid,ChannelName:d.Name,
Index:y});c()}t.remove()};w.keydown(function(y){if(y.keyCode=="13")z(y);else y.keyCode=="27"&&t.remove()});t.find("img").click(z)}})}}function SPDonImportBegin(a){$("#status").html('<img src="/js/mapper/images/spinner.gif" />');$("#import_file").attr("disabled","disabled");a=a.find("a[id='SPDimportButton']");a.attr("href","javascript:void(0);");a.css({opacity:".5",cursor:"default"})}
function SPDdeleteSampleData(a,b){Ajax.post("/delete_sample_data",{ChannelGuid:b,Ids:a},function(c){c.ErrorMessage?$("#status").html('<span class="SPDerrorMessage">'+c.ErrorMessage+"</span>"):SPDloadPage()})}function SPDdeleteSampleDataAll(a){Ajax.post("/delete_sample_data_all",{ChannelGuid:a},function(b){b.ErrorMessage?$("#status").html('<span class="SPDerrorMessage">'+b.ErrorMessage+"</span>"):SPDloadPage()})}
function SPDloadPage(){delete Params.Index;Params.Chunk=CurrentChunk;Ajax.post("/sample_preview",Params,function(a){SPDrenderEncodings(a);SPDupdateSampleDataView(a,Params)},"json")}function SPDpopulateAddNewSample(a,b){a.Index=b+1;a.NewMsg=1;$("a.SPDaddBTN").attr("href",PAGhref("EditSampleData",a))}
function SPDconfirmationDialog(){$("#ConfirmBox").remove();$(document).find("body").append('<div id="ConfirmBox" align="center">Delete selected messages ? </div>');var a={};a.Delete=function(){SPDconfirmAction()};a.Cancel=function(){$(this).dialog("close")};$("#ConfirmBox").dialog({bgiframe:true,width:300,height:130,title:"Confirm",position:"center",modal:true,autoOpen:false,buttons:a})}
function SPDconfirmAction(){if($("input[class = DeleteAll]:checked").length)SPDdeleteSampleDataAll(PAGgetField(Params,"ChannelGuid"));else{var a="";$("input[class = SPDdeleteBox]:checked").each(function(){a+=$(this).val()+","});SPDdeleteSampleData(a,PAGgetField(Params,"ChannelGuid"))}$("#ConfirmBox").dialog("close")}
function SPDalertBox(a){$("#AlertBox").remove();$(document).find("body").append('<div id="AlertBox" align = "center">'+a+"</div>");$("#AlertBox").dialog({bgiframe:true,width:250,height:130,title:"Alert",position:"center",modal:true,autoOpen:false,buttons:{OK:function(){$(this).dialog("close")}}})}
function SPDrowClickRegister(){$(".SPDsampleName").hover(function(){$(this).addClass("SPDrowHover");$(this).next().addClass("SPDrowHover")},function(){$(this).removeClass("SPDrowHover");$(this).next().removeClass("SPDrowHover")});$(".SPDsampleText").hover(function(){$(this).addClass("SPDrowHover");$(this).prev().addClass("SPDrowHover")},function(){$(this).removeClass("SPDrowHover");$(this).prev().removeClass("SPDrowHover")})}
function SPDimportDialog(a,b){$(".SPDuploadDlg").remove();$(document).find("body").append('<div class = "SPDuploadDlg"><form class="SPDuploadForm"><input type="hidden" name="MPRapp" value="'+MPRapp.type+'" /><input type="hidden" name="ChannelGuid" value="'+a.Guid+'" /><table class="import_table"><tr><td>Message file:</td><td><div id="file_chooser"><input type="file" class="medium" id="import_file" name="ImportFile" /></div></td></tr><tr><td>File encoding:<td><select name="SPDimportEncoding"></select><tr><td></td><td style="padding-top:0px;"><div id="SPDimportOverwriteContainer"><input type="checkbox" name="SPDimportOverwrite" id="SPDimportOverwrite" style="margin:0px;">&nbsp;Overwrite all existing samples</div></td></tr></table></form></div>');
var c={};c.Import=function(){$(".SPDuploadDlg").dialog("close");AFUuploadFile("/import_sample_data",$("form.SPDuploadForm"),SPDonImportBegin,SPDupdateSampleDataView,b)};c.Cancel=function(){$(".SPDuploadDlg").dialog("close")};$(".SPDuploadDlg").dialog({bgiframe:true,width:360,height:201,title:"Import Messages",position:"center",modal:true,autoOpen:false,buttons:c})}function SPDisNew(a,b,c){var d=a.Previews.length,e=a.Imported;a=a.ChunkBegin;return e&&b>=d-e||c&&a+b+1==c};/*

 Copyright (c) 2010-2014 iNTERFACEWARE Inc.  All rights reserved.
*/
function SPDEedit(a){var b={Guid:PAGgetField(a,"ChannelGuid"),Name:PAGgetOptionalField(a,"ChannelName")},c=MAPretrieveHeaderHTML("message_edit",a);c+='<div class="content_main floated_bottom"></div>';$(document).find("body").html(c);b=b.Guid;var d=a.NewMsg==0?PAGgetField(a,"Id"):-1;c='<div class="EDTtoolbar_wrapper"><span id="sample_data_control"></span>';c+='<div class="back"><span class="label">';c+="&larr; Back to:&nbsp;&nbsp;";c+='<a id="SPDsampleDataBackLink" href="'+PAGhref("SampleData",MAPretrieveParams("message_preview",
a))+'"> Sample Data </a>';c+='</span>|<span class="label">';c+='<a id="SPDscriptBackLink" href="'+PAGhref("OpenEditor",MAPretrieveParams("lua_editor",a))+'"> Script </a>';c+="</span></div>";c+='<span class="heading">Edit Message</span>';c+="</div>";c+='<div class="SPDeditorWrapper"><div style = "margin-top: 3px;"><span class="heading">Name</span></div><textarea id = "SPDnameEditor" class = "SPDeditor" style = "width:100%;height: 18px;margin-bottom: 3px;margin-top: 6px;"></textarea><div style = "margin-bottom: 6px;margin-top: 3px;"><span class="heading">Message</span></div><div id="SPDmessageEditorWrapper"><textarea id="SPDmessageEditor" class="SPDeditor"></textarea><hr></div>'+
BTNwrapper(BTNbuttonMinusWithJavascript("javascript:SPDEexitPage(false);","Cancel")+BTNbuttonPlusWithJavascript('javascript:SPDEsaveMessage("'+b+'", '+d+");","Save")+'<span style="padding-left: 20px;">NOTE: Text you paste here will have its line endings turned into visible markers. <a href="http://help.interfaceware.com/kb/editing-sample-data" target="_blank">Learn more</a></span>')+'</div><div class="SPDajaxError"></div>';$("div.content_main").css("top",$("div.header").height()+"px");$("div.content_main").html(c);
a.MPRapp=MPRapp.type;a.NewMsg==0&&Ajax.post("/sample_data",a,function(f){SPDErenderEditSampleData(f,a)},"json");var e=$("#SPDmessageEditor");e.bind("paste",function(){setTimeout(function(){var f=SPDfixLineEnds(e.get(0).value);e.val(f)},10)})}function SPDfixLineEnds(a){a=SPDescapeLineEnds(a);return SPDrestoreLineEnds(a)}
function SPDescapeLineEnds(a){a=a.replace(/\\\\/g,"LiNeEnD_BKS");a=a.replace(/\\r\\n\r*\n*/g,"LiNeEnD_DOS");a=a.replace(/\\r\r*\n*/g,"LiNeEnD_RT");a=a.replace(/\\n\r*\n*/g,"LiNeEnD_NL");a=a.replace(/\r\n/g,"LiNeEnD_DOS");a=a.replace(/\r/g,"LiNeEnD_RT");return a.replace(/\n/g,"LiNeEnD_NL")}function SPDrestoreLineEnds(a){a=a.replace(/LiNeEnD_DOS/g,"\\r\\n\r\n");a=a.replace(/LiNeEnD_NL/g,"\\n\r\n");a=a.replace(/LiNeEnD_RT/g,"\\r\r\n");return a.replace(/LiNeEnD_BKS/g,"\\\\")}
function SPDErenderEditSampleData(a,b){if(a.ErrorMessage)MPRapp.renderError(a.ErrorMessage,b);else{var c=false;if(a.BadAsciiChars){$("div.SPDwarning").html('<div><span style="font-weight:bold;">WARNING:</span> this message contains meta characters that may not display correctly.  Editing binary sample data in this editor may result in corruption.</div>');c=true}var d=a.Data,e=a.Name;d=SPDescapeLineEnds(d);d=$("<div />").html(d).text();d=SPDrestoreLineEnds(d);$("textarea#SPDmessageEditor").val(d);
$("textarea#SPDnameEditor").text(e);c&&$("div.SPDeditorWrapper").css("top","100px")}}function SPDEsaveMessage(a,b){var c=$("#SPDmessageEditor").val(),d=$("#SPDnameEditor").val();Ajax.post(Params.NewMsg==0?"/update_sample_data":"/add_sample_data",{ChannelGuid:a,Id:b,Message:c,Name:d},SPDEhandleSaveResult,"json")}function SPDEhandleSaveResult(a){if(a.ErrorMessage){$("div.SPDeditorWrapper").css("bottom","50px");$("div.SPDajaxError").html(a.ErrorMessage)}else SPDEexitPage(true)}
function SPDEexitPage(a){var b;if(Params.BackToEditor)b=$("#SPDscriptBackLink").attr("href");else{b=$("#SPDsampleDataBackLink").attr("href");if(a)b+="&SavedMsgIndex="+Params.Index}location.href=b};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var SRHsearchField=function(){return function(a,b){function c(p){if(p===undefined)p=a.getCursor(true);return a.getSearchCursor(m_Query,p,!m_CaseSensitive)}function d(){a.operation(function(){for(var p=c({line:0,ch:0});p.findNext();)m_Matches.push(a.markText(p.from(),p.to(),"searched"))});m_MatchCountSpan.text(m_Matches.length+" found")}function e(){a.operation(function(){for(var p=0;p<m_Matches.length;p++)m_Matches[p]&&m_Matches[p].clear()});m_Matches.length=0;m_MatchCountSpan.empty()}function f(){if(document.selection&&
document.selection.createRange){var p=document.selection.createRange().duplicate();p.moveEnd("character",m_Input.val().length);if(p.text=="")return m_Input.val().length;return m_Input.val().lastIndexOf(p.text)}else return m_Input[0].selectionStart}function g(){var p=m_Input.val();if(p!==m_PreviousValue){m_PreviousValue=p;e();m_SearchCursor=null;TOOLtooltipClose();m_Query=p;m_CursorPosition=f();if(m_Query===""){b.removeClass("no_match");b.addClass("empty");a.setCursor(a.getCursor(true))}else if(m_Query){d();
l()}m_Input.focus();if(m_Input[0].createTextRange){p=m_Input[0].createTextRange();p.move("character",m_CursorPosition);p.select()}else m_Input[0].setSelectionRange(m_CursorPosition,m_CursorPosition)}}function j(){a.setSelection(m_SearchCursor.from(),m_SearchCursor.to());$(".CodeMirror-selected").addClass("current_search_match")}function l(){m_SearchCursor||(m_SearchCursor=c());b.removeClass("empty no_match");if(m_SearchCursor.findNext())j();else{m_SearchCursor=c({line:0,ch:0});if(m_SearchCursor.findNext())j();
else{b.addClass("no_match");a.setCursor(a.getCursor(true))}}}function h(){if($("#SRHoptions").size())$("#SRHoptions").remove();else{var p=$('<div id="SRHoptions"><div class="SRHcheckboxes"><input id="SRHcaseSensitive" type="checkbox" /><label for="SRHcaseSensitive" title="Toggle case sensitivity">Case sensitive</label><br></div><div class="SRHdivider"></div><div style="position:relative;"><input id="SRHreplacementText" value="" /><br><span class="SRHreplacementText">Replace with...</span></div><button id="SRHreplaceSingle" title="Replace the current match with the specified replacement text, and move to the next match">Replace</button><button id="SRHreplaceAll" title="Replace all occurrences with the specified replacement text">Replace All</button></div>');
m_Input.after(p);p.fadeIn(150);var t=b.find(".SRHfield"),r=t.position();p.css("top",r.top+t.outerHeight()-1+"px");p.find("#SRHcaseSensitive").attr("checked",m_CaseSensitive).change(function(){m_CaseSensitive=!m_CaseSensitive;COOKIEcreate("SRHcaseSensitive",""+m_CaseSensitive,365);g()}).end().find("#SRHreplaceSingle").click(function(w){w.preventDefault();if(m_SearchCursor&&m_Matches.length){a.replaceRange($("#SRHreplacementText").val(),m_SearchCursor.from(),m_SearchCursor.to());m_PreviousValue="";
g()}}).end().find("#SRHreplaceAll").click(function(w){w.preventDefault();if(m_SearchCursor){w=0;for(var z=$("#SRHreplacementText").val(),y=c({line:0,ch:0});y.findNext();){a.replaceRange(z,y.from(),y.to());++w}g()}}).end().find("#SRHreplacementText").focus(function(){$(this).siblings("span").remove()}).siblings("span").click(function(){$("#SRHreplacementText").focus()}).end()}}function q(p){if(p===undefined)p=true;m_Input.focus();var t=b.find(".SRHfield");t.stop(true,true);p&&t.css("background-color",
"#A0CFEC").animate({"background-color":"white"},"slow")}b.addClass("empty").html('         <span class="SRHmatchCount"></span>         <div class="SRHfield">         <img id="imgMagnifyingGlass" src="/js/mapper/images/toolbar/icon_search_dropdown.gif" alt="" title="Show/hide search options" />            <input id="SRHsearchText" value="" title="Search the current script"></input>            <img id="imgSearchClear" src="/js/mapper/images/toolbar/icon_search_clear.gif" alt="" title="Clear this field" />         </div>         <a href="" class="button_icon connected enabled" id="search_prev" title="Find Previous"><span>Previous</span></a>         <a href="" class="button_icon connected enabled" id="search_next" title="Find Next"><span>Next</span></a>');
m_SearchCursor=null;m_Matches=[];m_Query="";m_CaseSensitive=COOKIEread("SRHcaseSensitive")=="true";m_Input=b.find("input");m_PreviousValue="";m_CursorPosition=0;m_MatchCountSpan=b.find("span.SRHmatchCount");COOKIEerase("SRHuseRegex");m_Input.keyup(function(){g()}).keydown(function(p){var t=window.event?event.keyCode:p.keyCode;if(t==13){p.preventDefault();if(!b.hasClass("empty")){l();q(false)}}else if(t==27){a.focus();p.preventDefault()}}).blur(function(){TOOLtooltipClose()}).focus(function(){a.ifware.focusLastFocussedElement=
function(){q(false)}});b.find("#imgMagnifyingGlass").click(function(){h()}).end().find("#imgSearchClear").click(function(){$("#SRHoptions").remove();$("#SRHsearchText").val("");g()}).end().find("#search_prev").click(function(p){p.preventDefault();if(!b.hasClass("empty")){m_SearchCursor||(m_SearchCursor=c());b.removeClass("empty no_match");if(m_SearchCursor.findPrevious())j();else{p=a.lineCount()-1;var t=a.getLine(p).length;m_SearchCursor=c({line:p,ch:t});if(m_SearchCursor.findPrevious())j();else{b.addClass("no_match");
a.setCursor(a.getCursor(true))}}}}).end().find("#search_next").click(function(p){p.preventDefault();b.hasClass("empty")||l()});return{updateSearchMatches:function(){if(m_Query&&m_Query!==""){e();d();b.removeClass("no_match")}},focus:q}}}();/*

 Copyright (c) 2010-2014 iNTERFACEWARE Inc.  All rights reserved.
*/
var SCMreplaceSampleStr="REPLACE_SAMPLE",SCMappendSampleStr="APPEND_SAMPLE";if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<d;c++)if(this[c]===a)return c;return-1};function SCMviewMilestonesDlg(a){SCMgetProjectFilesRequest(a,SCMviewMilestonesRequest)}function SCMsaveMilestoneDlg(a){SCMgetProjectFilesRequest(a,SCMsaveMilestoneDlgGetConflictingFiles)}function SCMsaveMilestoneDlgGetConflictingFiles(a,b){SCMcheckConflicts(a,b,SCMsaveMilestoneDlgUI)}
function SCMgetLastMilestonName(a,b){Ajax.post("/source_control",{RequestType:"milestone_list",ChannelGuid:a.ifware.ChannelGuid},function(c){SCMresponseDlgUI(c,false)||(c.Milestones.length==0?b(""):b(c.Milestones[0].MilestoneName))},"json")}function SCMclearDependencies(a){Ajax.post("/source_control",{RequestType:"clear_dependencies",ChannelGuid:a.ifware.ChannelGuid},function(b){SCMresponseDlgUI(b,false)},"json")}
function SCMviewMilestonesRequest(a,b){Ajax.post("/source_control",{RequestType:"milestone_list",ChannelGuid:a.ifware.ChannelGuid},function(c){SCMresponseDlgUI(c,false)||SCMopenMilestonesDlgUI(a,c,b)},"json")}function SCMgetDefaultMilestoneName(a,b){Ajax.post("/source_control",{RequestType:"milestone_list",ChannelGuid:a.ifware.ChannelGuid},function(c){if(!SCMresponseDlgUI(c,false)){b.val("Milestone "+c.Milestones.length);b.focus();b.select()}},"json")}
function SCMadjustFieldHeight(a){if(a.get(0).offsetHeight<a.get(0).scrollHeight)if(a.get(0).offsetWidth<a.get(0).scrollWidth){a.css("overflow","auto");a.css("height",a.get(0).scrollHeight+35+"px")}else a.css("height",a.get(0).scrollHeight+3+"px")}function SCMsanitizeRevisionNameOnPaste(a){a.val(a.val().replace(/\n/g," "))}
function SCMsaveMilestoneDlgUI(a,b,c){var d=SCMgetProjectLabelList(b);$("#fossilCommitDlg").length&&$("#fossilCommitDlg").remove();$(document).find("body").append('<div id="fossilCommitDlg"><div id="commitForm">Milestone name: <br/><textarea style="width:100%;height:35px;resize:none;overflow:hidden;" id="revisionName" rows="1"/><div id="milestone_name_error" class="fossil_error_inline"></div></div></div>');var e=$("#fossilCommitDlg");e.find("#revisionName").bind("keyup",function(){SCMadjustFieldHeight($(this))});
e.find("#revisionName").live("input paste",function(){SCMsanitizeRevisionNameOnPaste($(this));SCMadjustFieldHeight($(this))});var f={};if(c.length>0){e.find("#commitForm").hide().after($("<div class='fossil_error'>Your changes have conflicts with the last saved milestone. You must update the source code and resolve the conflicts manually, before saving a milestone.</div>"));f.Update=function(){SCMupdateSourceAjaxCall(a,d,function(){e.dialog("close")})}}else f.Save=function(){$("#milestone_name_error").text("");
SCMsaveMilestoneAction(a,e,d)};f.Cancel=function(){$(this).dialog("close")};e.dialog({bgiframe:true,width:300,title:"Save Milestone",position:"center",modal:true,autoOpen:false,buttons:f});e.bind("dialogclose",function(){a.ifware.focusLastFocussedElement()});c=e.find("#revisionName");SCMgetDefaultMilestoneName(a,c);e.find("#commitForm").keypress(function(g){if(g.which==13){SCMsaveMilestoneAction(a,e,d);g.preventDefault()}});e.prepend($("<br/>"));e.find("#fileTable").remove();e.parent().find(".ui-dialog-buttonpane button:contains('Save')").attr("disabled",
true).addClass("ui-state-disabled");c=SCMcreateFilesTable(a,"fileTable",b);f=c.Element;e.prepend(f);f.wrap('<div class="filesTableWrapper"></div>');e.dialog("open");SCMgetFileStatusRequest(a,SCMgetProjectLabelList(b),c.FileLabels,function(){e.parent().find(".ui-dialog-buttonpane button:contains('Save')").attr("disabled",false).removeClass("ui-state-disabled")})}
function SCMopenMilestonesDlgUI(a,b,c){SCMgetProjectLabelList(c);$("#fossilRevisionsDlg").length&&$("#fossilRevisionsDlg").remove();$(document).find("body").append('<div id="fossilRevisionsDlg"></div>');var d=$("#fossilRevisionsDlg");b=b.Milestones;DlgButtons={};DlgButtons.Close=function(){$(this).dialog("close")};var e=$(window).width()*0.6,f=$(window).height()*0.7;d.dialog({bgiframe:true,width:e,title:"Milestones",modal:true,position:"center",autoOpen:false,buttons:DlgButtons});d.css("max-height",
f);var g=d.parent(),j=g.children(":first"),l=g.children(":last");g.resize(function(){if(g.height()>j.outerHeight()+l.outerHeight()+f){var p=g.height()-j.outerHeight()-l.outerHeight()-20;d.css("height",p);d.css("max-height",p)}else d.css("max-height",f)});e="";if(b.length==1){e+="<div id='milestone_list_title'>No Saved Milestones</div>";e+="Use 'Save Milestone' to add a snapshot of all files to the source control repository.";$("#fossilRevisionsDlg").html(e)}else{e+='<table id="tag_list" class="diffTable"><tr><th class="milestone">Milestone</th><th class="time">Time</th><th class="user">User</th><th class="files">Files</th></tr></table>';
$("#fossilRevisionsDlg").html(e);e=$("#fossilRevisionsDlg").find("#tag_list").first();e.length>1&&alert("problem. FileInfoTable.length = "+e.length);SCMgetProjectLabelList(c);var h;for(h=0;h<b.length;h++){var q=b[h];q=SCMprependTagInfo(a,q.MilestoneName,q.TimeStamp,q.UserName,c);e.append(q)}}d.bind("dialogclose",function(){a.ifware.focusLastFocussedElement()});$(".diffTable tr:odd").addClass("odd");d.dialog("open")}
function SCMcreateDiffDialog(a,b,c,d,e,f,g,j){$("#fossilDiff").length&&$("#fossilDiff").remove();$(document).find("body").append($('<div id="fossilDiff"></div>'));var l=$("#fossilDiff"),h={};h.Close=function(){$(this).dialog("close")};$("#fossilDiff").html(b);b=$(window).width()*0.9;var q=$(window).height()*0.9,p=$("#toggleButton");p.remove();l.prepend(p);p=$(".legendTable");p.remove();l.prepend(p);if(l.find("#condensed").length>0){p=$('<span id="switch_view" class="clickable_link">Line over line</span>');
l.find("#toggleButton").append(p);p.click(function(){if($("#switch_view").text()=="Side by side"){l.find("#condensed").hide();l.find("#leftSideDiv").show();l.find("#rightSideDiv").show();t.show();$("#switch_view").text("Line over line")}else{l.find("#condensed").show();l.find("#leftSideDiv").hide();l.find("#rightSideDiv").hide();t.hide();$("#switch_view").text("Side by side")}});var t=$('<span id="toggle_unchanged" class="clickable_link">Show changes only</span>');l.find("#toggleButton").append(t);
t.click(function(){if($("#toggle_unchanged").text()=="Show changes only"){l.find(".diffTable").find(".uc").hide();$("#toggle_unchanged").text("Show everything")}else{l.find(".diffTable").find(".uc").show();$("#toggle_unchanged").text("Show changes only")}})}else{b=300;q=150}if(!e||e.length==0)e="Editor File";l.find("#leftSideNum #diff_header_row").append($('<th class="lineNumber"></th>'));l.find("#leftSide #diff_header_row").append($('<th id="milestoneNameSideBySide">'+PAGhtmlEscape(g)+"</th>"));
l.find("#rightSideNum #diff_header_row").append($('<th class="lineNumber"></th>'));l.find("#rightSide #diff_header_row").append($('<th id="milestoneFromNameSideBySide">'+PAGhtmlEscape(e)+"</th>"));l.find("#condensed #diff_header_row").append($('<th class="lineNumber" id="milestoneNameLineOverLine">'+PAGhtmlEscape(g)+'</th><th class="lineNumber">'+PAGhtmlEscape(e)+"</th><th>Differences</th>"));l.find("#condensed").hide();var r=$("#leftSideDiv, #rightSideDiv");r.scroll(function(){var w=$(this).scrollTop(),
z=$(this).scrollLeft();r.each(function(){$(this).scrollTop()!=w&&$(this).scrollTop(w);$(this).scrollLeft()!=z&&$(this).scrollLeft(z)})});f&&a.ifware.ChannelGuid!=f&&$("#milestoneNameSideBySide").append($('<span id="notFromSameChannel"> (saved in another channel)</span>'));j&&a.ifware.ChannelGuid!=j&&$("#milestoneFromNameSideBySide").append($('<span id="notFromSameChannel"> (saved in another channel)</span>'));$("#notFromSameChannel").css("color","#f00");l.dialog({width:b,height:q,title:"Diff for "+
PAGhtmlEscape(c),modal:d.modal,autoOpen:false,position:"center",buttons:h,open:function(){$("body").css("overflow","hidden")},close:function(){$("#fossilDiffWaiting").remove();$("body").css("overflow","auto")}});l.dialog("open")}
function SCMshowDiffRequest(a,b,c,d,e,f,g){SCMdialogWaiting("#fossilRevisionsDlg, #fossilCommitDlg",true);if(!g.modal)g.modal=false;if(!g.friendlyError)g.friendlyError=false;var j=null;if(g.showWaiting){$("#fossilDiffWaiting").remove();j=$('<div id="fossilDiffWaiting"></div>').appendTo("body");j.html('<img src="/js/mapper/images/spinner.gif" /> Generating diff for '+PAGhtmlEscape(e)+"...");j.dialog({title:"Diff for "+PAGhtmlEscape(e),position:"center",modal:g.modal,minHeight:70,draggable:false,resizable:false,
beforeClose:function(){return false}})}Ajax.post("/source_control",{RequestType:"diff",FileLabels:e,FileTypes:f,Commit:b,CommitTo:c,ChannelGuid:a.ifware.ChannelGuid},function(l){SCMdialogWaiting("#fossilRevisionsDlg, #fossilCommitDlg",false);j&&j.dialog("destroy").remove();if(l.ErrorCode==2&&g.friendlyError){$("#fossilResponseDlg").remove();l=$('<div id="fossilResponseDlg">This is a new file, which must be saved as part of a milestone before a diff can be performed.</div>').appendTo("body");var h=
{};h.Close=function(){$(this).dialog("close")};l.dialog({title:"Nothing to Diff",modal:true,resizable:false,buttons:h})}else SCMresponseDlgUI(l,false,function(){SCMdialogWaiting("#fossilCommitDlg",false)})||SCMcreateDiffDialog(a,l.DiffContent,e,g,l.ComparedToMilestones,l.ComparedToGuids,l.ComparedFromMilestones,l.ComparedFromGuids)},"json")}function SCMfindLabel(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return true;return false}
function SCMrevertRequest(a,b,c,d){SCMdialogWaiting("#fossilRevisionsDlg",true);Ajax.post("/source_control",{RequestType:"revert",FileLabels:c,FileTypes:d,Commit:b,ChannelGuid:a.ifware.ChannelGuid},function(e){SCMfindLabel(a.ifware.CurrentFileName,e.RevertedFiles)?NISreloadCurrentFile(a):NISupdateAnnotations(a);SCMresponseDlgUI(e,false,function(){SCMdialogWaiting("#fossilRevisionsDlg",false)})},"json")}
function SCMpopulateTagInfo(a,b,c){var d=$("<span><span id='detail_click' class='clickable_link'>Show Files</span> | <span id='milestone_revert_click' class='clickable_link'>Revert all files</span></span>");d.find("#detail_click").click(function(){d.find(".tag_table").length>0?d.find(".tag_table").remove():SCMsourceControlTagFilesRequest(a,b,d,c)});d.find("#milestone_revert_click").click(function(){SCMdialogConfirm(SCMrevertConfirmText(),function(){SCMmilestoneRevertRequest(a,b,c)})});return d}
function SCMprependTagInfo(a,b,c,d,e){if("No milestone defined."!=b){c=$("<tr><td class='tag_td_milestone'>"+PAGhtmlEscape(b)+"</td><td class='tag_td_date'>"+PAGhtmlEscape(c)+"</td><td class='tag_td_user'>"+PAGhtmlEscape(d)+"</td><td class='file_table'> </td></tr>");c.find(".tag_td_milestone").css({"white-space":"pre-wrap"});c.find(".file_table").append(SCMpopulateTagInfo(a,b,e));return c}}
function SCMopenFossilUIrequest(a,b){Ajax.post("/source_control",{RequestType:"ui",FileLabels:b.join("\n"),ChannelGuid:a.ifware.ChannelGuid},function(c){SCMresponseDlgUI(c,false)},"json")}function SCMsourceControlDiffHandler(a,b,c,d,e,f,g,j){b.find("#diff_click").click(function(){SCMshowDiffRequest(a,c,"",e,f,g,{})});j?b.find("#prev_click").click(function(){SCMshowDiffRequest(a,d,c,e,f,g,{})}):b.find("#prev_click").removeClass("clickable_link")}
function SCMsourceControlRevertHandler(a,b,c,d,e){b.find("#revert_click").click(function(){SCMdialogConfirm(SCMrevertConfirmText(),function(){SCMrevertRequest(a,c,d,e)})})}function SCMsourceControlFileHistoryHandler(a,b,c,d){b.find("#file_history_click").click(function(){SCMviewFileHistoryRequest(a,c,d)})}
function SCMsourceControlTagFilesRequest(a,b,c,d){SCMdialogWaiting("#fossilRevisionsDlg",true);Ajax.post("/source_control",{RequestType:"get_files_for_tag",MilestoneName:b,FileLabels:SCMgetMainFileLabel(d)+"\n",ChannelGuid:a.ifware.ChannelGuid},function(e){if(!SCMresponseDlgUI(e,false,function(){SCMdialogWaiting("#fossilRevisionsDlg",false)}))if(e.Files.length==0)c.append($("<span>Error</span>"));else{for(var f=$("<table class='tag_table'></table>"),g=0;g<e.Files.length;++g){var j=e.Files[g].CommitID,
l=e.Files[g].FileLabel,h=e.Files[g].FileType,q=$("<tr><td><span id='file_history_click' class='clickable_link'>"+l+"</span></td><td><span  id='diff_click' class='clickable_link'>Diff</span></td><td>|</td><td><span id='prev_click' class='clickable_link'>Prev</span></span></td><td>|</td><td><span id='revert_click' class='clickable_link'>Revert</span></span></td></tr>");f.append(q);SCMsourceControlDiffHandler(a,q,j,e.Files[g].ParentCommitID,b,l,h,e.Files[g].Changed);SCMsourceControlRevertHandler(a,q,
j,l,h);SCMsourceControlFileHistoryHandler(a,q,l,h)}c.append(f);e=$("#fossilRevisionsDlg").dialog("option","position")[0];$("#fossilRevisionsDlg").dialog("option","position",[e,"center"])}},"json")}function SCMupdateSourceAjaxCall(a,b,c){Ajax.post("/source_control",{RequestType:"update_source",FileLabels:b.join("\n"),ChannelGuid:a.ifware.ChannelGuid},function(d){if(!SCMresponseDlgUI(d,false)){NISreloadCurrentFile(a);typeof c=="function"&&c()}},"json")}
function SCMsaveMilestoneRequest(a,b,c){Ajax.post("/source_control",{RequestType:"save_milestone",FileLabels:c.join("\n"),MilestoneName:b,ChannelGuid:a.ifware.ChannelGuid},function(d){if(!SCMresponseDlgUI(d,false)){$("#fossilCommitDlg").dialog("close");PRJrequestProjectManagerRefresh(a)}},"json")}
function SCMcheckMilestoneName(a,b,c,d,e){Ajax.post("/source_control",{RequestType:"check_milestone_name",MilestoneName:b,FileLabels:c.join("\n"),ChannelGuid:a.ifware.ChannelGuid},function(f){if(f.MilestoneNameUnique)e(a,b,c);else{$("#milestone_name_error").text("Name must be unique for the channel.");SCMdialogWaiting("#fossilCommitDlg",false)}},"json")}
function SCMsaveMilestoneAction(a,b,c){var d=b.find("#revisionName");d=$.trim(d.val());if(d.length==0){$("#milestone_name_error").text("Name must not be blank.");SCMdialogWaiting("#fossilCommitDlg",false)}else{SCMdialogWaiting(b,true);SCMcheckMilestoneName(a,d,c,b,SCMsaveMilestoneRequest)}}
function SCMgetFileStatusRequest(a,b,c,d){Ajax.post("/source_control",{RequestType:"status",FileLabels:b.join("\n"),ChannelGuid:a.ifware.ChannelGuid},function(e){if(!SCMresponseDlgUI(e,false)){d&&d();for(var f in e)if(e.hasOwnProperty(f))if(c.hasOwnProperty(f)){c[f].text("").append($("<span>"+e[f]+"</span>"));if(e[f].indexOf("EDITED")!=-1){var g=$('<span> : </span><span id="diff_click" class="clickable_link">Diff</span>');c[f].append(g);SCMsourceControlDiffHandler(a,g.parent(),"","","",f)}e[f]=="NEW"&&
b.indexOf(f)==-1&&b.push(f)}}},"json")}function SCMcheckConflicts(a,b,c){var d=SCMgetProjectLabelList(b);Ajax.post("/source_control",{RequestType:"check_conflicts",FileLabels:d.join("\n"),ChannelGuid:a.ifware.ChannelGuid},function(e){SCMresponseDlgUI(e,true)||c(a,b,e.Files)},"json")}
function SCMcreateFilesTable(a,b,c){b=$('<table id="'+b+'" class="filesTable"><tr><th>Files</th><th>Status</th></tr></table>');var d,e={};for(d=0;d<c.length;++d){var f='<tr><td><span id="file_history_click" class="clickable_link">'+c[d].Label+"</span></td>";f+='<td align="center" id="FileStatus'+d+'"><img class="fossilSpinner" src="/js/mapper/images/spinner.gif" /></td>';f+="</tr>";f=$(f);SCMsourceControlFileHistoryHandler(a,f,c[d].Label,c[d].Type);b.append(f);e[c[d].Label]=b.find("#FileStatus"+d)}return{Element:b,
FileLabels:e}}
function SCMresponseDlgUI(a,b,c){$("#fossilResponseDlg").length&&$("#fossilResponseDlg").remove();if(a.ErrorMessage||a.InfoMessage&&b){$(document).find("body").append($("<div id='fossilResponseDlg'><div class='fossil_error'></div><br/><span class='clickable_link' id='fossil_expand_output'>Show details</span><div class='fossil_output'></div><div class='fossil_info'></div></div>"));b=$("#fossilResponseDlg");var d={};d.Close=function(){$(this).dialog("close")};b.dialog({bgiframe:true,width:600,title:"Response",
modal:true,autoOpen:false,position:"center",buttons:d});var e=$("#fossil_expand_output");e.hide();if(a.ErrorMessage){b.find(".fossil_error").text(a.ErrorMessage);b.find(".fossil_error").show();if(a.RawOutput){var f=b.find(".fossil_output");e.show();e.click(function(){f.toggle();f.is(":visible")?e.text("Hide details"):e.text("Show details")});f.hide();f.append(a.RawOutput)}b.dialog("open");typeof c=="function"&&c();return true}if(a.InfoMessage){b.find(".fossil_error").hide();b.find(".fossil_info").text(a.InfoMessage);
b.dialog("open")}}typeof c=="function"&&c();return false}function SCMgetMainFileLabel(a){for(var b=0;b<a.length;++b)if(a[b].Type=="Main")return a[b].Label;return""}function SCMgetProjectLabelList(a){for(var b=[],c=0;c<a.length;++c)b.push(a[c].Label);return b}
function SCMgetProjectFilesRequest(a,b){Ajax.post("/source_control",{RequestType:"get_project_files",ChannelGuid:a.ifware.ChannelGuid},function(c){if(c)SCMresponseDlgUI(c,false)||b(a,c.ProjectData);else a.ifware.AnnotationsStatusContainer.innerHTML="Server is not responding."},"json")}
function SCMmilestoneRevertRequest(a,b){SCMdialogWaiting("#fossilRevisionsDlg",true);Ajax.post("/source_control",{RequestType:"checkout_milestone",MilestoneName:b,ChannelGuid:a.ifware.ChannelGuid},function(c){SCMdialogWaiting("#fossilRevisionsDlg",false);NISreloadCurrentFile(a);SCMresponseDlgUI(c,false,function(){SCMdialogWaiting("#fossilRevisionsDlg",false)})},"json")}
function SCMdialogWaiting(a,b){if(b){$(a).dialog("disable");$(a).siblings(".ui-dialog-buttonpane").prepend('<img class="fossilSpinner" src="/js/mapper/images/spinner.gif" />')}else{$(a).dialog("enable");$(a).siblings(".ui-dialog-buttonpane").children(".fossilSpinner").remove()}}
function SCMdialogConfirm(a,b){$("#fossilConfirmDlg").length&&$("#fossilConfirmDlg").remove();$(document).find("body").append($("<div id='fossilConfirmDlg'>"+a+"</div>"));var c={};c.No=function(){$(this).dialog("close")};c.Yes=function(){b();$(this).dialog("close")};var d=$("#fossilConfirmDlg");d.dialog({bgiframe:true,title:"Confirmation Request",width:500,modal:true,autoOpen:false,position:"center",buttons:c});d.dialog("open")}
function SCMrevertConfirmText(){return"Revert operation might overwrite your changes. Are you sure you want to revert?"}
function SCMuploadFile(a,b,c,d){PRJdoNewFileUpload(a,b,c,d,false,function(e){Ajax.post("/source_control",{RequestType:"import_from_zip",ChannelGuid:d.ifware.ChannelGuid,UploadedFileName:e,DataImportType:d.ifware.DataImportType},function(f){if(!SCMresponseDlgUI(f,false)){if(d.ifware.DataImportType==SCMappendSampleStr)d.ifware.CountOfSampleData+=f.CountOfSampleData;else if(d.ifware.DataImportType==SCMreplaceSampleStr){d.ifware.CountOfSampleData=f.CountOfSampleData;d.ifware.CurrentSampleData=1;NISchangeSampleData(d,
1)}NISupdateSampleDataControl(d);NISreloadCurrentFile(d)}},"json")})}function SCMenableImportBTN(a,b){a.dialog("widget").find('button:contains("Import")').button(b)}
function SCMimportProjectAndData(a){function b(){$("#ImportZipFileBrowse",c).val()==""&&$("input[name=importType]:checked",c).val()=="ImportZippedProject"?SCMenableImportBTN(c,"disable"):SCMenableImportBTN(c,"enable")}$("#importProjectAndData").remove();$(document).find("body").append('<div id="importProjectAndData"><form id="importForm"><table><tr><td valign="top"><input type="radio" name="importType" value="EmptyProject" id="importProjectAndData_importTypeId" class="ImportBlank"></td><td ><label for="importProjectAndData_importTypeId">Use a blank project</label></td><tr><td valign="top"><input type="radio" id="importProjectAndData_projectList" name="importType" value="ImportProject" class = "ImportFromProject"></td>    <td><label for="importProjectAndData_projectList">Import from existing projects</label>        <br><select name="projectList"></select>'+(a.ifware.UsesParameter?
'        <br><input id="importProjectAndData_importSampleData" type="checkbox" name="importSampleData" checked="checked">        <label for="importProjectAndData_importSampleData">Import sample data</label>':"")+'<tr><td valign="top"><input type="radio" name="importType" value="ImportZippedProject" id="importProjectAndData_importZipFile" class = "ImportFromZip"></td>    <td><label for="importProjectAndData_importZipFile">Import project from zip file</label><br><input type="file" id = "ImportZipFileBrowse" name="NewFile" value = ""/>      <input type="hidden" name="ChannelGuid" value="'+
a.ifware.ChannelGuid+'" />  '+(a.ifware.UsesParameter?'<br><input id = "importProjectAndData_includeSampleData" type = "checkbox" name = "includeSampleData" checked="checked">  <label for="importProjectAndData_includeSampleData">Import sample data</label>'+(a.ifware.CountOfSampleData>0?'   <select name="addSampleTypeList"><option value = "APPEND_SAMPLE">Append</option><option value = "REPLACE_SAMPLE">Replace</option></select>':""):"")+'</td></tr></table></form><div class="importError" style="color: red"></div></div>');
var c=$("#importProjectAndData");NISmainFileSelectedAndEmpty(a)?$('input[class = "ImportBlank"]').attr("checked",true):$('input[class = "ImportFromProject"]').attr("checked",true);$("input[name=importType]",c).click(function(){b()});$("input[name = NewFile]",c).change(function(){SCMenableImportBTN(c,"enable")});$("select[name = projectList]",c).mousedown(function(){$('input[class = "ImportFromProject"]').attr("checked",true);b()});$("input[name = importSampleData]",c).click(function(){$('input[class = "ImportFromProject"]').attr("checked",
true);b()});$("input[name = NewFile]",c).click(function(){$('input[class = "ImportFromZip"]').attr("checked",true);b()});$("input[name = includeSampleData]",c).click(function(){$('input[class = "ImportFromZip"]').attr("checked",true);b()});$("select[name = addSampleTypeList]",c).mousedown(function(){$('input[class = "ImportFromZip"]').attr("checked",true);b()});var d={};d.Import=function(){if("ImportProject"==$("input[name=importType]:checked",this).val()){a.ifware.LuaFileSourceHash=null;var e=$("select[name=projectList] option:selected",
this).val();e||$(this).dialog("close");SCMdialogWaiting("#importProjectAndData",true);var f={RequestType:"import_from_project",ChannelGuid:a.ifware.ChannelGuid};f.source_guid=e;if($("input[name=importSampleData]:checked",this).length&&a.ifware.UsesParameter)f.import_sample_data="true";Ajax.post("/source_control",f,function(g){SCMdialogWaiting("#importProjectAndData",false);if(g.Error)$(".importError",c).html(g.Error);else{a.ifware.CountOfSampleData+=g.ImportCount;NISupdateSampleDataControl(a);NISreloadCurrentFile(a);
$(c).dialog("close")}},"json")}else if("ImportZippedProject"==$("input[name=importType]:checked",this).val()){a.ifware.LuaFileSourceHash=null;e=c.find("form");f=e.find('input[type="file"]');a.ifware.DataImportType=$("input[name=includeSampleData]:checked").length&&a.ifware.UsesParameter?$("select[name=addSampleTypeList] option:selected",this).val()=="APPEND_SAMPLE"||a.ifware.CountOfSampleData==0?SCMappendSampleStr:SCMreplaceSampleStr:"";SCMuploadFile(c,e,f,a)}else{e="";e=MPRapp?" from "+MPRapp.type:
"";e=a.ifware.UsesParameter?"-- The main function is the first function called"+e+".\n-- The Data argument will contain the message to be processed.\nfunction main(Data)\nend":"-- The main function is the first function called"+e+".\nfunction main()\nend";NISsetScriptName(a,a.ifware.MainLuaFile);a.setValue(e);a.clearHistory();SCMclearDependencies(a);$(c).dialog("close")}};d.Cancel=function(){$(this).dialog("close")};c.dialog({bgiframe:true,title:a.ifware.UsesParameter?"Import Project/Sample Data":
"Import Project",position:"center",resizable:false,modal:true,autoOpen:false,buttons:d,close:function(){a.focus()}});b();c.dialog("open");SCMdialogWaiting("#importProjectAndData",true);Ajax.post("/source_control",{RequestType:"get_all_projects_file_info",ChannelGuid:a.ifware.ChannelGuid},function(e){SCMdialogWaiting("#importProjectAndData",false);if(!SCMresponseDlgUI(e,false)){e.Projects.sort(function(j,l){var h=(j.Name||j.Guid).toLowerCase(),q=(l.Name||l.Guid).toLowerCase();if(j.ExternalProject&&
!l.ExternalProject)return-1;else if(!j.ExternalProject&&l.ExternalProject)return 1;return h<q?-1:h>q?1:0});for(ProjIndex in e.Projects){var f=e.Projects[ProjIndex],g=$("<option></option>");g.val(f.Guid);g.html(f.Name||f.Guid);$("select[name=projectList]",c).append(g)}e=$("#importProjectAndData table:first").width();c.dialog("option","width",26+e);c.dialog("option","position","center");SCMdialogWaiting("#importProjectAndData",false)}},"json")}
function SCMviewFileHistoryRequest(a,b,c){Ajax.post("/source_control",{RequestType:"file_history",ChannelGuid:a.ifware.ChannelGuid,FileLabels:b,FileTypes:c},function(d){SCMresponseDlgUI(d,false)||SCMfileHistoryDlg(a,d,b,c)},"json")}
function SCMfileHistoryDlg(a,b,c,d){$("#fileHistoryDlg").length&&$("#fileHistoryDlg").remove();$(document).find("body").append('<div id="fileHistoryDlg"></div>');var e=$("#fileHistoryDlg"),f={};f.Close=function(){$(this).dialog("close")};var g=$(window).width()*0.6,j=$(window).height()*0.8;e.dialog({bgiframe:true,width:g,"max-height":j,title:"Change History for "+c,position:"center",modal:true,autoOpen:false,buttons:f});if(b.Milestones.length==1)e.append("<p>There is no history for this file. Save a milestone to put the file in the version control system.</p>");
else{var l=$('<table id="file_history_list" class="diffTable"><tr id="title_row"><th class="milestone">Milestone</th><th class="time">Time</th><th class="user">User</th><th class="diff">Diff</th></tr></table>');for(f=0;f<b.Milestones.length;++f)if(!(!b.Milestones[f].Changed||b.Milestones[f].MilestoneName=="No milestone defined.")){g=$('<tr><td class="tag_td_milestone">'+PAGhtmlEscape(b.Milestones[f].MilestoneName)+'</td><td class="tag_td_date">'+PAGhtmlEscape(b.Milestones[f].TimeStamp)+'</td><td class="tag_td_user">'+
PAGhtmlEscape(b.Milestones[f].UserName)+'</td><td class="tag_td_actions"><span id="diff_click" class="clickable_link">Current</span> | <span id="prev_click" class="clickable_link">Previous</span> | <span id="revert_click" class="clickable_link">Revert</span></td></tr>');b.Milestones[f].ChannelGuid!=a.ifware.ChannelGuid&&g.find(".tag_td_milestone").css("color","#f00");SCMsourceControlDiffHandler(a,g,b.Milestones[f].CommitID,f<b.Milestones.length-1?b.Milestones[f+1].CommitID:"",b.Milestones[f].MilestoneName,
c,d,b.Milestones[f].Changed);SCMsourceControlRevertHandler(a,g,b.Milestones[f].CommitID,c,d);f>=b.Milestones.length-1&&g.find("#prev_click").unbind("click").removeClass("clickable_link");l.append(g)}}e.append(l);$(".diffTable tr:odd").addClass("odd");e.dialog("open")}
function SCMrunScript(a,b,c,d){Ajax.post("/source_control",{RequestType:"run_lua_file",FileToRun:a,FunctionToRun:b,Parameters:c},function(e){SCMresponseDlgUI(e,false,function(){SCMdialogWaiting("#fossilRevisionsDlg",false)})||d&&d(e.Result[0])},"json")}
function SCMextensionsPage(a){a.DashboardLinkOnly="Extensions";a=MAPretrieveHeaderHTML("lua_editor",a);$(document).find("body").html(a+'<div class="ext_list"></div>');Ajax.post("/source_control",{RequestType:"list_extensions"},function(b){if(!SCMresponseDlgUI(b,false,function(){SCMdialogWaiting("#fossilRevisionsDlg",false)})){b=b.ListOfExtensions;if(b.length==0)$(".ext_list").html("<p>There are no installed extensions.</p>");else{for(var c="<table class='extension_list'><tr><th>Extension Name</th><th></th><th></th></tr>",
d=0;d<b.length;++d){var e=b[d];c+="<tr>";c+="<td>"+e+"</td>";c+="<td><a href='/mapper/#Page=OpenEditor&ChannelName="+PAGhtmlEscape(e)+"&ChannelGuid="+PAGhtmlEscape(e)+"'>Edit</a></td>";c+="<td><a href='' class='ajax' id='"+PAGhtmlEscape(e)+"'>Run</a></td>";c+="</tr>"}c+="</table>";b=$(c);b.find("a.ajax").click(function(f){f.preventDefault();SCMrunScript($(this).attr("id"),"main","",function(g){eval(g)})});$(".ext_list").replaceWith(b)}}},"json")}
function SCMincludeSampleConfirm(a){$("#IncludeSampleConfirmDlg").remove();$(document).find("body").append('<div id="IncludeSampleConfirmDlg" align="center">Include Sample Messages? </div>');var b={};b.Yes=function(){SCMexportRequest(a,true);$("#IncludeSampleConfirmDlg").dialog("close")};b.No=function(){SCMexportRequest(a,false);$("#IncludeSampleConfirmDlg").dialog("close")};$("#IncludeSampleConfirmDlg").dialog({bgiframe:true,width:300,height:130,title:"Confirm",position:"center",modal:true,autoOpen:true,
buttons:b})}function SCMexportRequest(a,b){window.open("/source_control?RequestType=export_to_zip&ChannelGuid="+a+"&DownloadSample="+b);this.focus()};/*

 Copyright (c) 2010-2014 iNTERFACEWARE Inc.  All rights reserved.
*/
function TRVcreateNode(a,b,c,d,e,f,g,j){var l=document.createElement("li"),h=$(l);h.data("DataNode",a);l.className=d&&e?"collapsable":d&&!e?"expandable":"leaf";if(b)l.className+=" "+b;l.innerHTML='<div>          <span class="treeIcon"></span>          <span class="nodeText '+c+'">'+f+"</span>       </div>       <ul"+(e?"":' style="display:none;"')+"></ul>";h.children("div").click(function(q){var p=h.find("span.nodeText:first").get(0),t=h.find("ul:first").get(0);t.innerHTML="";if(h.hasClass("expandable")){h.removeClass("expandable");
h.addClass("collapsable");t.style.display="";g(a,p,t,true)}else if(h.hasClass("collapsable")){h.removeClass("collapsable");h.addClass("expandable");t.style.display="none";g(a,p,t,false)}j&&j(a,p,t);q.stopPropagation()});if(d||j)h.find("span.nodeText:first").mouseover(function(){$(this).addClass("hover")}).mouseout(function(){$(this).removeClass("hover")});return l}function TRVgetChildContainer(a){return $(a).find("ul:first").get(0)}
function TRVgetChildren(a){return $(a).children("li.collapsable")}function TRVgetTreeRoot(a){return $(a).closest("ul.ifwareTreeview")};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function TABmaker(a){if(a){var b=1E3;for(i in a)$(a[i]).attr("tabindex",b++);if(a.length){$(a[a.length-1]).keydown(function(c){if(c.which==9){c.preventDefault();$(a[0]).focus()}});$(a[0]).focus()}}}
function IGNMPRexportTablesExecute(a,b){function c(h){return f+"_"+h}function d(){return{DbName:$("input[name=exportTableDb]",g).val(),DbApi:$("select[name=exportTableDbApi] option:selected",g).val(),DbUser:$("input[name=exportTableDbUsername]",g).val(),DbPassword:$("input[name=exportTableDbPassword]",g).val(),MapperGuid:b,VmdFile:a}}function e(h){$(h.getWrapperElement(),g).css("position","static").css("left","0px").css("right","0px");var q=false,p=$(".previewExportTableButton",g),t=$("#"+c("previewExportTableStatusIndicator"));
p.click(function(){if(!q){q=true;p.attr("disabled","disabled");t.html('<img src="/js/mapper/images/spinner.gif" />');Ajax.post("/export_mapper_vmd_tables_to_db",d(),function(r){q=false;p.removeAttr("disabled");t.html("");h.setValue(r.Error?r.Error:r.ExportPreview);h.clearHistory();$(".tableDropWarning",g).get(0).style.display=r.HaveDropCommands?"":"none"},"json")}});TABmaker(["#"+c("exportTableDbApi"),"#"+c("exportTableDb"),"#"+c("exportTableDbUsername"),"#"+c("exportTableDbPassword"),"#"+f+" .previewExportTableButton",
"#"+f+"~* button:last","#"+f+"~* button:first"])}var f="IGNexportTableDialog";if($("#"+f).length){$("#"+f).dialog("destroy");$("#"+f).remove()}$(document).find("body").append('<div id="'+f+'">       <form>       <table>       <tr>        <td><label for="'+c("exportTableDbApi")+'">Database API:</label></td><td><select name="exportTableDbApi" id="'+c("exportTableDbApi")+'"/></select></td> \t\t<td><label for="'+c("exportTableDb")+'">Database:</label></td><td><input id="'+c("exportTableDb")+'" name="exportTableDb" type="text"/></td>         <td rowspan="2"><button type="button" class="previewExportTableButton">Preview Create Statements</button></td> \t\t<td rowspan="2" id="'+
c("previewExportTableStatusIndicator")+'"></td>        </tr>       <tr>          <td><label for="'+c("exportTableDbUsername")+'">Username:</label></td><td><input name="exportTableDbUsername" id="'+c("exportTableDbUsername")+'" type="text"/></td>           <td><label for="'+c("exportTableDbPassword")+'">Password:</label></td><td><input id="'+c("exportTableDbPassword")+'" name="exportTableDbPassword" type="password" /></td>       </tr>       </table>       <div>          <div style="padding-top: 5px;">Preview Results/SQL Statements:             <span class="tableDropWarning" style="display:none; color: #FF0000">WARNING: Tables will be dropped.</span>          <div>          <div class="tableExportSqlEditor" style="background-color: #FFFFFF; border: 1px solid #000000; width: 750px; height: 150px;"></div>          <div style="padding-top: 5px;">Execute Results:</div>          <div class="tableExportSqlResult" style="background-color: #FFFFFF; padding-left: 3px; border: 1px solid #000000; overflow-x: auto; width: 750px; height: 150px;"></div></>       </div>       </form>       </div>');
var g=$("#"+f),j=false,l;g.dialog({bgiframe:true,width:780,height:530,title:"Export Tables: "+a,modal:true,autoOpen:false,resizable:false,buttons:{Close:function(){$(this).dialog("close")},"Execute Statements":function(){if(!j){j=true;var h=d();h.ExecuteSql=l.getValue();$(".tableExportSqlResult",g).html("Executing....");Ajax.post("/export_mapper_vmd_tables_to_db",h,function(q){j=false;q=q.ExportComplete?"Executed successfully.":q.Error;$(".tableExportSqlResult",g).html("<pre>"+q+"</pre>")})}}}});
Ajax.post("/db_api_list","",function(h){g.dialog("open");l=new CodeMirror($(".tableExportSqlEditor",g).get(0),{mode:"text/x-plsql",theme:"ifware",indentUnit:3,tabMode:"indent",lineNumbers:true,height:"150px",width:"740px"});if(h){var q=$("select[name=exportTableDbApi]",g);for(DbIndex in h.DbApi){var p=h.DbApi[DbIndex],t=$("<option></option");t.val(p).html(p);q.append(t)}}e(l)},"json")};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var MPRapp={};MPRapp.type="Iguana";MPRapp.pageLookup={};PAGsetupCommonMapCalls(MPRapp.pageLookup);MPRapp.defaultRequest=function(a){ERRrenderDefaultError(a,true)};MPRapp.renderError=function(a,b){ERRrenderError(a,b,false)};console.log("MPRapp=",MPRapp);MPRapp.header='<div class="header"><span class="logo"><img src="/mapper/logo_utrans.gif"></span>';
function MAPretrieveHeaderHTML(a,b){var c="";c+='<div class="header">             <span class="logo">              <img src="/mapper/logo_utrans.gif">             </span>             <span class="crumb">';c+=MAPsetBreadCrumb(a,b);c+='</span>             <div id="help_button">              <a href="http://www.interfaceware.com/wiki/translator.html" target="_manual"></a>             </div>             <div id="login">              Logged in as <b>';c+=b.User;c+='</b>. (<a href="/login.html">Logout</a>)              </div>            </div>';
return c}function MAPretrieveDefaultHeaderHTML(){var a="";a+='<div class="header">             <span class="logo">              <img src="/mapper/logo_utrans.gif">             </span>             <span class="crumb">              <a href="/">Dashboard</a> &gt; Error             </span>             <div id="help_button">              <a href="http://www.interfaceware.com/wiki/translator.html" target="_manual"></a>             </div>            </div>';return a}
function MAPretrieveDocTitle(a,b){return PAGbaseTitle+" > Dashboard > Channel "+PAGgetField(b,"ChannelName")+" > Configuration"}
function MAPretrieveParams(a,b){var c={};if("lua_editor"==a){c.ChannelGuid=b.ChannelGuid;c.ChannelName=b.ChannelName;c.ComponentType=b.ComponentType;c.ComponentName=b.ComponentName;c.User=b.User;c.Index=b.Index;c.SDIndex=b.Index;c.Module=b.Module}else if("message_preview"==a){c.ChannelGuid=b.ChannelGuid;c.ChannelName=b.ChannelName;c.ComponentType=b.ComponentType;c.ComponentName=b.ComponentName;c.User=b.User;c.Index=b.Index;c.Module=b.Module}return c}
function MAPsetBreadCrumb(a,b){if(b.DashboardLinkOnly)return"<a href='/'>Dashboard</a> &gt; "+b.DashboardLinkOnly;var c="";MPRapp.ExtraOtherFileMenuOptions=[{name:"Create DB Tables",className:"optionCreateDbTables",func:function(g){IGNMPRexportTablesExecute(g.label,g.editor.ifware.ChannelGuid)},shouldShowFunc:function(g){return g.type=="vmd"}}];var d={Guid:PAGgetField(b,"ChannelGuid"),Name:PAGgetField(b,"ChannelName")},e={Type:PAGgetOptionalField(b,"ComponentType"),Name:PAGgetOptionalField(b,"ComponentName")};
c="<a href='/'>Dashboard</a> &gt; ";c+="<a href='/channel.html?Channel="+PAGescapeQuotes(encodeURIComponent(d.Name))+"'>"+PAGhtmlEscape(d.Name)+"</a> &gt; ";var f="";f="Destination"==e.Type?"destinationTab":"Filter"==e.Type?"filterTab":"sourceTab";c+="<a href='/channel.html?Channel="+PAGescapeQuotes(encodeURIComponent(d.Name))+"&editTab="+f+"'>"+e.Name+"</a> &gt; ";if("lua_editor"==a)c+="Script";else if("message_edit"==a)c+=b.NewMsg==1?"New Message":"Edit Message ("+PAGgetField(b,"Index")+" of "+
PAGgetField(b,"TotalSd")+")";else if("message_preview"==a)c+="Messages";else if("error"==a)c+="Error";return c};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
function AjaxImpl(a,b){function c(j){var l=j.error;j.error=function(q,p,t){if(l)try{if(l(q,p,t))return}catch(r){}p!="notmodified"&&a(p,function(){jQuery.ajax(j)},q)};var h=j.success;j.success=function(q,p,t){if(t.status){var r;try{r=b(q,p,t)}catch(w){}if(r)a(r,function(){jQuery.ajax(j)},t);else h&&h(q,p,t)}else a(null,function(){jQuery.ajax(j)},t)};return jQuery.ajax(j)}function d(j,l,h,q){if(typeof h=="function"){q=h;h=undefined}return j.load(l,h,function(p,t,r){if(q)try{if(q(p,t,r))return}catch(w){}var z=
!r.status||t!="success"&&t!="notmodified";if(z){if(r.status)z=t}else try{z=b(p,t,r)||null}catch(y){z=null}if(z||!r.status)a(z,function(){d(j,l,h,q)},r)})}function e(j){return function(l,h,q,p){return typeof h=="function"?j(l,undefined,h,q):typeof q!="function"?j(l,h,undefined,q):j(l,h,q,p)}}function f(j){return e(function(l,h,q,p){return c({url:l,data:h,type:j,success:q,dataType:p})})}function g(j){return e(function(l,h,q){return c({url:l,data:h,success:q,dataType:j})})}a||(a=function(){});b||(b=
function(){});return{ajax:c,load:d,abort:function(j){if(j)try{j.onreadystatechange=function(){};j.abort()}catch(l){}},get:f(),getJSON:g("json"),getScript:g("script"),post:f("POST")}};/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var MiniLogin=function(){function a(){clearTimeout(f);jQuery.ajax({url:"/login_check",data:{Username:$("#login-user").val(),Password:$("#login-pass").val()},dataType:"json",cache:false,success:function(h){if(h)if(h.LoginOkay){$("#login-popup").dialog("close");if(g){h=g;g=null;h()}}else $("#login-message").text("Login failed: "+h.ErrorText||"Please try again.");else $("#login-message").text("Login failed: Iguana is not responding.")},error:function(h,q){if(h.status==403||q=="parsererror"){$("#login-message").text("Iguana is restarting, please wait...");
f=setTimeout(a,1E3)}else $("#login-message").text("Login failed: Iguana is not responding.")}})}function b(h,q){if(j)if(g){var p=g;g=function(){try{p()}catch(w){}q()}}else{var t=$("#login-popup");t.length||(t=c());g=function(){q()};var r=$("#login-pass").val(e);$("#login-message").text(h);t.dialog("open");r.focus()}}function c(){$("body").append('         <div id="login-popup" style="display:none">            <table width="100%">            <tr>               <td colspan="2" id="login-message" align="center">            <tr>               <td align="right">Username:               <td><input id="login-user" readonly>            <tr>               <td align="right">Password:               <td><input id="login-pass" type="password">            </table>         </div>      ');
$("#login-user").val(d);$("#login-pass").keydown(function(h){if(h.keyCode==13){h.preventDefault();a()}});return $("#login-popup").dialog({autoOpen:false,closeOnEscape:false,modal:true,resizable:false,title:"Iguana Login",buttons:{"Login & Retry":a,Cancel:function(){window.location="/"}}})}var d,e,f,g,j;$(document).ready(function(){$(window).unload(function(){j=false});j=true});var l=AjaxImpl(function(h,q,p){var t;if(p.status==403||h=="parsererror")t="Your session has expired.";else if(h!="notmodified")t=
"Iguana is not responding.";b(t,q)});l.show=b;l.loggedIn=function(){var h=l.ajax({url:"/login_check",dataType:"json",cache:false,async:false});try{if($.parseJSON(h.responseText).LoginOkay)return true}catch(q){}b("Your session has expired.",$.noop);return false};l.init=function(h,q){d=h;e=q};return l}();/*

 Copyright (c) 2010-2011 iNTERFACEWARE Inc.  All rights reserved.
*/
var MiniBrowser=function(){var a,b,c,d;return{create:function(e){function f(r,w,z){var y=$("#mb-progress");y.length>0&&y.remove();$("body").append('            <div id="mb-progress" style="display:none">               <img src="/js/mapper/images/spinner.gif">               Importing message from logs...            </div>');y=$("#mb-progress").dialog({autoOpen:false,minHeight:50,resizable:false,title:"Importing"});y.dialog("open");p.getJSON(z?"/http_log_entries?":"/export_to_mapper?",{Action:"export",
TargetGuid:e.target,"Export.Plan":w},function(A){if(A.Success){y.dialog("close");e.onSuccess(A.ImportStart+1,A.SizeOfImport)}else{y.html(A.Error);y.dialog({buttons:{Close:function(){$(this).dialog("close")}},title:"Import Failed"})}})}function g(r,w){var z=$("#mb-source",r),y=z.val();z.html("<option selected></option>");$("option",z).text(y);$("<option>--</option>").attr("value",y).appendTo(z);$.map(w,function(A){if(A.Name!=y){z.append("<option></option>");$("option:last",z).text(A.Name)}})}function j(r,
w,z,y){!y&&z.BeforePosition===undefined&&g(r,w.Sources);var A=Math.max(0,5-$("div.mb-entry",r).length),B=$("#mb-loading",r),G=$('<div class="mb-entry"></div>');$.map(w.Entries.slice(0,A),function(E){G.clone().html(E.Preview).click(function(){try{e.onStart()}catch(F){}f(r,E.MessageId,y)}).insertBefore(B)});if(w.Complete||w.Entries.length>=A){B.hide();$("div.mb-entry",r).length||$("#mb-status",r).text("No matching entries.").show()}else{$("#mb-progress").html(w.Progress);z.BeforePosition=w.Continue.Position;
z.Date=w.Continue.Date;h(r,z)}}function l(r){var w=$("#mb-date").val().replace(/\s/g,""),z=$("#mb-time").val().replace(/\s/g,"");if(z&&!w){w=new Date;w=[w.getFullYear(),w.getMonth()+1,w.getDate()].join("/")}else if(w&&!z)z="23:59:59";if(w&&!w.match(/^\d+\/\d+\/\d+$/))$("#mb-status").text("Invalid date (use YYYY/MM/DD).").show();else z&&!z.match(/^\d+:\d+(:\d+)?$/)?$("#mb-status").text("Invalid time (use HH:MM or HH:MM:SS).").show():r(w?[w,z].join(" "):"")}function h(r,w,z){t&&p.abort(t);t=p.getJSON(z?
"/http_log_entries":"/log_entries",w,function(y){t=undefined;j(r,y,w,z)})}function q(r,w){$("div.mb-entry",r).remove();$("#mb-status",r).hide();l(function(z){$("#mb-progress",r).text("");$("#mb-loading",r).show();h(r,{Output:"json",Filter:$("#mb-query",r).val(),Source:$("#mb-source",r).val(),Before:z,Type:"messages",TargetGuid:e.target},w)})}var p=window.Ajax||window.MiniLogin,t;e.parent.append('         <div id="mini-browser">            <div id="mb-title" style="display:none">               Select a message from the logs to add as sample data.            </div>            <span id="mb-options" style="display:none">               <input id="mb-query" title="Search Text">               <select id="mb-source">                  <option selected></option>               </select>               <input id="mb-date" size="10" title="Select Date">               <input id="mb-time" size="6" title="Time">            </span>            <div id="mb-divider"></div>            <button id="mb-search">Add From Logs</button>            <button id="mb-addfromhttp">Add From HTTP Request Log</button>            <div id="mb-status" style="display:none"></div>            <div id="mb-loading" style="display:none">               <img src="/js/mapper/images/spinner.gif">               Searching... <span id="mb-progress"></span>            </div>         </div>');
e.https||$("#mb-addfromhttp").remove();$("#mb-query").val(a||"").change(function(){a=$(this).val()}).watermark().add("#mb-date,#mb-time").keydown(function(r){if(r.keyCode==13)$("#mb-search, #mb-addfromhttp").filter(":visible").click();else if(r.keyCode==27)e.onCancel()});$("#mb-source option").text(b||e.source);$("#mb-source").change(function(){b=$(this).val()});$("#mb-date").val(c||"").change(function(){c=$(this).val()}).watermark().datepicker({dateFormat:"yy/mm/dd",changeMonth:true,changeYear:true,
maxDate:"+0d",beforeShow:function(){$(".ui-datepicker").css("z-index",950)},onSelect:function(r){c=r;$(this).watermark()}});$("#mb-time").val(d||"").change(function(){d=$(this).val()}).watermark();$("#mb-search").click(function(){try{e.onOpen()}catch(r){}$("#mb-divider, #mb-addfromhttp").hide();$("#mb-title, #mb-options").show();$(this).text("Search");q($("#mini-browser"))});$("#mb-addfromhttp").click(function(){try{e.onOpen()}catch(r){}$("#mb-divider, #mb-search, #mb-source").hide();$("#mb-date, #mb-time").parent().hide();
$("#mb-title, #mb-options").show();$(this).text("Search");q($("#mini-browser"),true)})}}}();
